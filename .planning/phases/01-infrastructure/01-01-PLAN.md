---
phase: 01-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - integrations/agent-browser/package.json
  - integrations/agent-browser/tsconfig.json
  - integrations/agent-browser/src/types.ts
autonomous: true

must_haves:
  truths:
    - "Package can be built with pnpm build"
    - "TypeScript compiles without errors"
    - "Types are exported from the package"
  artifacts:
    - path: "integrations/agent-browser/package.json"
      provides: "Package configuration with correct dependencies"
      contains: "agent-browser"
    - path: "integrations/agent-browser/tsconfig.json"
      provides: "TypeScript configuration extending root config"
      contains: "extends"
    - path: "integrations/agent-browser/src/types.ts"
      provides: "TypeScript interfaces for BrowserToolset"
      exports: ["BrowserToolsetConfig", "NavigateInput", "NavigateOutput"]
  key_links:
    - from: "integrations/agent-browser/package.json"
      to: "agent-browser"
      via: "dependencies field"
      pattern: '"agent-browser"'
    - from: "integrations/agent-browser/package.json"
      to: "@mastra/core"
      via: "peerDependencies field"
      pattern: '"@mastra/core"'
---

<objective>
Create the agent-browser integration package with proper configuration and type definitions.

Purpose: Establish the foundation for the BrowserToolset integration following Mastra monorepo conventions.
Output: A buildable package with TypeScript configuration and exported types for browser automation.
</objective>

<execution_context>
@/Users/abhiramaiyer/.claude/get-shit-done/workflows/execute-plan.md
@/Users/abhiramaiyer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure/01-RESEARCH.md
@.planning/codebase/CONVENTIONS.md
@.planning/codebase/STACK.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create package configuration</name>
  <files>
    integrations/agent-browser/package.json
    integrations/agent-browser/tsconfig.json
  </files>
  <action>
Create the integrations/agent-browser directory and add package configuration files.

**package.json requirements:**
- name: "@mastra/agent-browser"
- version: "0.1.0"
- main: "dist/index.js"
- module: "dist/index.mjs"
- types: "dist/index.d.ts"
- exports field with "." entry for default, import, types
- scripts: build using tsup (pattern from other packages)
- dependencies: agent-browser@^0.8.0
- peerDependencies: @mastra/core@^1.0.0, zod@^3.25.0
- devDependencies: tsup, typescript
- engines: node >= 22.13.0

**tsconfig.json requirements:**
- extends: "../../tsconfig.json" (reference root config)
- compilerOptions.outDir: "dist"
- include: ["src/**/*"]

Follow patterns from existing packages like packages/memory/package.json for structure.
  </action>
  <verify>
    Run: cd integrations/agent-browser && cat package.json | grep -E '"name"|"agent-browser"|"@mastra/core"'
    Expect: Package name and dependencies are correctly specified
  </verify>
  <done>
    Package.json contains @mastra/agent-browser with agent-browser dependency and @mastra/core peer dependency.
    tsconfig.json extends root configuration.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create TypeScript type definitions</name>
  <files>
    integrations/agent-browser/src/types.ts
  </files>
  <action>
Create the types.ts file with TypeScript interfaces for the BrowserToolset.

**Types to define:**

```typescript
import { z } from 'zod';

// Configuration for BrowserToolset constructor
export interface BrowserToolsetConfig {
  headless?: boolean;  // Default: true
  timeout?: number;    // Default: 10000 (10 seconds)
}

// Navigate tool schemas (exported for use in tool definition)
export const navigateInputSchema = z.object({
  url: z.string().url().describe('The URL to navigate to'),
  waitUntil: z
    .enum(['load', 'domcontentloaded', 'networkidle'])
    .optional()
    .default('domcontentloaded')
    .describe('When to consider navigation complete. Use domcontentloaded for faster results.'),
});

export const navigateOutputSchema = z.object({
  success: z.boolean().describe('Whether navigation succeeded'),
  url: z.string().describe('The final URL after navigation (may differ due to redirects)'),
  title: z.string().describe('The page title'),
});

// Inferred types from schemas
export type NavigateInput = z.infer<typeof navigateInputSchema>;
export type NavigateOutput = z.infer<typeof navigateOutputSchema>;

// Error response structure for LLM-friendly errors
export interface BrowserError {
  success: false;
  error: string;
  hint: string;
}
```

Ensure types follow Mastra conventions:
- PascalCase for interfaces and type aliases
- Zod schemas for tool inputs/outputs
- JSDoc comments on public types
  </action>
  <verify>
    Run: cd integrations/agent-browser && npx tsc --noEmit src/types.ts 2>&1 || echo "TypeScript check"
    Expect: No TypeScript errors (may fail if dependencies not installed yet, which is acceptable at this stage)
  </verify>
  <done>
    types.ts exports BrowserToolsetConfig, navigateInputSchema, navigateOutputSchema, NavigateInput, NavigateOutput, BrowserError.
    All types have JSDoc comments.
  </done>
</task>

</tasks>

<verification>
1. Directory structure exists: integrations/agent-browser/src/types.ts
2. package.json is valid JSON with correct fields
3. tsconfig.json extends root configuration
4. Types file contains all required exports
</verification>

<success_criteria>
- Package can be recognized by pnpm workspace (add to pnpm-workspace.yaml if needed)
- TypeScript types compile without errors
- All interfaces and schemas are exported
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure/01-01-SUMMARY.md`
</output>
