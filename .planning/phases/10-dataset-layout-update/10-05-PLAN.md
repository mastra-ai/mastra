---
phase: 10-dataset-layout-update
plan: 05
type: execute
wave: 3
depends_on: ["10-03", "10-04"]
files_modified:
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/items-master-detail.tsx
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx
autonomous: true

must_haves:
  truths:
    - "Master-detail layout shows two columns when item selected"
    - "List column shows toolbar + compressed item list (~40-50% width)"
    - "Detail column shows item toolbar + detail content (~50-60% width)"
    - "Each column scrolls independently"
    - "Container max-width expands from 50rem to 100rem when item selected"
    - "SideDialog replaced with inline ItemDetailPanel"
  artifacts:
    - path: "packages/playground-ui/src/domains/datasets/components/dataset-detail/items-master-detail.tsx"
      provides: "Master-detail container component"
      exports: ["ItemsMasterDetail", "ItemsMasterDetailProps"]
  key_links:
    - from: "items-master-detail.tsx"
      to: "items-list.tsx"
      via: "component import"
      pattern: "ItemsList"
    - from: "items-master-detail.tsx"
      to: "item-detail-panel.tsx"
      via: "component import"
      pattern: "ItemDetailPanel"
    - from: "dataset-detail.tsx"
      to: "items-master-detail.tsx"
      via: "component import"
      pattern: "ItemsMasterDetail"
---

<objective>
Create master-detail layout container and integrate into DatasetDetail.

Purpose: Enable side-by-side item list and detail viewing
Output: ItemsMasterDetail component replacing Items tab content
</objective>

<execution_context>
@/Users/grzegorzlobinski/.claude/get-shit-done/workflows/execute-plan.md
@/Users/grzegorzlobinski/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-dataset-layout-update/10-CONTEXT.md
@.planning/phases/10-dataset-layout-update/10-RESEARCH.md
@.planning/phases/10-dataset-layout-update/10-03-SUMMARY.md
@.planning/phases/10-dataset-layout-update/10-04-SUMMARY.md

# Current implementation
@packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx
@packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx
@packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-panel.tsx
@packages/playground-ui/src/ds/primitives/transitions.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ItemsMasterDetail container</name>
  <files>packages/playground-ui/src/domains/datasets/components/dataset-detail/items-master-detail.tsx</files>
  <action>
Create master-detail container:

```typescript
'use client';

import type { DatasetItem } from '@mastra/client-js';
import { cn } from '@/lib/utils';
import { transitions } from '@/ds/primitives/transitions';
import { ItemsList, type ItemsListProps } from './items-list';
import { ItemDetailPanel } from './item-detail-panel';

export interface ItemsMasterDetailProps {
  datasetId: string;
  items: DatasetItem[];
  isLoading: boolean;
  selectedItemId: string | null;
  onItemSelect: (itemId: string) => void;
  onItemClose: () => void;
  // Pass-through props for ItemsList
  onAddClick: () => void;
  onImportClick?: () => void;
  onBulkDeleteClick?: (itemIds: string[]) => void;
  onCreateDatasetClick?: (items: DatasetItem[]) => void;
  datasetName?: string;
  clearSelectionTrigger?: number;
}
```

Layout structure:
```typescript
export function ItemsMasterDetail({
  datasetId,
  items,
  isLoading,
  selectedItemId,
  onItemSelect,
  onItemClose,
  ...listProps
}: ItemsMasterDetailProps) {
  const selectedItem = items.find(i => i.id === selectedItemId) ?? null;

  return (
    <div className={cn(
      "grid h-full overflow-hidden",
      transitions.allSlow, // 300ms transition
      selectedItemId
        ? "grid-cols-[minmax(300px,45%)_minmax(400px,55%)]"
        : "grid-cols-1"
    )}>
      {/* List column - always visible */}
      <div className={cn(
        "flex flex-col h-full overflow-hidden",
        selectedItemId && "border-r border-border1"
      )}>
        <ItemsList
          items={items}
          isLoading={isLoading}
          onItemClick={onItemSelect}
          selectedItemId={selectedItemId}
          {...listProps}
        />
      </div>

      {/* Detail column - conditional */}
      {selectedItem && (
        <div className="flex flex-col h-full overflow-hidden">
          <ItemDetailPanel
            datasetId={datasetId}
            item={selectedItem}
            items={items}
            onItemChange={onItemSelect}
            onClose={onItemClose}
          />
        </div>
      )}
    </div>
  );
}
```

Key details:
- CSS Grid with conditional columns based on selection
- minmax ensures minimum column widths
- 45%/55% split per CONTEXT.md guidance
- Both columns have h-full + overflow-hidden
- Border-r on list column only when detail visible
- transitions.allSlow for smooth open/close animation
  </action>
  <verify>
```bash
cd /Users/grzegorzlobinski/.superset/worktrees/mastra/dataset-layout-update/packages/playground-ui
pnpm exec tsc --noEmit src/domains/datasets/components/dataset-detail/items-master-detail.tsx
```
  </verify>
  <done>ItemsMasterDetail renders two-column layout when item selected</done>
</task>

<task type="auto">
  <name>Task 2: Integrate into DatasetDetail with max-width transition</name>
  <files>packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx</files>
  <action>
Update DatasetDetail to use master-detail layout:

1. Import new components and transitions:
```typescript
import { ItemsMasterDetail } from './items-master-detail';
import { transitions } from '@/ds/primitives/transitions';
import { cn } from '@/lib/utils';
```

2. Remove ItemDetailDialog import (replaced by inline panel)

3. Update the main container to handle max-width transition:

Find the outer div (currently `grid grid-rows-[auto_1fr] h-full`).

Wrap content in a container that transitions max-width:
```typescript
<div className="h-full overflow-hidden">
  <div className={cn(
    "h-full mx-auto w-full",
    transitions.allSlow,
    selectedItemId ? "max-w-[100rem]" : "max-w-[50rem]"
  )}>
    <div className="grid grid-rows-[auto_1fr] h-full">
      {/* DatasetHeader */}
      {/* Tabs content */}
    </div>
  </div>
</div>
```

4. Replace Items tab content with ItemsMasterDetail:

Find:
```typescript
<TabContent value="items" className="flex-1 overflow-auto">
  <ItemsList ... />
</TabContent>
```

Replace with:
```typescript
<TabContent value="items" className="flex-1 overflow-hidden">
  <ItemsMasterDetail
    datasetId={datasetId}
    items={items}
    isLoading={isItemsLoading}
    selectedItemId={selectedItemId}
    onItemSelect={handleItemClick}
    onItemClose={handleItemDialogClose}
    onAddClick={onAddItemClick ?? (() => {})}
    onImportClick={() => setImportDialogOpen(true)}
    onBulkDeleteClick={handleBulkDeleteClick}
    onCreateDatasetClick={handleCreateDatasetClick}
    datasetName={dataset?.name}
    clearSelectionTrigger={clearSelectionTrigger}
  />
</TabContent>
```

Note: Change `overflow-auto` to `overflow-hidden` since ItemsMasterDetail handles scrolling internally.

5. Remove ItemDetailDialog from JSX:
Delete the entire `<ItemDetailDialog ... />` block at the bottom.

6. Keep all dialog-related handlers:
- handleItemClick, handleItemDialogClose, handleItemChange are still used
- Just rename "ItemDialogClose" to "ItemClose" if desired (optional)

7. Remove unused ItemsList import if it was imported directly (now via ItemsMasterDetail)
  </action>
  <verify>
```bash
cd /Users/grzegorzlobinski/.superset/worktrees/mastra/dataset-layout-update/packages/playground-ui
pnpm exec tsc --noEmit src/domains/datasets/components/dataset-detail/dataset-detail.tsx
```
  </verify>
  <done>DatasetDetail uses ItemsMasterDetail with max-width transition</done>
</task>

</tasks>

<verification>
```bash
cd /Users/grzegorzlobinski/.superset/worktrees/mastra/dataset-layout-update/packages/playground-ui
pnpm build

# Verify components
grep "ItemsMasterDetail" dist/src/domains/datasets/components/dataset-detail/items-master-detail.d.ts
grep "ItemsMasterDetail" dist/src/domains/datasets/components/dataset-detail/dataset-detail.js

# Verify ItemDetailDialog removed
! grep "ItemDetailDialog" dist/src/domains/datasets/components/dataset-detail/dataset-detail.js && echo "ItemDetailDialog removed"
```
</verification>

<success_criteria>
- ItemsMasterDetail creates two-column layout when item selected
- Container max-width transitions from 50rem to 100rem
- ItemsList and ItemDetailPanel render in their columns
- Independent scrolling works in each column
- SideDialog replaced with inline panel
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/10-dataset-layout-update/10-05-SUMMARY.md`
</output>
