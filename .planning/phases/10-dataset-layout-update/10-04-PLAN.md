---
phase: 10-dataset-layout-update
plan: 04
type: execute
wave: 3
depends_on: ["10-02", "10-03"]
files_modified:
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-panel.tsx
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-toolbar.tsx
autonomous: true

must_haves:
  truths:
    - "ItemDetailPanel renders item content inline (not in dialog)"
    - "ItemDetailToolbar has prev/next navigation buttons"
    - "Edit split button has 'Edit' main action + Delete/Duplicate options"
    - "Duplicate Item option is disabled"
    - "Edit mode, delete confirmation, navigation all preserved from dialog"
  artifacts:
    - path: "packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-panel.tsx"
      provides: "Inline item detail view (extracted from dialog)"
      exports: ["ItemDetailPanel", "ItemDetailPanelProps"]
    - path: "packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-toolbar.tsx"
      provides: "Item detail toolbar with nav and actions"
      exports: ["ItemDetailToolbar", "ItemDetailToolbarProps"]
  key_links:
    - from: "item-detail-panel.tsx"
      to: "item-detail-toolbar.tsx"
      via: "component composition"
      pattern: "ItemDetailToolbar"
    - from: "item-detail-toolbar.tsx"
      to: "@/ds/components/SplitButton"
      via: "component import"
      pattern: "SplitButton"
---

<objective>
Extract item detail content from dialog to inline panel component.

Purpose: Enable master-detail layout with inline item viewing
Output: ItemDetailPanel and ItemDetailToolbar components
</objective>

<execution_context>
@/Users/grzegorzlobinski/.claude/get-shit-done/workflows/execute-plan.md
@/Users/grzegorzlobinski/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-dataset-layout-update/10-CONTEXT.md
@.planning/phases/10-dataset-layout-update/10-RESEARCH.md
@.planning/phases/10-dataset-layout-update/10-01-SUMMARY.md

# Current dialog implementation to extract from
@packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-dialog.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ItemDetailToolbar component</name>
  <files>packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-toolbar.tsx</files>
  <action>
Create toolbar for item detail panel:

```typescript
'use client';

import { SplitButton } from '@/ds/components/SplitButton';
import { Button } from '@/ds/components/Button';
import { Icon } from '@/ds/icons/Icon';
import { ChevronLeft, ChevronRight, Pencil, Trash2, Copy, X } from 'lucide-react';

export interface ItemDetailToolbarProps {
  onPrevious?: () => void;
  onNext?: () => void;
  onEdit: () => void;
  onDelete: () => void;
  onClose: () => void;
  isEditing?: boolean;
}
```

Layout:
```typescript
<div className="flex items-center justify-between px-4 py-2 border-b border-border1">
  {/* Left side: Navigation */}
  <div className="flex items-center gap-1">
    <Button
      variant="outline"
      size="sm"
      onClick={onPrevious}
      disabled={!onPrevious}
      aria-label="Previous item"
    >
      <Icon><ChevronLeft /></Icon>
    </Button>
    <Button
      variant="outline"
      size="sm"
      onClick={onNext}
      disabled={!onNext}
      aria-label="Next item"
    >
      <Icon><ChevronRight /></Icon>
    </Button>
  </div>

  {/* Right side: Actions */}
  <div className="flex items-center gap-2">
    {!isEditing && (
      <SplitButton
        mainLabel={<><Icon><Pencil /></Icon> Edit</>}
        onMainClick={onEdit}
        variant="outline"
        size="sm"
      >
        <div className="flex flex-col">
          <Button
            variant="ghost"
            size="sm"
            className="w-full justify-start gap-2 text-red-500 hover:text-red-400"
            onClick={onDelete}
          >
            <Icon><Trash2 /></Icon>
            Delete Item
          </Button>
          <Button variant="ghost" size="sm" className="w-full justify-start gap-2" disabled>
            <Icon><Copy /></Icon>
            Duplicate Item (Coming Soon)
          </Button>
        </div>
      </SplitButton>
    )}
    <Button
      variant="ghost"
      size="sm"
      onClick={onClose}
      aria-label="Close detail panel"
    >
      <Icon><X /></Icon>
    </Button>
  </div>
</div>
```

Note: Navigation buttons use undefined callback to indicate disabled state (matches SideDialogNav pattern).
  </action>
  <verify>
```bash
cd /Users/grzegorzlobinski/.superset/worktrees/mastra/dataset-layout-update/packages/playground-ui
pnpm exec tsc --noEmit src/domains/datasets/components/dataset-detail/item-detail-toolbar.tsx
```
  </verify>
  <done>ItemDetailToolbar renders with navigation and edit split button</done>
</task>

<task type="auto">
  <name>Task 2: Create ItemDetailPanel component</name>
  <files>packages/playground-ui/src/domains/datasets/components/dataset-detail/item-detail-panel.tsx</files>
  <action>
Extract item detail content from ItemDetailDialog:

```typescript
'use client';

import { useState, useEffect } from 'react';
import type { DatasetItem } from '@mastra/client-js';
import { KeyValueList } from '@/ds/components/KeyValueList';
import { Sections } from '@/ds/components/Sections';
import { Button } from '@/ds/components/Button';
import { CodeEditor } from '@/ds/components/CodeEditor';
import { Label } from '@/ds/components/Label';
import { AlertDialog } from '@/ds/components/AlertDialog';
import { useLinkComponent } from '@/lib/framework';
import { toast } from '@/lib/toast';
import { FileInputIcon, FileOutputIcon, TagIcon, HashIcon } from 'lucide-react';
import { format } from 'date-fns/format';
import { useDatasetMutations } from '../../hooks/use-dataset-mutations';
import { ItemDetailToolbar } from './item-detail-toolbar';

export interface ItemDetailPanelProps {
  datasetId: string;
  item: DatasetItem;
  items: DatasetItem[];
  onItemChange: (itemId: string) => void;
  onClose: () => void;
}
```

Implementation:
1. Copy state management from ItemDetailDialog:
   - isEditing, inputValue, expectedOutputValue, metadataValue
   - showDeleteConfirm
   - useEffect to reset form on item change

2. Copy navigation handlers (toNextItem, toPreviousItem)

3. Copy form handlers (handleSave, handleCancel, handleEdit, handleDelete, handleDeleteConfirm)

4. Structure:
```typescript
return (
  <div className="flex flex-col h-full">
    <ItemDetailToolbar
      onPrevious={toPreviousItem()}
      onNext={toNextItem()}
      onEdit={handleEdit}
      onDelete={handleDelete}
      onClose={onClose}
      isEditing={isEditing}
    />

    <div className="flex-1 overflow-y-auto p-4">
      {isEditing ? (
        <EditModeContent ... />
      ) : (
        <ReadOnlyContent ... />
      )}
    </div>

    {/* Delete confirmation AlertDialog */}
    <AlertDialog open={showDeleteConfirm} onOpenChange={setShowDeleteConfirm}>
      ...
    </AlertDialog>
  </div>
);
```

5. Copy ReadOnlyContent from ItemDetailDialog:
   - Item ID heading with HashIcon
   - KeyValueList for created/updated dates
   - Code sections for Input, Expected Output, Metadata

6. Copy EditModeContent from ItemDetailDialog:
   - JSON editors for each field
   - Save/Cancel buttons at bottom

Key difference from dialog:
- No SideDialog wrapper
- ItemDetailToolbar instead of SideDialog.Top
- Regular div with overflow-y-auto instead of SideDialog.Content
  </action>
  <verify>
```bash
cd /Users/grzegorzlobinski/.superset/worktrees/mastra/dataset-layout-update/packages/playground-ui
pnpm exec tsc --noEmit src/domains/datasets/components/dataset-detail/item-detail-panel.tsx
```
  </verify>
  <done>ItemDetailPanel renders item content with toolbar and edit/delete functionality</done>
</task>

</tasks>

<verification>
```bash
cd /Users/grzegorzlobinski/.superset/worktrees/mastra/dataset-layout-update/packages/playground-ui
pnpm build

# Verify components exist
grep "ItemDetailPanel" dist/src/domains/datasets/components/dataset-detail/item-detail-panel.d.ts
grep "ItemDetailToolbar" dist/src/domains/datasets/components/dataset-detail/item-detail-toolbar.d.ts
```
</verification>

<success_criteria>
- ItemDetailToolbar renders navigation + edit split button
- Edit split button has Edit action + Delete/Duplicate dropdown
- Duplicate Item disabled
- ItemDetailPanel renders item content (copied from dialog)
- Edit mode and delete confirmation work
- Navigation between items works
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/10-dataset-layout-update/10-04-SUMMARY.md`
</output>
