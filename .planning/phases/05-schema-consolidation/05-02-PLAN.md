---
phase: 05-schema-consolidation
plan: 02
type: execute
wave: 2
depends_on: ["01"]
files_modified:
  - integrations/agent-browser/src/tools/type.ts
  - integrations/agent-browser/src/tools/scroll.ts
  - integrations/agent-browser/src/tools/screenshot.ts
autonomous: true

must_haves:
  truths:
    - "type.ts imports inputSchema and outputSchema from types.ts"
    - "scroll.ts imports inputSchema and outputSchema from types.ts"
    - "screenshot.ts imports inputSchema and outputSchema from types.ts"
    - "No local Zod schema definitions in type.ts, scroll.ts, screenshot.ts"
  artifacts:
    - path: "integrations/agent-browser/src/tools/type.ts"
      provides: "Type tool using shared schemas"
      contains: "from '../types.js'"
    - path: "integrations/agent-browser/src/tools/scroll.ts"
      provides: "Scroll tool using shared schemas"
      contains: "from '../types.js'"
    - path: "integrations/agent-browser/src/tools/screenshot.ts"
      provides: "Screenshot tool using shared schemas"
      contains: "from '../types.js'"
  key_links:
    - from: "integrations/agent-browser/src/tools/type.ts"
      to: "integrations/agent-browser/src/types.ts"
      via: "import typeInputSchema, typeOutputSchema"
      pattern: "import.*typeInputSchema.*from.*types"
    - from: "integrations/agent-browser/src/tools/scroll.ts"
      to: "integrations/agent-browser/src/types.ts"
      via: "import scrollInputSchema, scrollOutputSchema"
      pattern: "import.*scrollInputSchema.*from.*types"
    - from: "integrations/agent-browser/src/tools/screenshot.ts"
      to: "integrations/agent-browser/src/types.ts"
      via: "import screenshotInputSchema, screenshotOutputSchema"
      pattern: "import.*screenshotInputSchema.*from.*types"
---

<objective>
Complete schema consolidation for remaining 3 tool files

Purpose: Finish eliminating schema duplication for type.ts, scroll.ts, screenshot.ts.

Output: All 3 remaining tool files import schemas from types.ts instead of defining them locally.
</objective>

<execution_context>
@/Users/abhiramaiyer/.claude/get-shit-done/workflows/execute-plan.md
@/Users/abhiramaiyer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md

**Dependencies:**
Plan 05-01 must be complete (types.ts updated with error handling schemas).

**Pattern to follow:**
Same as 05-01 tasks 2-3:
1. Remove local schema definitions
2. Remove `import { z } from 'zod';`
3. Add import from types.ts
4. Keep function implementation unchanged
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update type.ts to import from types.ts</name>
  <files>integrations/agent-browser/src/tools/type.ts</files>
  <action>
1. Remove local schema definitions (the z.object blocks for typeInputSchema and typeOutputSchema)
2. Remove `import { z } from 'zod';`
3. Add import from types.ts:
   ```typescript
   import { typeInputSchema, typeOutputSchema, type TypeOutput } from '../types.js';
   ```
4. Keep the rest of the file unchanged (createTypeTool function)
  </action>
  <verify>
Build succeeds: `cd integrations/agent-browser && pnpm build`
No local schema definitions in type.ts
  </verify>
  <done>type.ts imports schemas from types.ts</done>
</task>

<task type="auto">
  <name>Task 2: Update scroll.ts to import from types.ts</name>
  <files>integrations/agent-browser/src/tools/scroll.ts</files>
  <action>
1. Remove local schema definitions (scrollInputSchema and scrollOutputSchema z.object blocks)
2. Remove `import { z } from 'zod';`
3. Add import from types.ts:
   ```typescript
   import { scrollInputSchema, scrollOutputSchema, type ScrollOutput } from '../types.js';
   ```
4. Keep the rest of the file unchanged (createScrollTool function)
  </action>
  <verify>
Build succeeds: `cd integrations/agent-browser && pnpm build`
No local schema definitions in scroll.ts
  </verify>
  <done>scroll.ts imports schemas from types.ts</done>
</task>

<task type="auto">
  <name>Task 3: Update screenshot.ts to import from types.ts</name>
  <files>integrations/agent-browser/src/tools/screenshot.ts</files>
  <action>
1. Remove local schema definitions (screenshotInputSchema and screenshotOutputSchema z.object blocks)
2. Remove `import { z } from 'zod';`
3. Add import from types.ts:
   ```typescript
   import { screenshotInputSchema, screenshotOutputSchema, type ScreenshotOutput } from '../types.js';
   ```
4. Keep the rest of the file unchanged (createScreenshotTool function)
5. Keep the MAX_DIMENSION_WARNING constant (8000) - it's tool-specific, not a schema
  </action>
  <verify>
Build succeeds: `cd integrations/agent-browser && pnpm build`
No local schema definitions in screenshot.ts
  </verify>
  <done>screenshot.ts imports schemas from types.ts</done>
</task>

</tasks>

<verification>
1. Build passes: `cd integrations/agent-browser && pnpm build`
2. Final check - only navigate.ts should have local z.object (for its discriminated union):
   `grep -l "z.object" integrations/agent-browser/src/tools/*.ts`
3. All 5 tools import from types.ts:
   `grep "from '../types.js'" integrations/agent-browser/src/tools/*.ts`
</verification>

<success_criteria>
- type.ts imports schemas from types.ts
- scroll.ts imports schemas from types.ts
- screenshot.ts imports schemas from types.ts
- No local Zod schema definitions in any of the 5 tools (except navigate which uses types.ts)
- Build succeeds
- All 5 tools work with shared schemas
</success_criteria>

<output>
After completion, create `.planning/phases/05-schema-consolidation/05-02-SUMMARY.md`
</output>
