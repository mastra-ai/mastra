---
phase: 08-item-selection-actions
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list-actions.tsx
  - packages/playground-ui/src/domains/datasets/hooks/use-dataset-mutations.ts
  - packages/playground-ui/src/domains/datasets/index.ts
autonomous: true

must_haves:
  truths:
    - 'Three-dot menu component renders with Export/Create Dataset/Delete options'
    - 'Bulk delete mutation sequentially deletes items and invalidates cache'
    - 'Menu disabled when no items exist'
  artifacts:
    - path: 'packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list-actions.tsx'
      provides: 'ActionsMenu component with three action options'
      exports: ['ActionsMenu']
    - path: 'packages/playground-ui/src/domains/datasets/hooks/use-dataset-mutations.ts'
      provides: 'deleteItems mutation for bulk delete'
      exports: ['useDatasetMutations']
  key_links:
    - from: 'items-list-actions.tsx'
      to: '@/ds/components/Popover'
      via: 'component import'
      pattern: 'PopoverContent'
    - from: 'use-dataset-mutations.ts'
      to: 'client.deleteDatasetItem'
      via: 'API call loop'
      pattern: 'for.*deleteDatasetItem'
---

<objective>
Create three-dot actions menu component and bulk delete mutation.

Purpose: UI components for triggering bulk actions + mutation for delete
Output: ActionsMenu component + deleteItems mutation
</objective>

<execution_context>
@/Users/yj/.claude/get-shit-done/workflows/execute-plan.md
@/Users/yj/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-item-selection-actions/08-RESEARCH.md

# Existing UI patterns

@packages/playground-ui/src/ds/components/Popover/Popover.tsx
@packages/playground-ui/src/ds/components/Button/Button.tsx
@packages/playground-ui/src/domains/datasets/hooks/use-dataset-mutations.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ActionsMenu component</name>
  <files>packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list-actions.tsx</files>
  <action>
Create ActionsMenu component using Popover pattern:

```typescript
'use client';

import { useState } from 'react';
import { Popover, PopoverTrigger, PopoverContent } from '@/ds/components/Popover';
import { Button } from '@/ds/components/Button';
import { Icon } from '@/ds/icons/Icon';
import { MoreVertical, Download, FolderPlus, Trash2 } from 'lucide-react';

export interface ActionsMenuProps {
  onExportClick: () => void;
  onCreateDatasetClick: () => void;
  onDeleteClick: () => void;
  disabled?: boolean;
}

export function ActionsMenu({...}: ActionsMenuProps)
```

Implementation:

1. useState for open/onOpenChange
2. PopoverTrigger wraps ghost Button with MoreVertical icon
3. PopoverContent with align="end" and className="w-48 p-1"
4. Three Button items, each variant="ghost" className="w-full justify-start gap-2"
5. Delete button has "text-red-500 hover:text-red-400" class
6. Each button calls handleAction wrapper that invokes callback and closes popover
7. Trigger button disabled when disabled prop is true

Icons: Download for Export, FolderPlus for Create Dataset, Trash2 for Delete
</action>
<verify>

```bash
cd /Users/yj/.superset/worktrees/mastra/test-gsd/packages/playground-ui
pnpm exec tsc --noEmit src/domains/datasets/components/dataset-detail/items-list-actions.tsx
```

  </verify>
  <done>ActionsMenu component renders popover with three action buttons</done>
</task>

<task type="auto">
  <name>Task 2: Add deleteItems bulk mutation</name>
  <files>packages/playground-ui/src/domains/datasets/hooks/use-dataset-mutations.ts</files>
  <action>
Add deleteItems mutation to useDatasetMutations hook:

```typescript
const deleteItems = useMutation({
  mutationFn: async ({ datasetId, itemIds }: { datasetId: string; itemIds: string[] }) => {
    // Sequential deletion - no bulk endpoint exists
    for (const itemId of itemIds) {
      await client.deleteDatasetItem(datasetId, itemId);
    }
  },
  onSuccess: (_, variables) => {
    queryClient.invalidateQueries({ queryKey: ['dataset-items', variables.datasetId] });
    queryClient.invalidateQueries({ queryKey: ['dataset', variables.datasetId] });
  },
});
```

Add deleteItems to return object alongside existing mutations.
</action>
<verify>

```bash
cd /Users/yj/.superset/worktrees/mastra/test-gsd/packages/playground-ui
pnpm exec tsc --noEmit src/domains/datasets/hooks/use-dataset-mutations.ts
```

  </verify>
  <done>deleteItems mutation deletes multiple items and invalidates cache</done>
</task>

<task type="auto">
  <name>Task 3: Export ActionsMenu from index</name>
  <files>packages/playground-ui/src/domains/datasets/index.ts</files>
  <action>
Add export for ActionsMenu in dataset detail components section:

```typescript
export { ActionsMenu } from './components/dataset-detail/items-list-actions';
```

Place after existing dataset-detail exports (DatasetDetail, ItemsList, RunHistory).
</action>
<verify>

```bash
cd /Users/yj/.superset/worktrees/mastra/test-gsd/packages/playground-ui
pnpm build
```

  </verify>
  <done>ActionsMenu exported from package index</done>
</task>

</tasks>

<verification>
```bash
cd /Users/yj/.superset/worktrees/mastra/test-gsd/packages/playground-ui
pnpm build

# Verify exports

grep "ActionsMenu" dist/src/domains/datasets/components/dataset-detail/items-list-actions.d.ts
grep "deleteItems" dist/src/domains/datasets/hooks/use-dataset-mutations.d.ts

```
</verification>

<success_criteria>
- ActionsMenu component created with Popover pattern
- deleteItems mutation added to useDatasetMutations
- Both exported from package index
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-item-selection-actions/08-02-SUMMARY.md`
</output>
```
