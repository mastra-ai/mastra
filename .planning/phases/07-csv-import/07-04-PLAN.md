---
phase: 07-csv-import
plan: 04
type: execute
wave: 3
depends_on: ["07-03"]
files_modified:
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx
  - packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx
  - packages/playground-ui/src/domains/datasets/index.ts
autonomous: true

must_haves:
  truths:
    - "Import CSV button visible in items list header"
    - "Clicking Import CSV opens the import dialog"
    - "Successful import refreshes the items list"
    - "CSVImportDialog exported from datasets domain"
  artifacts:
    - path: "packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx"
      provides: "Items list with Import CSV button"
      min_lines: 200
    - path: "packages/playground-ui/src/domains/datasets/index.ts"
      provides: "Updated barrel exports"
      contains: "CSVImportDialog"
  key_links:
    - from: "items-list.tsx"
      to: "csv-import-dialog.tsx"
      via: "component import"
      pattern: "CSVImportDialog"
    - from: "dataset-detail.tsx"
      to: "items-list.tsx"
      via: "ItemsList render"
      pattern: "<ItemsList"
---

<objective>
Integrate CSV import dialog into dataset detail page.

Purpose: User can access CSV import from the items list
Output: Import CSV button in items list that opens import dialog
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-csv-import/07-03-SUMMARY.md
@packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx
@packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx
@packages/playground-ui/src/domains/datasets/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Import CSV button to items list</name>
  <files>packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx</files>
  <action>
    Update items-list.tsx:

    1. Add new prop to ItemsListProps:
       ```typescript
       onImportClick?: () => void;
       ```

    2. In the header section (where Add Item button is):
       - Add "Import CSV" button next to "Add Item"
       - Use Upload icon from lucide-react
       - Call onImportClick when clicked
       - Only render if onImportClick is provided

    3. Button styling:
       - Same size as Add Item button (size="sm")
       - Use variant="outline" to distinguish from Add Item

    4. Also add Import CSV button to EmptyItemsList component:
       - Add onImportClick prop to EmptyItemsListProps
       - Add secondary button below Add Item button
  </action>
  <verify>
    TypeScript compiles: `cd packages/playground-ui && pnpm tsc --noEmit`
    Import button exists: `grep "Import CSV" packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx`
  </verify>
  <done>Items list shows Import CSV button in header and empty state</done>
</task>

<task type="auto">
  <name>Task 2: Wire up CSV import dialog in dataset detail</name>
  <files>
    packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx
    packages/playground-ui/src/domains/datasets/index.ts
  </files>
  <action>
    **dataset-detail.tsx:**

    1. Import CSVImportDialog from csv-import folder

    2. Add state for import dialog:
       ```typescript
       const [importDialogOpen, setImportDialogOpen] = useState(false);
       ```

    3. Pass onImportClick to ItemsList:
       ```typescript
       onImportClick={() => setImportDialogOpen(true)}
       ```

    4. Render CSVImportDialog:
       ```typescript
       <CSVImportDialog
         datasetId={datasetId}
         open={importDialogOpen}
         onOpenChange={setImportDialogOpen}
         onSuccess={() => {
           // Query invalidation happens in mutation, but can refetch here too
         }}
       />
       ```

    **index.ts:**

    1. Add export for CSVImportDialog:
       ```typescript
       export { CSVImportDialog } from './components/csv-import';
       ```

    2. Verify all existing exports remain intact
  </action>
  <verify>
    TypeScript compiles: `cd packages/playground-ui && pnpm tsc --noEmit`
    Dialog wired: `grep "CSVImportDialog" packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx`
    Export exists: `grep "CSVImportDialog" packages/playground-ui/src/domains/datasets/index.ts`
  </verify>
  <done>
    CSV import dialog integrated into dataset detail page.
    Button opens dialog, successful import refreshes items.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `cd packages/playground-ui && pnpm tsc --noEmit`
2. Import button in items-list: `grep -c "Import CSV" packages/playground-ui/src/domains/datasets/components/dataset-detail/items-list.tsx` returns >= 2 (header + empty state)
3. Dialog in dataset-detail: `grep "CSVImportDialog" packages/playground-ui/src/domains/datasets/components/dataset-detail/dataset-detail.tsx`
4. Exported from index: `grep "CSVImportDialog" packages/playground-ui/src/domains/datasets/index.ts`
</verification>

<success_criteria>
- Import CSV button visible next to Add Item button
- Import CSV button visible in empty items state
- Clicking button opens CSVImportDialog
- Dialog receives correct datasetId
- Successful import triggers query invalidation (items list refreshes)
- CSVImportDialog exported from datasets domain index
</success_criteria>

<output>
After completion, create `.planning/phases/07-csv-import/07-04-SUMMARY.md`
</output>
