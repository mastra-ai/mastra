---
phase: 06-playground-integration
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/playground-ui/src/domains/datasets/hooks/use-dataset-runs.ts
  - packages/playground/src/pages/datasets/dataset/run/index.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Run results display scores for each item"
    - "Scores grouped by item ID"
    - "Score values and scorer names visible in results table"
  artifacts:
    - path: "packages/playground-ui/src/domains/datasets/hooks/use-dataset-runs.ts"
      provides: "useScoresByRunId hook"
  key_links:
    - from: "packages/playground/src/pages/datasets/dataset/run/index.tsx"
      to: "useScoresByRunId"
      via: "hook call"
    - from: "useScoresByRunId"
      to: "client.listScoresByRunId"
      via: "queryFn"
---

<objective>
Wire up scores display in run results view.

Purpose: UAT test 15 failed - scores show empty placeholder
Output: Run results display actual scores from API
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/debug/scores-display.md
@packages/playground-ui/src/domains/datasets/hooks/use-dataset-runs.ts
@packages/playground/src/pages/datasets/dataset/run/index.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add useScoresByRunId hook and wire to run page</name>
  <files>
    packages/playground-ui/src/domains/datasets/hooks/use-dataset-runs.ts
    packages/playground-ui/src/domains/datasets/index.ts
    packages/playground/src/pages/datasets/dataset/run/index.tsx
  </files>
  <action>
Add useScoresByRunId hook in use-dataset-runs.ts:
```typescript
/**
 * Hook to fetch scores for a run, transformed to Record<itemId, ScoreData[]>
 * ScoreData matches ResultsTable expectation: { scorerId, score, reason? }
 */
export const useScoresByRunId = (runId: string) => {
  const client = useMastraClient();
  return useQuery({
    queryKey: ['dataset-run-scores', runId],
    queryFn: async () => {
      const response = await client.listScoresByRunId({ runId });
      // Transform flat array to Record<entityId, ScoreData[]>
      const grouped: Record<string, Array<{ scorerId: string; score: number; reason?: string }>> = {};
      for (const row of response.scores) {
        if (!grouped[row.entityId]) {
          grouped[row.entityId] = [];
        }
        grouped[row.entityId].push({
          scorerId: row.scorerId,
          score: row.score,
          reason: row.reason ?? undefined,
        });
      }
      return grouped;
    },
    enabled: Boolean(runId),
  });
};
```

Export from datasets/index.ts.

Update run/index.tsx:
- Import useScoresByRunId from @mastra/playground-ui
- Call hook: `const { data: scores = {} } = useScoresByRunId(runId!);`
- Remove placeholder: `const scores: Record<string, []> = {};`
- Pass scores to ResultsTable (already expects this shape)
  </action>
  <verify>
Build succeeds:
```bash
cd packages/playground-ui && pnpm build
cd packages/playground && pnpm build
```

Manual test:
1. Start dev server
2. Navigate to a run with scores
3. Verify scores appear in results table
  </verify>
  <done>
Scores display in run results for each item
  </done>
</task>

</tasks>

<verification>
1. Build: `cd packages/playground-ui && pnpm build && cd ../playground && pnpm build`
2. Run dev server: `pnpm dev:playground`
3. Create dataset, add items, trigger run with scorer
4. Navigate to run results
5. Verify: Scores column shows actual values
</verification>

<success_criteria>
- UAT test 15 passes: Scores display properly in results
- Each item row shows its scores with scorer names and values
</success_criteria>

<output>
After completion, create `.planning/phases/06-playground-integration/06-09-SUMMARY.md`
</output>
