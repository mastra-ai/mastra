---
title: "Reference: LangfuseExporter | Observability"
description: Langfuse exporter for Tracing
---

import PropertiesTable from "@site/src/components/PropertiesTable";

# LangfuseExporter

Sends Tracing data to Langfuse for observability.

## Constructor

```typescript
new LangfuseExporter(config: LangfuseExporterConfig)
```

## LangfuseExporterConfig

```typescript
interface LangfuseExporterConfig extends BaseExporterConfig {
  publicKey?: string;
  secretKey?: string;
  baseUrl?: string;
  realtime?: boolean;
  options?: any;
}
```

Extends `BaseExporterConfig`, which includes:
- `logger?: IMastraLogger` - Logger instance
- `logLevel?: LogLevel | 'debug' | 'info' | 'warn' | 'error'` - Log level (default: INFO)

<PropertiesTable
  props={[
    {
      name: "publicKey",
      type: "string",
      description: "Langfuse API key",
      required: false,
    },
    {
      name: "secretKey",
      type: "string",
      description: "Langfuse secret key",
      required: false,
    },
    {
      name: "baseUrl",
      type: "string",
      description: "Langfuse host URL",
      required: false,
    },
    {
      name: "realtime",
      type: "boolean",
      description: "Enable realtime mode - flushes after each event",
      required: false,
    },
    {
      name: "logLevel",
      type: "'debug' | 'info' | 'warn' | 'error'",
      description: "Logger level (default: 'warn')",
      required: false,
    },
    {
      name: "options",
      type: "any",
      description: "Additional Langfuse client options",
      required: false,
    },
  ]}
/>

## Methods

### exportTracingEvent

```typescript
async exportTracingEvent(event: TracingEvent): Promise<void>
```

Exports a tracing event to Langfuse.

### export

```typescript
async export(spans: ReadOnlySpan[]): Promise<void>
```

Batch exports spans to Langfuse.

### shutdown

```typescript
async shutdown(): Promise<void>
```

Flushes pending data and shuts down the client.

## Usage

```typescript
import { LangfuseExporter } from "@mastra/langfuse";

const exporter = new LangfuseExporter({
  publicKey: process.env.LANGFUSE_PUBLIC_KEY,
  secretKey: process.env.LANGFUSE_SECRET_KEY,
  baseUrl: "https://cloud.langfuse.com",
  realtime: true,
});
```

## Span Mapping

- Root spans → Langfuse traces
- `MODEL_GENERATION` spans → Langfuse generations
- All other spans → Langfuse spans
- Event spans → Langfuse events

## Prompt Linking

Link LLM generations to [Langfuse Prompt Management](https://langfuse.com/docs/prompt-management) by setting `metadata.langfuse.prompt`:

```typescript
const agent = new Agent({
  name: "my-agent",
  instructions: "...",
  model: openai("gpt-4o"),
  defaultGenerateOptions: {
    tracingOptions: {
      metadata: {
        langfuse: {
          prompt: {
            // Option 1: Use id alone (UUID uniquely identifies prompt version)
            id: "prompt-uuid",
            // Option 2: Use name + version
            name: "my-prompt",
            version: 1,
          },
        },
      },
    },
  },
});
```

### Using the Langfuse Client

```typescript
import { Langfuse } from "langfuse";

const langfuse = new Langfuse({
  publicKey: process.env.LANGFUSE_PUBLIC_KEY!,
  secretKey: process.env.LANGFUSE_SECRET_KEY!,
});

// Fetch prompt from Langfuse Prompt Management
const prompt = await langfuse.getPrompt("customer-support");

const agent = new Agent({
  name: "support-agent",
  instructions: prompt.prompt,
  model: openai("gpt-4o"),
  defaultGenerateOptions: {
    tracingOptions: {
      metadata: {
        langfuse: {
          prompt: {
            name: prompt.name,
            version: prompt.version,
            id: prompt.id,
          },
        },
      },
    },
  },
});
```

When `metadata.langfuse.prompt` is set on a `MODEL_GENERATION` span (with either `id` alone, or `name` + `version`), the exporter automatically links the generation to the prompt in Langfuse.
