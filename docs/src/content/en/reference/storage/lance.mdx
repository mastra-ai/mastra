---
title: "Reference: LanceDB Storage | Storage"
description: Documentation for the LanceDB storage implementation in Mastra.
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import StorageDomainsNoObservability from "./_storage-domains-no-observability.mdx";
import SchemaManagementNoObservability from "./_schema-management-no-observability.mdx";

# LanceDB Storage

The LanceDB storage implementation provides a high-performance storage solution using the LanceDB database system, which excels at handling both traditional data storage and vector operations.

## Installation

<Tabs>
<TabItem value="npm" label="npm">

```bash copy
npm install @mastra/lance@beta
```

</TabItem>
<TabItem value="pnpm" label="pnpm">

```bash copy
pnpm add @mastra/lance@beta
```

</TabItem>
<TabItem value="yarn" label="yarn">

```bash copy
yarn add @mastra/lance@beta
```

</TabItem>
<TabItem value="bun" label="bun">

```bash copy
bun add @mastra/lance@beta
```

</TabItem>
</Tabs>

## Usage

```typescript copy showLineNumbers
import { LanceStorage } from "@mastra/lance";

// Connect to a local database
const storage = await LanceStorage.create("storage-id", "MyStorage", "/path/to/db");

// Connect to a LanceDB cloud database
const storage = await LanceStorage.create("storage-id", "MyStorage", "db://host:port");

// Connect to a cloud database with custom options
const storage = await LanceStorage.create("storage-id", "MyStorage", "s3://bucket/db", {
  storageOptions: { timeout: "60s" },
});
```

## Parameters

<PropertiesTable
  content={[
    {
      name: "id",
      type: "string",
      description: "Unique identifier for this storage instance",
      isOptional: false,
    },
    {
      name: "name",
      type: "string",
      description: "Name identifier for the storage instance",
      isOptional: false,
    },
    {
      name: "uri",
      type: "string",
      description:
        "URI to connect to the LanceDB database. Can be a local path, cloud DB URL, or S3 bucket URL",
      isOptional: false,
    },
    {
      name: "options",
      type: "ConnectionOptions",
      description:
        "Connection options for LanceDB, such as timeout settings, authentication, etc.",
      isOptional: true,
    },
  ]}
/>

## Storage Domains

LanceStorage supports the following domains:

<StorageDomainsNoObservability />

To access domain-specific operations, use `getStore()`:

```typescript copy
const storage = await LanceStorage.create("storage-id", "MyStorage", "/path/to/db");

// Access memory domain for threads and messages
const memoryStore = await storage.getStore('memory');

const threads = await memoryStore.listThreadsByResourceId({
  resourceId: 'user-123',
  page: 0,
  perPage: 20,
});

// Access workflows domain for workflow snapshots
const workflowsStore = await storage.getStore('workflows');

const snapshot = await workflowsStore.getWorkflowSnapshot({
  workflowId: 'my-workflow',
  runId: 'run-123',
});

// Access evals domain for scores
const evalsStore = await storage.getStore('evals');

const scores = await evalsStore.listScoresByScorerId({
  scorerId: 'my-scorer',
  pagination: { page: 0, perPage: 50 },
});
```

See the [Storage overview](/docs/v1/server-db/storage) for more information about storage domains and composite storage.

<SchemaManagementNoObservability />

## Deployment Options

LanceDB storage can be configured for different deployment scenarios:

- **Local Development**: Use a local file path for development and testing
  ```
  /path/to/db
  ```
- **Cloud Deployment**: Connect to a hosted LanceDB instance
  ```
  db://host:port
  ```
- **S3 Storage**: Use Amazon S3 for scalable cloud storage
  ```
  s3://bucket/db
  ```
