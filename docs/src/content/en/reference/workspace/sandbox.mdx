---
title: "Reference: Sandbox Interface | Workspace"
description: "Documentation for the WorkspaceSandbox interface and LocalSandbox provider."
packages:
  - "@mastra/core"
---

# Sandbox Interface

The `WorkspaceSandbox` interface defines how workspaces execute commands. Mastra includes `LocalSandbox` for local execution.

## LocalSandbox

Executes commands on the local system.

### Usage

```typescript
import { LocalSandbox } from '@mastra/core/workspace';

const sandbox = new LocalSandbox({
  workingDirectory: './workspace',
  env: {
    NODE_ENV: 'development',
  },
});
```

### Constructor parameters

<PropertiesTable
  content={[
    {
      name: "workingDirectory",
      type: "string",
      description: "Directory for command execution",
      isOptional: true,
      defaultValue: "process.cwd()",
    },
    {
      name: "env",
      type: "NodeJS.ProcessEnv",
      description: "Environment variables to set. PATH is included by default unless overridden.",
      isOptional: true,
    },
    {
      name: "isolation",
      type: "'none' | 'seatbelt' | 'bwrap'",
      description: "Native OS sandboxing backend. 'seatbelt' for macOS, 'bwrap' for Linux.",
      isOptional: true,
      defaultValue: "'none'",
    },
    {
      name: "nativeSandbox",
      type: "NativeSandboxConfig",
      description: "Configuration for native sandboxing (network access, read/write paths).",
      isOptional: true,
    },
    {
      name: "safety",
      type: "SandboxSafetyOptions",
      description: "Safety configuration for sandbox operations",
      isOptional: true,
    },
  ]}
/>

### Properties

<PropertiesTable
  content={[
    {
      name: "provider",
      type: "string",
      description: "Provider identifier ('local')",
    },
  ]}
/>

## WorkspaceSandbox interface

All sandbox providers implement this interface.

### Methods

#### `start()`

Start the sandbox. Called by `workspace.init()`.

```typescript
await sandbox.start();
```

#### `stop()`

Stop the sandbox.

```typescript
await sandbox.stop?.();
```

#### `destroy()`

Clean up sandbox resources. Called by `workspace.destroy()`.

```typescript
await sandbox.destroy();
```

#### `executeCommand(command, args?, options?)`

Execute a shell command.

```typescript
const result = await sandbox.executeCommand('ls', ['-la', '/docs']);
const result = await sandbox.executeCommand('npm', ['install', 'lodash']);
```

**Parameters:**

<PropertiesTable
  content={[
    {
      name: "command",
      type: "string",
      description: "Command to execute",
    },
    {
      name: "args",
      type: "string[]",
      description: "Command arguments",
      isOptional: true,
    },
    {
      name: "options.timeout",
      type: "number",
      description: "Execution timeout in milliseconds",
      isOptional: true,
    },
    {
      name: "options.cwd",
      type: "string",
      description: "Working directory for the command",
      isOptional: true,
    },
    {
      name: "options.env",
      type: "Record<string, string>",
      description: "Additional environment variables",
      isOptional: true,
    },
  ]}
/>

**Returns:** `Promise<CommandResult>`

```typescript
interface CommandResult {
  success: boolean;
  stdout: string;
  stderr: string;
  exitCode: number;
  duration: number;
}
```

#### `getInfo()`

Get sandbox status and resource information.

```typescript
const info = await sandbox.getInfo();
// { status: 'running', resources: { memoryMB: 512, cpuPercent: 5 } }
```

**Returns:** `Promise<SandboxInfo>`

```typescript
interface SandboxInfo {
  status: 'starting' | 'running' | 'stopped' | 'error';
  resources?: {
    memoryMB?: number;
    memoryUsedMB?: number;
    cpuCores?: number;
    cpuPercent?: number;
    diskMB?: number;
    diskUsedMB?: number;
  };
}
```

## Environment isolation

By default, `LocalSandbox` only includes `PATH` in the environment. This allows commands to run while preventing accidental exposure of API keys and secrets.

```typescript
// Default: only PATH is available (commands work, secrets protected)
const secureSandbox = new LocalSandbox({
  workingDirectory: './workspace',
});

// Explicit: pass specific variables
const sandbox = new LocalSandbox({
  workingDirectory: './workspace',
  env: {
    NODE_ENV: 'development',
    API_URL: 'https://api.example.com',
  },
});

// Full access (use with caution)
const devSandbox = new LocalSandbox({
  workingDirectory: './workspace',
  env: process.env,
});
```

## Native OS sandboxing

`LocalSandbox` supports native OS-level sandboxing for additional security:

- **macOS**: Uses Seatbelt (`sandbox-exec`) for filesystem and network isolation
- **Linux**: Uses Bubblewrap (`bwrap`) for namespace isolation

```typescript
// Detect the best available backend for this platform
const detection = LocalSandbox.detectIsolation();
console.log(detection);
// { backend: 'seatbelt', available: true, message: '...' }

// Enable native sandboxing
const sandbox = new LocalSandbox({
  workingDirectory: './workspace',
  isolation: 'seatbelt', // or 'bwrap' on Linux
  nativeSandbox: {
    allowNetwork: false, // Block network access (default)
    readWritePaths: ['/tmp/extra'], // Additional writable paths
  },
});
```

When isolation is enabled:
- File writes are restricted to the workspace directory (and configured paths)
- File reads are allowed everywhere (needed for system binaries)
- Network access is blocked by default
- Process isolation prevents affecting the host system

## Related

- [Workspace Class](/reference/workspace/workspace-class)
- [Filesystem Interface](/reference/workspace/filesystem)
- [Workspace Overview](/docs/workspace/overview)
