---
title: "Guide: Building a Code Review Bot with Workspace Skills | Mastra"
description: Build an automated code review bot that uses workspace skills to enforce coding standards, run linters, and provide consistent PR feedback.
---

import Steps from "@site/src/components/Steps";
import StepItem from "@site/src/components/StepItem";

# Building a Code Review Bot with Workspace Skills

In this guide, you'll build a code review bot that automatically reviews pull requests using workspace skills. The bot loads coding standards from skill files, runs automated checks, and provides structured feedback.

## Before you begin

- A Mastra project ([Quickstart](/guides/getting-started/quickstart))
- An OpenAI API key
- Node.js v22.13.0+

## Create the workspace

<Steps>

<StepItem title="Set up workspace structure">

```bash
mkdir -p workspace/skills/code-standards/references
mkdir -p workspace/skills/code-standards/scripts
```

</StepItem>

<StepItem title="Configure workspace with skills">

```typescript title="src/mastra/index.ts"
import { resolve } from 'node:path';
import { Mastra } from '@mastra/core';
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: resolve(import.meta.dirname, '../../workspace'),
  }),
  skills: ['/skills'],
});

export const mastra = new Mastra({
  workspace,
});
```

</StepItem>

</Steps>

## Create the code standards skill

<Steps>

<StepItem title="Write the skill instructions">

```markdown title="workspace/skills/code-standards/SKILL.md"
---
name: code-standards
description: Automated code review standards and checks
version: 1.0.0
---

# Code Review Standards

Review code systematically using these steps:

1. **Critical Issues** - Security vulnerabilities, memory leaks, logic bugs, missing error handling
2. **Code Quality** - Functions over 50 lines, code duplication, confusing names, missing types
3. **Style Guide** - Check references/style-guide.md for naming and organization
4. **Automated Checks** - Run scripts/lint-check.ts

Provide feedback in this format:

**Summary**: One sentence overview

**Critical Issues**: List with line numbers

**Suggestions**: Improvements that would help

**Positive Notes**: What the code does well
```

</StepItem>

<StepItem title="Add style guide reference">

```markdown title="workspace/skills/code-standards/references/style-guide.md"
# Style Guide

## Naming
- Variables/Functions: `camelCase`
- Constants: `UPPER_SNAKE_CASE`
- Files: `kebab-case.ts`
- Booleans: Start with `is`, `has`, `should`

## Code Organization
\`\`\`typescript
// 1. Imports
import { foo } from 'bar';

// 2. Constants
const MAX_SIZE = 100;

// 3. Types
interface User { id: string; }

// 4. Functions
function doSomething() {}

// 5. Exports
export { doSomething };
\`\`\`

## Error Handling
Always handle errors explicitly - never silently catch.

## Comments
Write "why" not "what".
```

</StepItem>

<StepItem title="Add automated check script">

```typescript title="workspace/skills/code-standards/scripts/lint-check.ts"
interface CheckResult {
  passed: boolean;
  issues: string[];
}

export async function runLintCheck(code: string): Promise<CheckResult> {
  const issues: string[] = [];

  const checks = [
    { pattern: /var\s+/g, message: 'Use const or let instead of var' },
    { pattern: /console\.log/g, message: 'Remove console.log before committing' },
    { pattern: /TODO:/g, message: 'Resolve TODO comments' },
    { pattern: /debugger/g, message: 'Remove debugger statements' },
    { pattern: /\w{100,}/g, message: 'Lines should be under 100 characters' },
  ];

  for (const check of checks) {
    const matches = code.match(check.pattern);
    if (matches) {
      issues.push(`${check.message} (${matches.length} found)`);
    }
  }

  return { passed: issues.length === 0, issues };
}
```

</StepItem>

</Steps>

## Create the review agent

<Steps>

<StepItem title="Build the code reviewer">

```typescript title="src/mastra/agents/code-reviewer.ts"
import { Agent } from '@mastra/core/agent';

export const codeReviewer = new Agent({
  id: 'code-reviewer',
  name: 'Code Review Bot',
  instructions: `You are an automated code reviewer.

When asked to review code:
1. Activate the 'code-standards' skill
2. Follow the review process from the skill
3. Check against the style guide in skill references
4. Be constructive and specific with line numbers`,
  model: 'openai/gpt-4o',
});
```

</StepItem>

<StepItem title="Register the agent">

```typescript title="src/mastra/index.ts"
import { Mastra } from '@mastra/core';
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';
import { codeReviewer } from './agents/code-reviewer';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: './workspace',
  }),
  skills: ['/skills'],
});

export const mastra = new Mastra({
  workspace,
  agents: { codeReviewer },
});
```

</StepItem>

</Steps>

## Test the bot

<Steps>

<StepItem title="Start Mastra Studio">

```bash npm2yarn
npm run dev
```

Open [localhost:4111](http://localhost:4111) and navigate to the code reviewer agent.

</StepItem>

<StepItem title="Review some code">

Paste code to review:

```
Review this code:

function getData(id) {
  var result = fetch('/api/data/' + id);
  console.log(result);
  return result;
}
```

The bot will activate the code-standards skill and provide structured feedback:

```
**Summary**: Function has several issues with variable declaration,
debugging statements, and missing error handling.

**Critical Issues**:
- Missing error handling for fetch (line 2)
- No async/await for asynchronous operation (line 2)

**Suggestions**:
- Use const instead of var (line 2)
- Remove console.log before committing (line 3)
- Add TypeScript type for id parameter
- Use template literals instead of concatenation

**Positive Notes**:
- Function name is clear and descriptive
```

</StepItem>

</Steps>

## Next steps

You can extend this bot to:

- Add skills for different languages or frameworks
- Create skills for security checks and performance reviews
- Integrate with GitHub Actions for automatic PR reviews
- Build a PR comment bot that leaves inline feedback

Learn more:
- [Skills documentation](/docs/workspace/skills)
- [Workspace overview](/docs/workspace/overview)
- [Agent Skills spec](https://agentskills.io)
