---
title: "Guide: Building a Code Review Bot"
description: Build an automated code review bot that uses workspace skills to enforce coding standards and provide consistent PR feedback.
---

import Steps from "@site/src/components/Steps";
import StepItem from "@site/src/components/StepItem";

# Building a Code Review Bot

In this guide, you'll build a code review bot that automatically reviews pull requests using workspace skills. The bot loads coding standards from skill files and provides structured feedback. You'll learn how to create a workspace with a skills directory, define an [Agent Skill](https://agentskills.io) with review instructions and reference files, and connect it to an agent that performs automated reviews.

## Prerequisites

- Node.js `v22.13.0` or later installed
- An API key from a supported [Model Provider](/models)
- An existing Mastra project (Follow the [installation guide](/guides/getting-started/quickstart) to set up a new project)

## Create the workspace

To create a workspace, use the `Workspace` class with a `LocalFilesystem` and configure it with a skills directory.

<Steps>

<StepItem title="Configure workspace with skills">

Create the workspace configuration in your Mastra entry file. This sets up a local filesystem and tells the workspace to look for skills in the `/skills` directory:

```typescript title="src/mastra/index.ts"
import { resolve } from 'node:path';
import { Mastra } from '@mastra/core';
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: resolve(import.meta.dirname, '../../workspace'),
  }),
  skills: ['/skills'],
});

export const mastra = new Mastra({
  workspace,
});
```

</StepItem>

<StepItem title="Set up workspace structure">

Inside the `workspace` directory at your project root, create the folders `skills/code-standards/references`. This is where the skill definition and reference files will live.

</StepItem>

</Steps>

## Create the code standards skill

Skills are structured directories containing a `SKILL.md` file with instructions for the agent. The code standards skill defines the review process and references a style guide.

<Steps>

<StepItem title="Write the skill instructions">

Inside the `workspace/skills/code-standards` folder, create a file called `SKILL.md`. Give it the following contents:

```markdown title="workspace/skills/code-standards/SKILL.md"
---
name: code-standards
description: Automated code review standards and checks
---

# Code Review Standards

Review code systematically using these steps:

1. **Critical Issues** - Security vulnerabilities, memory leaks, logic bugs, missing error handling
2. **Code Quality** - Functions over 50 lines, code duplication, confusing names, missing types
3. **Style Guide** - Check references/style-guide.md for naming and organization
4. **Linting** - Flag common issues like use of `var`, leftover `console.log` statements, and `debugger` statements

Provide feedback in this format:

**Summary**: One sentence overview

**Critical Issues**: List with line numbers

**Suggestions**: Improvements that would help

**Positive Notes**: What the code does well
```

</StepItem>

<StepItem title="Add style guide reference">

Create a reference file at `workspace/skills/code-standards/references/style-guide.md` with the project's naming and organization conventions:

````markdown title="workspace/skills/code-standards/references/style-guide.md"
# Style Guide

## Naming
- Variables/Functions: `camelCase`
- Constants: `UPPER_SNAKE_CASE`
- Files: `kebab-case.ts`
- Booleans: Start with `is`, `has`, `should`

## Code Organization
```typescript
// 1. Imports
import { foo } from 'bar';

// 2. Constants
const MAX_SIZE = 100;

// 3. Types
interface User { id: string; }

// 4. Functions
function doSomething() {}

// 5. Exports
export { doSomething };
```

## Error Handling
Always handle errors explicitly - never silently catch.

## Comments
Write "why" not "what".
````

</StepItem>

</Steps>

## Create the review agent

<Steps>

<StepItem title="Build the code reviewer">

Create a new file `src/mastra/agents/code-reviewer.ts` and define the agent:

```typescript title="src/mastra/agents/code-reviewer.ts"
import { Agent } from '@mastra/core/agent';

export const codeReviewer = new Agent({
  id: 'code-reviewer',
  name: 'Code Review Bot',
  instructions: `You are an automated code reviewer.

When asked to review code:
1. Activate the 'code-standards' skill
2. Follow the review process from the skill
3. Check against the style guide in skill references
4. Be constructive and specific with line numbers`,
  model: 'openai/gpt-4o',
});
```

</StepItem>

<StepItem title="Register the agent">

Update your `src/mastra/index.ts` file to import and register the code reviewer agent:

```typescript title="src/mastra/index.ts"
import { resolve } from 'node:path';
import { Mastra } from '@mastra/core';
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';
import { codeReviewer } from './agents/code-reviewer';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: resolve(import.meta.dirname, '../../workspace'),
  }),
  skills: ['/skills'],
});

export const mastra = new Mastra({
  workspace,
  agents: { codeReviewer },
});
```

</StepItem>

</Steps>

## Test the bot

<Steps>

<StepItem title="Start Mastra Studio">

```bash npm2yarn
npm run dev
```

Open [localhost:4111](http://localhost:4111) and navigate to the code reviewer agent.

</StepItem>

<StepItem title="Review some code">

Paste code to review:

```
Review this code:

function getData(id) {
  var result = fetch('/api/data/' + id);
  console.log(result);
  return result;
}
```

The bot should activate the code-standards skill and provide structured feedback. Since agent responses are non-deterministic, your output may vary, but you should see something similar to:

```
**Summary**: Function has several issues with variable declaration,
debugging statements, and missing error handling.

**Critical Issues**:
- Missing error handling for fetch (line 2)
- No async/await for asynchronous operation (line 2)

**Suggestions**:
- Use const instead of var (line 2)
- Remove console.log before committing (line 3)
- Add TypeScript type for id parameter
- Use template literals instead of concatenation

**Positive Notes**:
- Function name is clear and descriptive
```

</StepItem>

</Steps>

## Next steps

You can extend this bot to:

- Add skills for different languages or frameworks
- Create skills for security checks and performance reviews
- Integrate with GitHub Actions for automatic PR reviews
- Build a PR comment bot that leaves inline feedback

Learn more:
- [Skills documentation](/docs/workspace/skills)
- [Workspace overview](/docs/workspace/overview)
- [Agent Skills spec](https://agentskills.io)
