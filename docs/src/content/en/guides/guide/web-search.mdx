---
title: "Web Search: Building an Agent that can search the web | Mastra Guide"
description: "A step-by-step guide to creating an agent that can search the web."
---

import { FileTree, Steps } from "nextra/components";
import { Tabs, Tab } from "@/components/tabs";

# Building an Agent that can search the web

When building a web search agent, you have two main strategies to consider:

1. **Native search tools from the LLM**: Certain language models offer integrated web search capabilities that work out of the box.
2. **Implement a custom search tool**: Develop your own integration with a search provider's API to handle queries and retrieve results.

## Prerequisites

- Node.js `v20.0` or later installed
- An API key from a supported [Model Provider](/models)
- An existing Mastra project (Follow the [installation guide](/docs/getting-started/installation) to set up a new project)

## Using native search tools
  <Steps>
  ### Install dependencies
  <Tabs items={["Open AI", "Gemini"]}>
  <Tab>
    ```bash copy
    npm install @ai-sdk/openai
    ```
    </Tab>
    <Tab>
  ```bash copy
    npm install @ai-sdk/google
    ```
    </Tab>
    </Tabs>

    ### Define the Agent

    Create a new file `src/mastra/agents/searchAgent.ts` and define your agent:

    <Tabs items={["Open AI", "Gemini"]}>
    <Tab>


    ```ts copy filename="src/mastra/agents/searchAgent.ts"
    import { Agent } from "@mastra/core/agent";

    export const searchAgent = new Agent({
        name: "search-agent",
        instructions:
            "You are a search agent that can search the web for information.",
        model: 'openai/gpt-4o-mini',
    });
    ```
    </Tab>
    <Tab>
 ```ts copy filename="src/mastra/agents/searchAgent.ts"
    import { Agent } from "@mastra/core/agent";

     export const searchAgent = new Agent({
        name: "search-agent",
        instructions:
            "You are a search agent that can search the web for information.",
        model: 'google/gemini-2.5-flash',
    });
    ```
    </Tab>
    </Tabs>


    ### Setup the tool
    <Tabs items={["Open AI", "Gemini"]}>
    <Tab>

    ```ts copy filename="src/mastra/agents/searchAgent.ts"
    import { openai } from "@ai-sdk/openai";
    import { Agent } from "@mastra/core/agent";

    export const searchAgent = new Agent({
        name: "search-agent",
        instructions:
            "You are a search agent that can search the web for information.",
        model: 'openai/gpt-4o-mini',
        tools: {
            webSearch: openai.tools.webSearch()
        }
    });
    ```
    </Tab>
    <Tab>
    ```ts copy filename="src/mastra/agents/searchAgent.ts"
    import { google } from "@ai-sdk/google";
    import { Agent } from "@mastra/core/agent";
    
    export const searchAgent = new Agent({
        name: "search-agent",
        instructions:
            "You are a search agent that can search the web for information.",
        model: 'google/gemini-2.5-flash',
        tools: {
            webSearch: google.tools.googleSearch()
        }
    });
    ```
    </Tab>
    </Tabs>

    ### Make some searches

    ```ts copy filename="src/mastra/agents/searchAgent.ts"
    const result = await searchAgent.generate(`
        What happened last week in AI news?
    `);

    console.log(result.text);
    console.log(result.sources);
    ```
    </Steps>

## Using Search APIs

<Steps>
    ### Install dependencies

    <Tabs items={["Exa"]}>
        <Tab>
        ```bash copy
        npm install exa-js
        ```
        </Tab>
    </Tabs>

    ### Define the Agent

    Create a new file `src/mastra/agents/searchAgent.ts` and define your agent:

   ```ts copy filename="src/mastra/agents/searchAgent.ts"
    import { Agent } from "@mastra/core/agent";

    export const searchAgent = new Agent({
        name: "search-agent",
        instructions:
            "You are a search agent that can search the web for information.",
        model: 'openai/gpt-4o-mini',
    });
    ```

    ### Setup the tool
       <Tabs items={["Exa"]}>
        <Tab>
        ```ts copy filename="src/mastra/tools/searchTool.ts"
        import { createTool } from "@mastra/core/tools";
        import z from "zod";
        import Exa from 'exa-js';

        export const exa = new Exa(process.env.EXA_API_KEY);

        export const webSearch = createTool({
            id: 'exa-web-search',
            description: 'Search the web',
            inputSchema: z.object({
                query: z.string()
                    .min(1)
                    .max(50)
                    .describe('The search query'),
            }),
            outputSchema: z.array(z.object({
                title: z.string().nullable(),
                url: z.string(),
                content: z.string(),
                publishedDate: z.string().optional(),
            })),
            execute: async ({ context }) => {
                const { results } = await exa.searchAndContents(
                    context.query, 
                    {
                        livecrawl: 'always',
                        numResults: 2,
                    }
                );

                return results.map(result => ({
                    title: result.title,
                    url: result.url,
                    content: result.text.slice(0, 500),
                    publishedDate: result.publishedDate,
                }));
            },
        });
        ```
           </Tab>
    </Tabs>

    ### Add to your Agent
        ```ts copy filename="src/mastra/agents/searchAgent.ts"
        import { webSearch } from './tools/searchTool';

        export const searchAgent = new Agent({
            name: "search-agent",
            instructions: "You are a search agent that can search the web for information.",
            model: 'openai/gpt-4o-mini',
            tools: {
                webSearch,
            },
        });
        ```

   ### Make some searches

    ```ts copy filename="src/mastra/agents/searchAgent.ts"
    const result = await searchAgent.generate(`
        What happened last week in AI news?
    `);

    console.log(result.text);
    ```
    </Steps>