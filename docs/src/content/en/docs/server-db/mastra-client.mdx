---
title: "MastraClient"
description: "Learn how to set up and use the Mastra Client SDK"
---

import { Tabs } from "nextra/components";

# Mastra Client SDK

The Mastra Client SDK provides a simple and type-safe interface for interacting with your [Mastra Server](/docs/deployment/server) from your client environment.

## Prerequisites

To ensure smooth local development, make sure you have:

- Node.js `v18` or higher
- TypeScript `v4.7` or higher (if using TypeScript)
- Your local Mastra server running (typically on port `4111`)

## Usage

The Mastra Client SDK is designed for browser environments and uses the native `fetch` API for making HTTP requests to your Mastra server.

## Installation

To use the Mastra Client SDK, install the required dependencies:

{/*
LLM CONTEXT:
This Tabs component shows installation commands for the Mastra Client SDK using different package managers.
Each tab displays the installation command for that specific package manager (npm, yarn, pnpm).
This helps users install the client SDK with their preferred package manager.
All commands install the same @mastra/client-js package but use different package manager syntax.
*/}

<Tabs items={["npm", "yarn", "pnpm", "bun"]}>
  <Tabs.Tab>
    ```bash copy
    npm install @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    yarn add @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    pnpm add @mastra/client-js@latest
    ```
  </Tabs.Tab>
    <Tabs.Tab>
    ```bash copy
    bun add @mastra/client-js@latest
    ```
  </Tabs.Tab>
</Tabs>

### Initialize the `MastraClient`

Initialize the `MastraClient` with a `baseUrl`.

```typescript filename="lib/mastra-client.ts" showLineNumbers copy
import { MastraClient } from "@mastra/client-js";

export const mastraClient = new MastraClient({
  baseUrl: process.env.MASTRA_API_URL || "http://localhost:4111"
});
```

## Usage example

Once initialized, `MastraClient` exposes a type-safe interface for calling agents, tools, and workflows.

```typescript showLineNumbers copy
import { mastraClient } from "lib/mastra-client";

const testAgent = async () => {
  try {
    const agent = mastraClient.getAgent("testAgent");

    const response = await agent.generate({
      messages: [
        {
          role: "user",
          content: "Hello"
        }
      ]
    });

    return response.text;
  } catch (error) {
    return "Error occurred while generating response";
  }
};
```

## Configuration options

`MastraClient` accepts optional parameters like `retries`, `backoffMs`, and `headers` to control request behavior. These are useful for tuning retries or passing custom metadata.

```typescript filename="lib/mastra-client.ts" showLineNumbers copy
import { MastraClient } from "@mastra/client-js";

export const mastraClient = new MastraClient({
  // ...
  retries: 3,
  backoffMs: 300,
  maxBackoffMs: 5000,
  headers: {
    "X-Development": "true",
  },
});
```

  > See [MastraClient](../../reference/client-js/mastra-client.mdx) for more configuration options.

## Adding request cancelling

`MastraClient` supports request cancellation using the standard Node.js `AbortSignal` API. This allows you to cancel in flight requests, useful for user-initiated aborts or cleaning up stale calls.

Pass an `AbortSignal` to the client constructor to enable cancellation across all requests.

```typescript {3,7} filename="lib/mastra-client.ts" showLineNumbers copy
import { MastraClient } from "@mastra/client-js";

export const controller = new AbortController();

export const mastraClient = new MastraClient({
  baseUrl: process.env.MASTRA_API_URL || "http://localhost:4111",
  abortSignal: controller.signal
});
```

### Using the `AbortController`

Calling `.abort()` will cancel any ongoing requests tied to that signal.

```typescript {4} showLineNumbers copy
import { mastraClient, controller } from "lib/mastra-client";

const handleAbort = () => {
  controller.abort();
};
```

## Client tools

The Mastra Client SDK provides comprehensive tools for interacting with your Mastra server from client-side applications. These tools are organized into several categories:

### Using `createTool()`

Use `clientTools` with `.generate()` or `.stream()` to pass tools defined in the frontend. Agents can trigger client-side actions such as DOM updates, local storage access, or browser API calls.

```typescript {27} showLineNumbers copy
import { createTool } from '@mastra/core/tools';
import { z } from 'zod';

const handleClientTool = async () => {
  try {
    const agent = mastraClient.getAgent("colorAgent");

    const colorChangeTool = createTool({
      id: "color-change-tool",
      description: "Changes the HTML background color",
      inputSchema: z.object({
        color: z.string()
      }),
      outputSchema: z.object({
        success: z.boolean()
      }),
      execute: async ({ context }) => {
        const { color } = context

        document.body.style.backgroundColor = color;
        return { success: true };
      }
    });

    const response = await agent.generate({
      messages: "Change the background to blue",
      clientTools: { colorChangeTool }
    });

    console.log(response);
  } catch (error) {
    console.error(error);
  }
};
```

### Example agent

This is a standard Mastra agent that returns hex color codes based on user input. It's intended to work with the client tool above, which runs in the browser.

```typescript filename="src/mastra/agents/color-agent" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";

export const colorAgent = new Agent({
  name: "test-agent",
  instructions: `You are a helpful CSS assistant.
  You  can change the background color of web pages.
  Respond with a hex reference for the color requested by the user`,
  model: openai("gpt-4o-mini")
});
```

## Best practices

1. **Error Handling**: Implement proper [error handling](/reference/client-js/error-handling) for development scenarios.
2. **Environment Variables**: Use environment variables for configuration.
3. **Debugging**: Enable detailed [logging](/reference/client-js/logs) when needed.
4. **Performance**: Monitor application performance, [telemetry](/reference/client-js/telemetry) and traces.

## Core APIs

`MastraClient` exposes all resources served by the Mastra Server

- **[Agents](/reference/client-js/agents.mdx)**: Generate responses and stream conversations.
- **[Memory](/reference/client-js/memory.mdx)**: Manage conversation threads and message history.
- **[Tools](/reference/client-js/tools.mdx)**: Executed and managed tools.
- **[Workflows](/reference/client-js/workflows.mdx)**: Trigger workflows and track their execution.
- **[Vectors](/reference/client-js/vectors.mdx)**: Use vector embeddings for semantic search.
- **[Logs](/reference/client-js/logs.mdx)**: View logs and debug system behavior.
- **[Telemetry](/reference/client-js/telemetry.mdx)**: Monitor app performance and trace activity.

## Debug

- Sometimes when using MastraClient on the server instead of the client e.g `/api/chat`,
  you might need to recreate the response to your client:

```typescript
const result = agent.stream(/* get your agent stream */);
return new Response(result.body);
```
