---
title: "Human-in-the-loop | Workflows | Mastra Docs"
description: "Human-in-the-loop workflows in Mastra allow you to pause execution for manual approvals, reviews, or user input before continuing."
---

# Human-in-the-loop

Some workflows need to pause for a human decision before continuing. When a workflow is [suspended](/docs/workflows/suspend-and-resume#pausing-a-workflow-with-suspend), feedback can be sent to the user, allowing them to review, approve, or modify the next step. The workflow [resumes](/docs/workflows/suspend-and-resume#restarting-a-workflow-with-resume) only once input is received, making this pattern ideal for gated decisions, manual approvals, or any step requiring human oversight.

## Requesting human approval with `suspend()`

Use `suspend()` to pause workflow execution at a specific step while waiting for human approval. If a `resumeSchema` condition isn’t met, the workflow suspends at `return suspend()`. No further logic runs, and only the values validated against the optional `suspendSchema` and passed to `suspend()` are returned. The step’s main return block is skipped, and workflow execution doesn’t continue.

![Pausing a workflow with suspend()](/img/workflows/workflows-suspend-resume-suspend.jpg)

```typescript {12-17,22-26} title="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
import { createWorkflow, createStep } from "@mastra/core/workflows";
import { z } from "zod";

const step1 = createStep({
  id: "step-1",
  inputSchema: z.object({
    userEmail: z.string()
  }),
  outputSchema: z.object({
    output: z.string()
  }),
  resumeSchema: z.object({
    okToSend: z.boolean()
  }),
  suspendSchema: z.object({
    reason: z.string()
  }),
  execute: async ({ inputData, resumeData, suspend }) => {
    const { userEmail } = inputData;
    const { okToSend } = resumeData ?? {};

    if (!okToSend) {
      return await suspend({
        reason: "Human approval required."
      });
    }

    await fetch("https://httpbin.org/post", {
      method: "POST",
      body: JSON.stringify({ to: userEmail })
    });

    return {
      output: `Email sent to ${userEmail}`
    };
  }
});

export const testWorkflow = createWorkflow({
  id: "test-workflow",
  inputSchema: z.object({
    userEmail: z.string()
  }),
  outputSchema: z.object({
    output: z.string()
  })
})
  .then(step1)
  .commit();
```

## Applying human input with `resume()`

Use `resume()` to restart a suspended workflow from the step where it paused. To satisfy the step’s suspend condition, pass a value using `resumeData` that matches the step's `resumeSchema`, allowing execution to continue from where it left off.

![Restarting a workflow with resume()](/img/workflows/workflows-suspend-resume-resume.jpg)

```typescript {13} showLineNumbers copy
const workflow = mastra.getWorkflow("testWorkflow");
const run = await workflow.createRunAsync();

const result = await run.start({
  inputData: {
    userEmail: "alex@example.com"
  }
});

const handleResume = async () => {
  const resumedResult = await run.resume({
    step: "step-1",
    resumeData: { okToSend: true }
  });
  console.log(resumedResult);
};
```

## Surfacing suspended reasons

When a workflow is suspended, the step can return structured data that explains why it was paused and what input is needed to resume. The data is returned using `suspend()` and available in the `suspendPayload`.

```typescript {12} title="src/test-workflow.ts" showLineNumbers copy
const workflow = mastra.getWorkflow("testWorkflow");
const run = await workflow.createRunAsync();

const result = await run.start({
  inputData: {
    userEmail: "alex@example.com"
  }
});

if (result.status === "suspended") {
  const suspendStep = result.suspended[0];
  const suspendedPayload = result.steps[suspendStep[0]].suspendPayload;

  console.log(suspendedPayload);
}
```

**Example output**

The data returned by the step can include a reason and help the user understand what’s needed to resume the workflow.

```typescript
{ reason: 'Human approval required.' }
```

## Related

- [Control Flow](/docs/workflows/control-flow)
- [Suspend & Resume](/docs/workflows/suspend-and-resume)
