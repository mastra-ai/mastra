---
title: "Human-in-the-loop (HITL) | Workflows | Mastra Docs"
description: "Human-in-the-loop workflows in Mastra allow you to pause execution for manual approvals, reviews, or user input before continuing."
---

# Human-in-the-loop (HITL)

Some workflows need to pause for a human decision before continuing. When a workflow is [suspended](/docs/workflows/suspend-and-resume#pausing-a-workflow-with-suspend), it can include a message explaining why it paused. The workflow [resumes](/docs/workflows/suspend-and-resume#restarting-a-workflow-with-resume) only after input is received. You can use this approach for manual approvals, gated decisions, or any step that requires human oversight.

## Pausing workflows for human approval

Human-in-the-loop approval works much like [pausing a workflow](/docs/workflows/suspend-and-resume) using `suspend()`. The key difference is that when human input is required, you can return `suspend()` with a payload that provides context or guidance to the user on how to continue.

![Pausing a workflow with suspend()](/img/workflows/workflows-suspend-resume-suspend.jpg)

```typescript {12-17,22-26} title="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
import { createWorkflow, createStep } from "@mastra/core/workflows";
import { z } from "zod";

const step1 = createStep({
  id: "step-1",
  inputSchema: z.object({
    userEmail: z.string()
  }),
  outputSchema: z.object({
    output: z.string()
  }),
  resumeSchema: z.object({
    okToSend: z.boolean()
  }),
  suspendSchema: z.object({
    reason: z.string()
  }),
  execute: async ({ inputData, resumeData, suspend }) => {
    const { userEmail } = inputData;
    const { okToSend } = resumeData ?? {};

    if (!okToSend) {
      return await suspend({
        reason: "Confirm to send email."
      });
    }

    await fetch("https://httpbin.org/post", {
      method: "POST",
      body: JSON.stringify({ to: userEmail })
    });

    return {
      output: `Email sent to ${userEmail}`
    };
  }
});

export const testWorkflow = createWorkflow({
  id: "test-workflow",
  inputSchema: z.object({
    userEmail: z.string()
  }),
  outputSchema: z.object({
    output: z.string()
  })
})
  .then(step1)
  .commit();
```

## Providing user feedback

When a workflow is suspended, you can access the payload returned by `suspend()` by identifying the suspended step and reading its `suspendPayload`.

```typescript {12} title="src/test-workflow.ts" showLineNumbers copy
const workflow = mastra.getWorkflow("testWorkflow");
const run = await workflow.createRunAsync();

const result = await run.start({
  inputData: {
    userEmail: "alex@example.com"
  }
});

if (result.status === "suspended") {
  const suspendStep = result.suspended[0];
  const suspendedPayload = result.steps[suspendStep[0]].suspendPayload;

  console.log(suspendedPayload);
}
```
**Example output**

The data returned by the step can include a reason and help the user understand whatâ€™s needed to resume the workflow.

```typescript
{ reason: 'Confirm to send email.' }
```

## Resuming workflows with human approval

As with [restarting a workflow](/docs/workflows/suspend-and-resume#restarting-a-workflow-with-resume), call `resume()` with `resumeData` to restart the workflow from where it was paused.

![Restarting a workflow with resume()](/img/workflows/workflows-suspend-resume-resume.jpg)

```typescript {13} showLineNumbers copy
const workflow = mastra.getWorkflow("testWorkflow");
const run = await workflow.createRunAsync();

const result = await run.start({
  inputData: {
    userEmail: "alex@example.com"
  }
});

const handleResume = async () => {
  const resumedResult = await run.resume({
    step: "step-1",
    resumeData: { okToSend: true }
  });
  console.log(resumedResult);
};
```

## Related

- [Control Flow](/docs/workflows/control-flow)
- [Suspend & Resume](/docs/workflows/suspend-and-resume)
