---
title: "Cloud Providers"
description: "Deploy your Mastra applications to popular cloud providers."
---

import { Callout, Steps, Tabs } from "nextra/components";

# Cloud Providers

Deploy your Mastra applications to popular cloud providers.

<Tabs items={["Digital Ocean"]}>

   <Tabs.Tab>
      ## Digital Ocean

      <Tabs items={["App Platform", "Droplets"]}>
      <Tabs.Tab>
         Deploy your Mastra application to Digital Ocean's App Platform using your preferred Git repository provider.

         #### Prerequisites

      - A Git repository containing your Mastra application. This can be a GitHub repository, GitLab repository, or any other compatible source provider.
      - A Digital Ocean account

      #### Deployment Steps

      <Steps>
      ##### Create a new App
      - Log in to your Digital Ocean dashboard.
      - Navigate to the App Platform service.
      - Select your source provider and create a new app.

      ##### Configure Deployment Source
      - Connect and select your repository. You may also choose a container image or a sample app.
      - Select the branch you want to deploy from.
      - Configure the source directory if necessary. If your Mastra application uses the default directory structure, no action is required here.
      - Head to the next step.

      ##### Configure Resource Settings and Environment Variables
      - A Node.js build should be detected automatically.
      - Add any required environment variables for your Mastra application. This includes API keys, database URLs, and other configuration values.
      - You may choose to configure the size of your resource here.
      - Other things you may optionally configure include, the region of your resource, the unique app name, and what project the resource belongs to.
      - Once you're done, you may create the app after reviewing your configuration and pricing estimates.

      ##### Deployment
      - Your app will be built and deployed automatically.
      - Digital Ocean will provide you with a URL to access your deployed application.
      </Steps>

      You can now access your deployed application at the URL provided by Digital Ocean.

      <Callout>
         The Digital Ocean App Platform uses an ephemeral file system, meaning that any files written to the file system are short-lived and may be lost.
         Avoid using a Mastra storage provider that uses the file system, such as `LibSQLStore` with a file URL.
      </Callout>
   </Tabs.Tab>
   <Tabs.Tab>
      Deploy your Mastra application to Digital Ocean's Droplets.
      This guide will cover setting up a droplet, a reverse proxy using Nginx, and running your Mastra application.

      <Callout>
        The guide assumes your droplet runs Ubuntu 24+.
      </Callout>

      #### Prerequisites

      - A Digital Ocean account
      - A droplet running Ubuntu 24+
      - A domain name with an A record pointing to your droplet

      #### Setting up the droplet

      <Steps>
         ##### Update the system
         Update the system packages before installing any new packages.

         ```bash copy
         sudo apt update && sudo apt upgrade -y
         ```

         ##### Install nginx

         ```bash copy
         sudo apt install nginx -y
         ```

         ##### Remove nginx files if they exist

         Let's start by setting up an environment variable for the site name. In our example, we will use `mastra` as the site name.

         ```bash copy
         export SITE_NAME="mastra"
         ```

         Then we can remove the nginx files if they exist.

         ```bash copy
         sudo rm -f /etc/nginx/sites-available/$SITE_NAME
         sudo rm -f /etc/nginx/sites-enabled/$SITE_NAME
         ```

         ##### Set up certbot for SSL

         To set up certbot for SSL, let's start by stopping nginx temporarily.

         ```bash copy
         sudo systemctl stop nginx
         ```

         Now we can obtain a certificate for our domain name. 

         Let's start by setting up an environment variable for the domain name and email.
         Replace `<your-domain-name>` with your domain name and `<your-email>` with your email.

         ```bash copy
         export DOMAIN_NAME="<your-domain-name>"
         export EMAIL="<your-email>"
         ```

         ```bash copy
         sudo apt install certbot -y
         sudo certbot certonly --standalone -d $DOMAIN_NAME --non-interactive --agree-tos -m $EMAIL
         ```

         Finally, let's ensure that the SSL files exists or we generate them.

         ```bash copy
         if [ ! -f /etc/letsencrypt/options-ssl-nginx.conf ]; then
            sudo wget https://raw.githubusercontent.com/certbot/certbot/refs/heads/main/certbot-nginx/src/certbot_nginx/_internal/tls_configs/options-ssl-nginx.conf -P /etc/letsencrypt/
         fi

         if [ ! -f /etc/letsencrypt/ssl-dhparams.pem ]; then
            sudo openssl dhparam -out /etc/letsencrypt/ssl-dhparams.pem 2048
         fi
         ```

         ##### Configure nginx

         ```bash copy
         sudo cat > /etc/nginx/sites-available/$SITE_NAME <<EOL
         limit_req_zone \$binary_remote_addr zone=mylimit:10m rate=10r/s;

         server {
            listen 80;
            server_name $DOMAIN_NAME;

            # Redirect all HTTP requests to HTTPS
            return 301 https://\$host\$request_uri;
         }

         server {
            listen 443 ssl;
            server_name $DOMAIN_NAME;

            ssl_certificate /etc/letsencrypt/live/$DOMAIN_NAME/fullchain.pem;
            ssl_certificate_key /etc/letsencrypt/live/$DOMAIN_NAME/privkey.pem;
            include /etc/letsencrypt/options-ssl-nginx.conf;
            ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

            # Enable rate limiting
            limit_req zone=mylimit burst=20 nodelay;

            location / {
               # Proxy to Mastra server running on port 4111
               proxy_pass http://localhost:4111;
               proxy_http_version 1.1;
               proxy_set_header Upgrade \$http_upgrade;
               proxy_set_header Connection 'upgrade';
               proxy_set_header Host \$host;
               proxy_cache_bypass \$http_upgrade;

               # Disable buffering for streaming support
               proxy_buffering off;
               proxy_set_header X-Accel-Buffering no;
            }
         }
         EOL
         ```

         <Callout>
         To ensure there's no issues with streaming, we need to disable buffering. That's why we have **`proxy_buffering off;`** and **`proxy_set_header X-Accel-Buffering no;`**.
         </Callout>

         Create a symbolic link to the site in the sites-enabled directory.

         ```bash copy
         sudo ln -s /etc/nginx/sites-available/$SITE_NAME /etc/nginx/sites-enabled/$SITE_NAME
         ```

         Restart nginx.

         ```bash copy
         sudo systemctl restart nginx
         ```

         ##### Install nodejs

         We need to install nodejs to run the Mastra application. We will do this using `nvm`.

         ```bash copy
         curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
         ```

         Once the installation is complete, you can verify the installation by running:

         ```bash copy
         nvm --version
         ```

         Now we can install the latest LTS version of nodejs.

         ```bash copy
         nvm install --lts
         ```

         Once the installation is complete, you can verify the installation by running:

         ```bash copy
         node --version
         ```

         ##### Clone your Mastra application

         <Tabs items={["Public Repository", "Private Repository"]}>
            <Tabs.Tab>
            ```bash copy
            git clone https://github.com/<your-username>/<your-repository>.git
            ```
            </Tabs.Tab>
            <Tabs.Tab>
            ```bash copy
            git clone https://<your-username>:<your-personal-access-token>@github.com/<your-username>/<your-repository>.git
            ```
            </Tabs.Tab>
         </Tabs>

         Navigate to the repository directory.

         ```bash copy
         cd "<your-repository>"
         ```

         ##### Install dependencies

         ```bash copy
         npm install
         ```

         ##### Set up environment variables

         Create a `.env` file and add your environment variables.

         ```bash copy
         touch .env
         ```

         Then edit `.env` and add your environment variables.

         ##### Build the application

         ```bash copy
         npm run build
         ```

         ##### Run the application

         ```bash copy
         node --import=./.mastra/output/instrumentation.mjs --env-file=".env" .mastra/output/index.mjs
         ```
      </Steps>

   </Tabs.Tab>
   </Tabs>

   </Tabs.Tab>

   ### Connect to your Mastra server

   You can now connect to your Mastra server from your client application using a `MastraClient` from the `@mastra/client-js` package.

   ```typescript copy showLineNumbers
   import { MastraClient } from "@mastra/client-js";

   const mastraClient = new MastraClient({
      baseUrl: "https://<your-domain-name>",
   });
   ```
</Tabs>