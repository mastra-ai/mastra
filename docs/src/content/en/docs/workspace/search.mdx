---
title: "Search and Indexing | Workspace"
description: Index workspace content for BM25 keyword search, vector semantic search, or hybrid mode.
packages:
  - "@mastra/core"
---

# Search and Indexing

Workspaces support three search modes: BM25 keyword search, vector semantic search, and hybrid search that combines both.

## BM25 keyword search

BM25 scores documents based on term frequency and document length. It works well for exact matches and specific terminology.

```typescript
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
});
```

For custom BM25 parameters:

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: {
    k1: 1.2,   // Term frequency saturation (default: 1.2)
    b: 0.75,  // Document length normalization (default: 0.75)
  },
});
```

## Vector search

Vector search uses embeddings to find semantically similar content. It requires a vector store and embedder function.

```typescript
import { PineconeVector } from '@mastra/pinecone';
import { embed } from 'ai';
import { openai } from '@ai-sdk/openai';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  vectorStore: new PineconeVector({
    apiKey: process.env.PINECONE_API_KEY,
    index: 'workspace-index',
  }),
  embedder: async (text: string) => {
    const { embedding } = await embed({
      model: openai.embedding('text-embedding-3-small'),
      value: text,
    });
    return embedding;
  },
});
```

## Hybrid search

Configure both BM25 and vector search to enable hybrid mode, which combines keyword matching with semantic understanding.

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
  vectorStore: pineconeVector,
  embedder: embedderFn,
});
```

## Indexing content

### Manual indexing

```typescript
await workspace.index('/docs/guide.md', 'Content of the guide...');
```

### Auto-indexing

Configure `autoIndexPaths` to index files when the workspace initializes:

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
  autoIndexPaths: ['/docs', '/support/faq'],
});

await workspace.init(); // Indexes all files in specified paths
```

## Searching

```typescript
const results = await workspace.search('password reset');
```

With options:

```typescript
const results = await workspace.search('authentication flow', {
  topK: 10,         // Maximum results (default: 5)
  mode: 'hybrid',   // 'bm25' | 'vector' | 'hybrid'
  threshold: 0.5,   // Minimum score threshold
});
```

### When to use each mode

| Mode | Use case |
|------|----------|
| `bm25` | Exact term matching, technical queries, code search |
| `vector` | Conceptual queries, natural language questions |
| `hybrid` | General search combining both approaches |

## Agent tools

Agents with a search-enabled workspace receive:

- `workspace_search` - Search indexed content
- `workspace_index` - Index new content

## Related

- [Workspace Overview](/docs/workspace/overview)
- [RAG Overview](/docs/rag/overview)
- [Workspace Class Reference](/reference/workspace/workspace-class)
