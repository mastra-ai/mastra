---
title: "Search and Indexing | Workspace"
description: Index workspace content for BM25 keyword search, vector semantic search, or hybrid mode.
packages:
  - "@mastra/core"
---

# Search and Indexing

Search lets agents find relevant content in indexed workspace files. When an agent needs to answer a question or find information, it can search the indexed content instead of reading every file.

## How it works

1. **Indexing** - Content is processed and stored in a searchable format (BM25 index, vector embeddings, or both)
2. **Querying** - The agent sends a search query
3. **Ranking** - Results are scored and ranked by relevance
4. **Results** - The agent receives the most relevant content with file paths and scores

Workspaces support three search modes: BM25 keyword search, vector semantic search, and hybrid search that combines both.

## BM25 keyword search

BM25 scores documents based on term frequency and document length. It works well for exact matches and specific terminology.

```typescript
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
});
```

For custom BM25 parameters:

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: {
    k1: 1.2,   // Term frequency saturation (default: 1.2)
    b: 0.75,  // Document length normalization (default: 0.75)
  },
});
```

## Vector search

Vector search uses embeddings to find semantically similar content. It requires a vector store and embedder function.

```typescript
import { Workspace, LocalFilesystem } from '@mastra/core/workspace';
import { PineconeVector } from '@mastra/pinecone';
import { embed } from 'ai';
import { openai } from '@ai-sdk/openai';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  vectorStore: new PineconeVector({
    apiKey: process.env.PINECONE_API_KEY,
    index: 'workspace-index',
  }),
  embedder: async (text: string) => {
    const { embedding } = await embed({
      model: openai.embedding('text-embedding-3-small'),
      value: text,
    });
    return embedding;
  },
});
```

## Hybrid search

Configure both BM25 and vector search to enable hybrid mode, which combines keyword matching with semantic understanding.

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
  vectorStore: pineconeVector,
  embedder: embedderFn,
});
```

## Indexing content

### Manual indexing

```typescript
await workspace.index('/docs/guide.md', 'Content of the guide...');
```

### Auto-indexing

Configure `autoIndexPaths` to automatically index files when the workspace initializes. Each path specifies a directory to index recursively.

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
  autoIndexPaths: ['/docs', '/support/faq'],
});
```

When `init()` is called (either explicitly or automatically when an agent uses the workspace), all files in the specified directories are read and indexed for search.

:::note
Paths must be directories, not glob patterns. Use `/docs` to index all files in the docs directory recursively. Glob patterns like `**/*.md` are not supported.
:::

## Searching

```typescript
const results = await workspace.search('password reset');
```

With options:

```typescript
const results = await workspace.search('authentication flow', {
  topK: 10,           // Maximum results (default: 5)
  mode: 'hybrid',     // 'bm25' | 'vector' | 'hybrid'
  minScore: 0.5,      // Minimum score threshold
  vectorWeight: 0.5,  // Weight for vector scores in hybrid (0-1)
});
```

### When to use each mode

| Mode | Use case |
|------|----------|
| `bm25` | Exact term matching, technical queries, code search |
| `vector` | Conceptual queries, natural language questions |
| `hybrid` | General search combining both approaches |

## Agent tools

When you configure search on a workspace, agents receive tools for searching and indexing content. See [Workspace Class Reference](/reference/workspace/workspace-class#search-tools) for details.

## Related

- [Workspace Overview](/docs/workspace/overview)
- [RAG Overview](/docs/rag/overview)
- [Workspace Class Reference](/reference/workspace/workspace-class)
