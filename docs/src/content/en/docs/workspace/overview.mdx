---
title: "Workspace | Mastra Docs"
description: Give agents filesystem access and code execution through workspaces.
packages:
  - "@mastra/core"
---

# Workspace

A workspace gives agents a persistent environment for storing files and executing commands. Agents use workspace tools to read and write files, run shell commands, and search indexed content.

## How Workspaces Work

A workspace combines two components:

- **Filesystem provider** - Handles file storage (read, write, list, delete)
- **Sandbox provider** - Handles command execution (shell commands)

When you assign a workspace to an agent, Mastra automatically adds workspace tools to the agent's toolset. The agent can then use these tools to interact with files and execute commands as part of its task.

You can create a workspace with just a filesystem (file storage only), just a sandbox (command execution only), or both. The agent receives only the tools relevant to the configured providers.

## Filesystem Providers

Filesystem providers determine where files are stored. All file operations go through the provider, which handles the actual storage.

**LocalFilesystem** stores files in a directory on disk:

```typescript
import { LocalFilesystem } from '@mastra/core/workspace';

const filesystem = new LocalFilesystem({
  basePath: './workspace',
});
```

All file paths are relative to `basePath`. A path like `/docs/guide.md` maps to `./workspace/docs/guide.md` on disk.

See [Filesystem Reference](/reference/workspace/filesystem) for the full API.

## Sandbox Providers

Sandbox providers execute shell commands.

**LocalSandbox** runs commands locally:

```typescript
import { LocalSandbox } from '@mastra/core/workspace';

const sandbox = new LocalSandbox({
  workingDirectory: './workspace',
});
```

- `workingDirectory` - Where shell commands run from
- `env` - Environment variables to pass (PATH is included by default unless overridden)
- `isolation` - Native OS sandboxing: `'seatbelt'` (macOS) or `'bwrap'` (Linux)

See [Sandbox Reference](/reference/workspace/sandbox) for the full API.

## Creating a Workspace

Combine providers into a workspace:

```typescript
import { Workspace, LocalFilesystem, LocalSandbox } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: './workspace',
  }),
  sandbox: new LocalSandbox({
    workingDirectory: './workspace',
  }),
});

await workspace.init();
```

The `init()` call starts the sandbox and indexes any files in `autoIndexPaths` if search is configured.

## Global Workspace

Set a workspace on the Mastra instance. All agents inherit this workspace unless they define their own:

```typescript
import { Mastra } from '@mastra/core';

const mastra = new Mastra({
  workspace,
  agents: { myAgent },
});
```

## Agent-scoped Workspace

Assign a workspace directly to an agent to override the global workspace:

```typescript
import { Agent } from '@mastra/core/agent';

export const myAgent = new Agent({
  id: 'my-agent',
  model: 'openai/gpt-4o',
  workspace,
});
```

## Skills

Skills are reusable instructions that teach agents how to perform specific tasks. They follow the [Agent Skills specification](https://agentskills.io) - an open standard for packaging agent capabilities.

A skill is a folder containing a `SKILL.md` file with metadata and instructions, plus optional reference files, scripts, and assets:

```
/skills
  /code-review
    SKILL.md          # Instructions for code review
    /references
      style-guide.md  # Supporting documentation
    /scripts
      lint.ts         # Executable scripts
```

Configure `skills` to enable skill discovery:

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  skills: ['/skills'],
});
```

When skills are configured, agents receive a `SkillsProcessor` that injects available skills into the system message and allows agents to activate skills during conversation.

## Agent Tools

A workspace provides tools to agents based on what is configured:

**Filesystem tools** (when filesystem is configured):
- `mastra_workspace_read_file` - Read file contents
- `mastra_workspace_write_file` - Write file contents
- `mastra_workspace_edit_file` - Edit file by replacing text
- `mastra_workspace_list_files` - List directory contents
- `mastra_workspace_delete` - Delete files or directories
- `mastra_workspace_file_stat` - Get file metadata
- `mastra_workspace_mkdir` - Create directories

**Sandbox tools** (when sandbox is configured):
- `mastra_workspace_execute_command` - Execute shell commands

**Search tools** (when BM25 or vector search is configured):
- `mastra_workspace_search` - Search indexed content
- `mastra_workspace_index` - Index content for search

Only the relevant tools are added. A workspace with only a filesystem won't have command execution tools.

See [Workspace Class Reference](/reference/workspace/workspace-class) for details.

## Tool Configuration

Configure tool behavior through the `tools` option on the Workspace. This controls which tools are enabled and their safety settings.

```typescript
import { WORKSPACE_TOOLS } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  sandbox: new LocalSandbox({ workingDirectory: './workspace' }),
  tools: {
    // Global defaults
    enabled: true,
    requireApproval: false,

    // Per-tool overrides
    [WORKSPACE_TOOLS.FILESYSTEM.WRITE_FILE]: {
      requireApproval: true,
      requireReadBeforeWrite: true,
    },
    [WORKSPACE_TOOLS.FILESYSTEM.DELETE]: {
      enabled: false,
    },
    [WORKSPACE_TOOLS.SANDBOX.EXECUTE_COMMAND]: {
      requireApproval: true,
    },
  },
});
```

### Tool Options

| Option | Type | Description |
|--------|------|-------------|
| `enabled` | `boolean` | Whether the tool is available (default: `true`) |
| `requireApproval` | `boolean` | Whether the tool requires user approval before execution (default: `false`) |
| `requireReadBeforeWrite` | `boolean` | For write tools: require reading the file first (default: `false`) |

### Read-before-write

When `requireReadBeforeWrite` is enabled on write tools, agents must read a file before writing to it. This prevents overwriting files the agent hasn't seen:

- **New files** - Can be written without reading (they don't exist yet)
- **Existing files** - Must be read first
- **Externally modified files** - If a file changed since the agent read it, the write fails

### Read-only Mode

To make a filesystem read-only, set `readOnly: true` on the LocalFilesystem:

```typescript
const filesystem = new LocalFilesystem({
  basePath: './workspace',
  readOnly: true,
});
```

When read-only, write tools (`write_file`, `edit_file`, `delete`, `mkdir`) are not added to the agent's toolset.

## Search

Enable search to let agents find content in workspace files. See [Search and Indexing](/docs/workspace/search) for details.

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
  autoIndexPaths: ['/docs'],
});
```

## Related

- [Search and Indexing](/docs/workspace/search)
- [Workspace Class Reference](/reference/workspace/workspace-class)
- [Filesystem Reference](/reference/workspace/filesystem)
- [Sandbox Reference](/reference/workspace/sandbox)
