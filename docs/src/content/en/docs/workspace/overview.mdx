---
title: "Workspace | Mastra Docs"
description: Give agents filesystem access and code execution through workspaces.
packages:
  - "@mastra/core"
---

# Workspace

A workspace gives agents a persistent environment for storing files and executing code. Agents use workspace tools to read and write files, run code in different runtimes, and search indexed content.

## How workspaces work

A workspace combines two components:

- **Filesystem provider** - Handles file storage (read, write, list, delete)
- **Sandbox provider** - Handles code execution (Python, JavaScript, TypeScript, shell commands)

When you assign a workspace to an agent, Mastra automatically adds workspace tools to the agent's toolset. The agent can then use these tools to interact with files and execute code as part of its task.

You can create a workspace with just a filesystem (file storage only), just a sandbox (code execution only), or both. The agent receives only the tools relevant to the configured providers.

## Filesystem providers

Filesystem providers determine where files are stored. All file operations go through the provider, which handles the actual storage.

**LocalFilesystem** stores files in a directory on disk:

```typescript
import { LocalFilesystem } from '@mastra/core/workspace';

const filesystem = new LocalFilesystem({
  basePath: './workspace',
});
```

All file paths are relative to `basePath`. A path like `/docs/guide.md` maps to `./workspace/docs/guide.md` on disk.

See [Filesystem Reference](/reference/workspace/filesystem) for the full API.

## Sandbox providers

Sandbox providers execute code and shell commands. The sandbox handles runtime selection, dependency management, and process isolation.

**LocalSandbox** runs code locally using system interpreters (Node.js, Python):

```typescript
import { LocalSandbox } from '@mastra/core/workspace';

const sandbox = new LocalSandbox({
  workingDirectory: './workspace',
  scriptDirectory: './.mastra/sandbox',
  inheritEnv: false,
});
```

- `workingDirectory` - Where shell commands run from
- `scriptDirectory` - Where code files are written before execution
- `inheritEnv` - Whether to pass `process.env` to executed code (default: `false` for security)

See [Sandbox Reference](/reference/workspace/sandbox) for the full API.

## Creating a workspace

Combine providers into a workspace:

```typescript
import { Workspace, LocalFilesystem, LocalSandbox } from '@mastra/core/workspace';

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: './workspace',
  }),
  sandbox: new LocalSandbox({
    workingDirectory: './workspace',
  }),
});

await workspace.init();
```

The `init()` call starts the sandbox and indexes any files in `autoIndexPaths` if search is configured.

## Global workspace

Set a workspace on the Mastra instance. All agents inherit this workspace unless they define their own:

```typescript
import { Mastra } from '@mastra/core';

const mastra = new Mastra({
  workspace,
  agents: { myAgent },
});
```

## Agent-scoped workspace

Assign a workspace directly to an agent to override the global workspace:

```typescript
import { Agent } from '@mastra/core/agent';

export const myAgent = new Agent({
  id: 'my-agent',
  model: 'openai/gpt-4o',
  workspace,
});
```

## Skills

Skills are reusable instructions that teach agents how to perform specific tasks. They follow the [Agent Skills specification](https://agentskills.io) - an open standard for packaging agent capabilities.

A skill is a folder containing a `SKILL.md` file with metadata and instructions, plus optional reference files, scripts, and assets. When an agent activates a skill, the instructions are injected into its context.

```
/skills
  /code-review
    SKILL.md          # Instructions for code review
    /references
      style-guide.md  # Supporting documentation
    /scripts
      lint.ts         # Executable scripts
```

Configure `skillsPaths` to enable skill discovery:

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  skillsPaths: ['/skills'],
});
```

When skills are configured, agents receive a `SkillsProcessor` that:
- Injects available skills into the system message
- Provides tools for activating skills (`skill-activate`)
- Provides tools for searching skill content (`skill-search`)
- Provides tools for reading references, scripts, and assets

## Agent tools and processors

A workspace provides tools and processors to agents based on what is configured:

- **Filesystem** - Tools for reading, writing, editing, listing, and deleting files
- **Sandbox** - Tools for executing code, running shell commands, and installing packages
- **Search** - Tools for searching and indexing workspace content
- **Skills** - A processor that injects skill instructions into the system message, plus tools for activating and reading skills

Only the relevant tools are added. A workspace with only a filesystem won't have code execution tools.

See [Workspace Class Reference](/reference/workspace/workspace-class) for details.

## Safety

Workspaces include safety controls to prevent accidental damage and require approval for sensitive operations.

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  sandbox: new LocalSandbox({ workingDirectory: './workspace' }),
  safety: {
    readOnly: false,
    requireReadBeforeWrite: true,
    requireSandboxApproval: 'all',
    requireFilesystemApproval: 'none',
  },
});
```

### Options

| Option | Default | Description |
|--------|---------|-------------|
| `readOnly` | `false` | Block all write operations |
| `requireReadBeforeWrite` | `true` | Require reading files before writing |
| `requireSandboxApproval` | `'all'` | Approval for sandbox ops: `'all'`, `'commands'`, or `'none'` |
| `requireFilesystemApproval` | `'none'` | Approval for filesystem ops: `'all'`, `'write'`, or `'none'` |

### Read-before-write

When enabled (default), agents must read a file before writing to it. This prevents overwriting files the agent hasn't seen. The workspace tracks:

- **New files** - Can be written without reading (they don't exist yet)
- **Existing files** - Must be read first
- **Externally modified files** - If a file changed since the agent read it, the write fails

### Sandbox approval

Controls when sandbox operations require user approval:

| Value | `execute_code` | `execute_command` | `install_package` |
|-------|---------------|-------------------|-------------------|
| `'none'` | No approval | No approval | No approval |
| `'commands'` | No approval | Requires approval | Requires approval |
| `'all'` | Requires approval | Requires approval | Requires approval |

### Filesystem approval

Controls when filesystem operations require user approval:

| Value | Read ops | Write ops |
|-------|----------|-----------|
| `'none'` | No approval | No approval |
| `'write'` | No approval | Requires approval |
| `'all'` | Requires approval | Requires approval |

## Search

Enable search to let agents find content in workspace files. See [Search and Indexing](/docs/workspace/search) for details.

```typescript
const workspace = new Workspace({
  filesystem: new LocalFilesystem({ basePath: './workspace' }),
  bm25: true,
  autoIndexPaths: ['/docs'],
});
```

## Related

- [Search and Indexing](/docs/workspace/search)
- [Workspace Class Reference](/reference/workspace/workspace-class)
- [Filesystem Reference](/reference/workspace/filesystem)
- [Sandbox Reference](/reference/workspace/sandbox)
- [Agent Approval](/docs/agents/agent-approval)
