---
title: "Memory overview | Memory"
description: "Learn how Mastra's memory system works with working memory, message history, and semantic recall."
packages:
  - "@mastra/core"
  - "@mastra/libsql"
  - "@mastra/memory"
---

# Memory

Memory helps your agent remember user messages, agent replies, and tool results across interactions.

It serves two purposes. First, it lets you display relevant past messages in the UI. Second, it gives the agent the context it needs to stay consistent, maintain conversation flow, and produce better answers over time.

Mastra supports three complementary memory types:

- [**Message history**](/docs/memory/message-history) keeps recent messages from the current conversation so they can be rendered in the UI and used to maintain short-term continuity within the exchange.
- [**Working memory**](/docs/memory/working-memory) stores persistent, structured user data such as names, preferences, and goals.
- [**Semantic recall**](/docs/memory/semantic-recall) retrieves relevant messages from older conversations based on semantic meaning rather than exact keywords, mirroring how humans recall information by association.

You can enable any combination of these memory types. Before each request, Mastra assembles the selected memories into the model's context window. 

If the combined memory exceeds the model's context limit, [memory processors](/docs/memory/memory-processors) can filter, trim, or prioritize content so the most relevant information is preserved.

## Getting started

Install `@mastra/memory` and a storage adapter for your [database](/docs/memory/storage#supported-providers) of choice:

```bash npm2yarn
npm install @mastra/memory@latest @mastra/libsql@latest
```

Add the `storage` adapter to your `Mastra` instance:

```typescript title="src/mastra/index.ts"
import { Mastra } from "@mastra/core";
import { LibSQLStore } from "@mastra/libsql";

export const mastra = new Mastra({
  storage: new LibSQLStore({
    id: 'mastra-storage',
    url: ":memory:",
  }),
});
```

Give your agent `Memory`:

```typescript title="src/mastra/agents/your-agent.ts"
import { Memory } from "@mastra/memory";
import { Agent } from "@mastra/core/agent";

export const agent = new Agent({
  id: "agent",
  memory: new Memory({
    options: {
      lastMessages: 20, // Defaults to 10 if omitted.
    },
  }),
});
```
When you send a message, it gets stored in the database. On subsequent requests, the model sees up to the 20 most recent messages (controlled by `lastMessages` above), giving it better context for the conversation.

This example configures basic [message history](/docs/memory/message-history). You can also enable [working memory](/docs/memory/working-memory) and [semantic recall](/docs/memory/semantic-recall).

## Storage

Before enabling memory, you must first configure a storage adapter. Mastra supports most databases including PostgreSQL, MongoDB, libSQL, and [more](/docs/memory/storage#supported-providers).

Storage can be configured at the [instance level](/docs/memory/storage#instance-level-storage) (shared across all agents) or at the [agent level](/docs/memory/storage#agent-level-storage) (dedicated per agent).

For semantic recall, you can use a separate vector database like Pinecone alongside your primary storage.

See the [Storage](/docs/memory/storage) documentation for configuration options, supported providers, and examples.

## Debugging memory

When [tracing](/docs/observability/tracing/overview) is enabled, you can inspect exactly which messages the agent uses for context in each request. The trace output shows all memory included in the agent's context window - both recent message history and messages recalled via semantic recall.

![](https://mastra.ai/_next/image?url=%2Ftracingafter.png&w=1920&q=75)

This visibility helps you understand why an agent made specific decisions and verify that memory retrieval is working as expected.

## Next Steps

- Learn more about [Storage](/docs/memory/storage) providers and configuration options
- Add [Message History](/docs/memory/message-history), [Working Memory](/docs/memory/working-memory), or [Semantic Recall](/docs/memory/semantic-recall)
- Visit [Memory configuration reference](/reference/memory/memory-class) for all available options
