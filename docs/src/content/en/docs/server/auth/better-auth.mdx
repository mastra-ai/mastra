---
title: MastraAuthBetterAuth Class
description: Authenticate your Mastra server using Better Auth (self-hosted, open-source auth).
packages:
  - "@mastra/auth-better-auth"
sidebar_label: Better Auth
---

The `MastraAuthBetterAuth` class provides authentication for Mastra using Better Auth. It verifies incoming requests using your Better Auth instance and integrates with the Mastra server via the `server.auth` option.

## Prerequisites

This example uses Better Auth. Make sure your Better Auth instance is configured and your environment variables are set.

```env title=".env"
# Required by Better Auth
BETTER_AUTH_SECRET=...   # at least 32 chars
BETTER_AUTH_URL=http://localhost:3000

# Example DB URL used by the snippet below (adjust for your setup)
DATABASE_URL=postgres://...
```

> Better Auth recommends setting `baseURL` explicitly (or via `BETTER_AUTH_URL`) for security and stability.

If you haven't mounted Better Auth's handler yet (so your app can sign users in / create sessions), follow Better Auth's installation guide to mount the `/api/auth/*` route (or your configured base path).

## Installation

Install the Mastra provider package and Better Auth:

```bash
npm install @mastra/auth-better-auth better-auth
```

## Usage example

```ts
import { betterAuth } from "better-auth";
import { MastraAuthBetterAuth } from "@mastra/auth-better-auth";
import { Mastra } from "@mastra/core";

// 1) Create your Better Auth instance
const auth = betterAuth({
  database: {
    provider: "postgresql",
    url: process.env.DATABASE_URL!,
  },
  emailAndPassword: {
    enabled: true,
  },
});

// 2) Create the Mastra auth provider
const mastraAuth = new MastraAuthBetterAuth({
  auth,
});

// 3) Use with Mastra
const mastra = new Mastra({
  server: {
    auth: mastraAuth,
  },
});
```

## Configuration options

| Option          | Type | Required | Description |
| --------------- | ---- | -------- | ----------- |
| `auth` | `Auth` | Yes | Your Better Auth instance created via `betterAuth({ ... })` |
| `name` | `string` | No | Custom provider name (default: `"better-auth"`) |
| `authorizeUser` | `(user, request) => Promise<boolean>` | No | Custom authorization logic |
| `public` | `string[]` | No | Public routes that don't require authentication |
| `protected` | `string[]` | No | Protected routes that require authentication |

## Custom authorization

```ts
const mastraAuth = new MastraAuthBetterAuth({
  auth,
  async authorizeUser(user) {
    // Example: only allow verified emails
    return user?.user?.emailVerified === true;
  },
});
```

## Route configuration

```ts
const mastraAuth = new MastraAuthBetterAuth({
  auth,
  public: ["/health", "/api/status"],
  protected: ["/api/*", "/admin/*"],
});
```

## Client-side setup

When auth is enabled, requests to Mastra's built-in routes require authentication. In practice, that means your client needs to send whatever credential your Better Auth setup uses for authenticated requests.

If you're using `MastraClient`, configure it to send an `Authorization: Bearer <token>` header (how you obtain the token depends on your Better Auth setup):

```ts
import { MastraClient } from "@mastra/client-js";

export const mastraClient = new MastraClient({
  baseUrl: "http://localhost:4111",
  headers: {
    Authorization: `Bearer ${accessToken}`,
  },
});
```

## Troubleshooting

* **401/403 on every request**: confirm your Better Auth handler is mounted and your app can create a valid session/token.
* **Base URL issues**: set `baseURL` in `betterAuth({ ... })` or set `BETTER_AUTH_URL`.
* **DB connection errors**: verify `DATABASE_URL` and database provider configuration.

## Further reading

* Better Auth docs (installation + options)
* Mastra Auth Overview
