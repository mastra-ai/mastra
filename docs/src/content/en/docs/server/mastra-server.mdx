---
title: "Server Configuration | Server"
description: "Configure the Mastra server with custom settings for port, timeout, CORS, and more."
packages:
  - "@mastra/core"
---

# Server Configuration

When deploying your Mastra application to production, it runs as an HTTP server that exposes your agents, workflows, and other functionality as API endpoints. This page covers how to configure and customize the server for a production environment.

:::info

This page covers the [`server`](/reference/v1/configuration#server-options) configuration options passed to the `Mastra` constructor. For running Mastra with your own HTTP server (Hono, Express, etc.), visit [Server Adapters](/docs/v1/server/server-adapters).

:::

## Server architecture

Mastra uses [Hono](https://hono.dev) as its underlying HTTP server framework. When you build a Mastra application using `mastra build`, it generates a Hono-based HTTP server in the `.mastra` directory.

The server provides:

- API endpoints for all registered agents
- API endpoints for all registered workflows
- Custom API route support
- Custom middleware support
- Configuration of timeout
- Configuration of port
- Configuration of body limit

Visit the [Middleware](/docs/v1/server/middleware) and [Custom API Routes](/docs/v1/server/custom-api-routes) docs for details on adding additional server behaviour.

## Server configuration

You can configure various aspects of the Mastra server by passing a [`server`](/reference/v1/configuration#server-options) object to the `Mastra` constructor in your `src/mastra/index.ts` file. For example, by changing the default port and host:

```typescript title="src/mastra/index.ts"
import { Mastra } from "@mastra/core";

export const mastra = new Mastra({
  server: {
    port: 3000, // Defaults to 4111
    host: "0.0.0.0", // Defaults to 'localhost'
  },
});
```

:::info

Visit the [Configuration Reference](/reference/v1/configuration#server-options) for a full list of available server options.

:::

## TypeScript configuration

Mastra requires `module` and `moduleResolution` values that support modern Node.js versions. Older settings like `CommonJS` or `node` are incompatible with Mastraâ€™s packages and will cause resolution errors.

```json {4-5} title="tsconfig.json"
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ES2022",
    "moduleResolution": "bundler",
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "strict": true,
    "skipLibCheck": true,
    "noEmit": true,
    "outDir": "dist"
  },
  "include": ["src/**/*"]
}
```

:::info

This TypeScript configuration is optimized for Mastra projects, using modern module resolution and strict type checking.

:::

## Stream data redaction

When streaming agent responses, the HTTP streaming layer redacts system prompts, tool definitions, API keys, and similar data from each chunk before sending it to clients. This is enabled by default.

If you're using server adapters directly, you can configure redaction behavior. See [Stream data redaction](/docs/v1/server/server-adapters#stream-data-redaction) in the Server Adapters docs.
