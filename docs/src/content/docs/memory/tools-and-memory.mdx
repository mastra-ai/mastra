# Tools and Memory Interaction

Mastra tools can directly interact with the memory system by accessing the `threadId` and `resourceId` associated with the current agent call. This enables tools to perform context-aware actions based on the ongoing conversation.

## Accessing Thread and Resource IDs in Tools

When creating custom tools for your agents, you can directly access the `threadId` and `resourceId` associated with the current agent call within the tool's `execute` function. This allows tools to interact with the memory system or perform context-aware actions.

```typescript
import { createTool } from "@mastra/core/tools";
import { z } from "zod";
import { Memory } from "@mastra/memory"; // Assuming memory instance is accessible

const memory = new Memory(); // Example memory instance

const myTool = createTool({
  id: "ThreadInfoTool",
  inputSchema: z.object({
    fetchMessages: z.boolean().optional(),
  }),
  description: "A tool that demonstrates accessing thread and resource IDs",
  execute: async ({ threadId, resourceId, context }) => {
    // threadId and resourceId are directly available here
    console.log(
      `Executing tool for resource ${resourceId} in thread ${threadId}`,
    );

    if (!context.fetchMessages) {
      return { threadId, resourceId, status: "IDs accessed" };
    }

    // Example: Use IDs to query memory within the tool
    const recentMessages = await memory.query({
      threadId,
      selectBy: { last: 5 },
    });

    return {
      threadId,
      resourceId,
      messageCount: recentMessages.messages.length,
      status: "Messages retrieved",
    };
  },
});

// Add this tool to your agent's configuration
const agentWithTool = new Agent({
  // ... other config
  memory: memory,
  tools: {
    threadInfo: myTool,
  },
});
```

This capability enables tools to:

- Query the memory for context relevant to the current conversation.
- Store tool results or state associated with a specific thread.
- Perform actions specific to the user (`resourceId`).

## Filtering Tool Calls from Memory

Sometimes, you might want to prevent tool calls or their results from being included in the memory context sent back to the LLM. This can save tokens and keep the context focused. You can use the `ToolCallFilter` memory processor for this.

See the [Memory Processors reference](/docs/reference/memory/memory-processors.mdx#toolcallfilter) for details on how to configure this filter.