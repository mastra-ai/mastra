---
title: "CLI | v1 迁移指南"
description: "了解在升级到 v1 时如何迁移 CLI 的更改。"
---

# CLI

CLI 已简化，移除了部署命令、配置标志和启动文件。添加了新的迁移命令以帮助进行数据库模式升级。

## 新增

### `mastra migrate` 命令

新的 `mastra migrate` 命令帮助在升级 Mastra 版本时运行数据库迁移。这对于从可能存在不兼容性的旧版本升级特别有用。

```bash
npx mastra migrate
```

该命令打包您的项目，连接到配置的存储，并运行任何必要的迁移。目前支持迁移可能导致唯一约束创建失败的重复跨度条目。

有关何时需要此迁移的详细信息，请参阅[存储迁移指南](/cn/guides/migrations/upgrade-to-v1/storage#重复跨度迁移)。

## 移除

### `mastra deploy` 命令

`mastra deploy` 命令已从 CLI 中移除。此更改通过删除特定供应商的部署逻辑简化了 CLI。

要迁移，请选择您喜欢的[部署平台](/docs/cn/docs/deployment/overview)。

### 从 `mastra build` 中移除 `--env` 标志

`--env` 标志已从 `mastra build` 命令中移除。此更改简化了构建命令。

要迁移，请使用 `mastra start --env <env>` 以自定义环境启动构建输出。

```diff
- mastra build --env production
+ mastra build
+ mastra start --env production
```

### 从 `mastra dev` 中移除 `--port` 标志

`--port` 标志已从 `mastra dev` 命令中移除。端口配置现在通过 Mastra 实例配置处理。此更改集中了端口配置。

要迁移，请在 Mastra 实例上使用 `server.port` 而不是 CLI 标志。

```ts
const mastra = new Mastra({
  server: {
    port: 3001,
  },
});
```

### 从 CLI 中移除遥测选项

遥测选项已从 CLI 命令中移除，包括 `--no-telemetry` / `-nt` 标志。遥测配置已从 CLI 中移除。此更改反映了遥测功能移至可观测性包。

要迁移，请从 CLI 命令中移除遥测标志。使用 `@mastra/observability` 获取跟踪功能。
