---
title: "React + Vite | æ¡†æ¶"
description: "å°† Mastra ä¸ React å’Œ Vite é›†æˆçš„åˆ†æ­¥æŒ‡å—"
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# åœ¨æ‚¨çš„ React + Vite é¡¹ç›®ä¸­é›†æˆ Mastra

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ Mastra æ„å»ºä¸€ä¸ªå·¥å…·è°ƒç”¨å‹ AI ä»£ç†ï¼Œç„¶åé€šè¿‡ä» Mastra çš„ç‹¬ç«‹æœåŠ¡å™¨è°ƒç”¨ä»£ç†å°†å…¶è¿æ¥åˆ° Reactã€‚

æ‚¨å°†ä½¿ç”¨ [AI SDK UI](https://ai-sdk.dev/docs/cn/docs/ai-sdk-ui/overview) å’Œ [AI Elements](https://ai-sdk.dev/elements) åˆ›å»ºä¸€ä¸ªç¾è§‚ã€äº¤äº’å¼çš„èŠå¤©ä½“éªŒã€‚

## å‰ç½®æ¡ä»¶

- æ‚¨éœ€è¦ä¸€ä¸ªæ”¯æŒçš„[æ¨¡å‹æä¾›å•†](/models)çš„ API keyã€‚å¦‚æœæ‚¨æ²¡æœ‰åå¥½ï¼Œè¯·ä½¿ç”¨ [OpenAI](/models/providers/openai)ã€‚
- å®‰è£… Node.js `v22.13.0` æˆ–æ›´é«˜ç‰ˆæœ¬

## åˆ›å»ºæ–°çš„ React + Vite åº”ç”¨ç¨‹åºï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨å·²ç»æœ‰ä¸€ä¸ªä½¿ç”¨ Tailwind çš„ React + Vite åº”ç”¨ç¨‹åºï¼Œè¯·è·³åˆ°ä¸‹ä¸€æ­¥ã€‚

### é¡¹ç›®è„šæ‰‹æ¶

è¿è¡Œä»¥ä¸‹å‘½ä»¤[åˆ›å»ºæ–°çš„ React + Vite åº”ç”¨ç¨‹åº](https://vite.dev/guide/#scaffolding-your-first-vite-project)ï¼š

```bash npm2yarn
npm create vite@latest mastra-react -- --template react-ts
```

è¿™ä¼šåˆ›å»ºä¸€ä¸ªåä¸º `mastra-react` çš„é¡¹ç›®ï¼Œä½†æ‚¨å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºä»»ä½•æ‚¨æƒ³è¦çš„åç§°ã€‚

å¯¼èˆªåˆ°æ‚¨çš„é¡¹ç›®ç›®å½•ï¼š

```bash
cd mastra-react
```

### Tailwind

æ¥ä¸‹æ¥ï¼Œå®‰è£… Tailwindï¼š

```bash npm2yarn
npm install tailwindcss @tailwindcss/vite
```

é…ç½® Vite æ’ä»¶ï¼š

```typescript title="vite.config.ts" {3-4,7-12}
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from "path"
import tailwindcss from '@tailwindcss/vite'

export default defineConfig({
  plugins: [react(), tailwindcss()],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
})
```

å°† `src/index.css` ä¸­çš„æ‰€æœ‰å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š

```css title="src/index.css"
@import "tailwindcss";
```

å°†è¿™äº› `compilerOptions` æ·»åŠ åˆ° `tsconfig.json`ï¼š

```ts title="tsconfig.json"
{
  // ...
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

ç¼–è¾‘ `tsconfig.app.json` ä»¥è§£æè·¯å¾„ï¼š

```ts title="tsconfig.app.json"
{
  "compilerOptions": {
    // ...
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
    // ...
  }
}
```

## åˆå§‹åŒ– Mastra

è¿è¡Œ [`mastra init`](/reference/cli/mastra#mastra-init)ã€‚å½“æç¤ºæ—¶ï¼Œé€‰æ‹©ä¸€ä¸ªæä¾›å•†ï¼ˆä¾‹å¦‚ OpenAIï¼‰å¹¶è¾“å…¥æ‚¨çš„ keyï¼š

```bash npm2yarn
npx mastra@latest init
```

è¿™ä¼šåˆ›å»ºä¸€ä¸ª `src/mastra` æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç¤ºä¾‹å¤©æ°”ä»£ç†ä»¥åŠä»¥ä¸‹æ–‡ä»¶ï¼š

- `index.ts` - Mastra é…ç½®ï¼ŒåŒ…æ‹¬å†…å­˜
- `tools/weather-tool.ts` - ç”¨äºè·å–ç»™å®šä½ç½®å¤©æ°”çš„å·¥å…·
- `agents/weather-agent.ts` - ä¸€ä¸ªå¸¦æœ‰ä½¿ç”¨å·¥å…·æç¤ºè¯çš„å¤©æ°”ä»£ç†

åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œæ‚¨å°†ä»èŠå¤© UI ä¸­è°ƒç”¨ `weather-agent.ts`ã€‚

## å®‰è£… AI SDK UI å’Œ AI Elements

å®‰è£… AI SDK UI ä»¥åŠ Mastra é€‚é…å™¨ï¼š

```bash npm2yarn
npm install @mastra/ai-sdk@latest @ai-sdk/react ai
```

æ¥ä¸‹æ¥ï¼Œåˆå§‹åŒ– AI Elementsã€‚å½“æç¤ºæ—¶ï¼Œé€‰æ‹©é»˜è®¤é€‰é¡¹ï¼š

```bash npm2yarn
npx ai-elements@latest
```

è¿™ä¼šå°†æ•´ä¸ª AI Elements UI ç»„ä»¶åº“ä¸‹è½½åˆ° `@/components/ai-elements` æ–‡ä»¶å¤¹ä¸­ã€‚

## åˆ›å»ºèŠå¤©è·¯ç”±

æ‰“å¼€ `src/mastra/index.ts` å¹¶å°† [chatRoute()](/reference/ai-sdk/chat-route) æ·»åŠ åˆ°æ‚¨çš„é…ç½®ã€‚è¿™ä¼šåˆ›å»ºä¸€ä¸ª API è·¯ç”±ï¼Œæ‚¨çš„ React å‰ç«¯å¯ä»¥è°ƒç”¨è¯¥è·¯ç”±è·å– AI SDK å…¼å®¹çš„èŠå¤©å“åº”ï¼Œæ‚¨å°†åœ¨ä¸‹ä¸€æ­¥ä¸­ä¸ `useChat()` ä¸€èµ·ä½¿ç”¨ã€‚

```ts title="src/mastra/index.ts"
import { Mastra } from '@mastra/core/mastra';
// ç°æœ‰çš„å¯¼å…¥...
import { chatRoute } from "@mastra/ai-sdk"

export const mastra = new Mastra({
  // ç°æœ‰çš„é…ç½®...
  server: {
    apiRoutes: [
      chatRoute({
        path: '/chat/:agentId'
      })
    ]
  }
});
```

## æ·»åŠ èŠå¤© UI

æ›¿æ¢ `src/App.tsx` æ–‡ä»¶ä»¥åˆ›å»ºèŠå¤©ç•Œé¢ï¼š

```tsx title="src/App.tsx"
import * as React from 'react';
import { DefaultChatTransport, type ToolUIPart } from 'ai';
import { useChat } from '@ai-sdk/react';

import {
  PromptInput,
  PromptInputBody,
  PromptInputTextarea,
} from '@/components/ai-elements/prompt-input';

import {
  Conversation,
  ConversationContent,
  ConversationScrollButton,
} from '@/components/ai-elements/conversation';

import {
  Message,
  MessageContent,
  MessageResponse
} from '@/components/ai-elements/message';

import {
  Tool,
  ToolHeader,
  ToolContent,
  ToolInput,
  ToolOutput,
} from '@/components/ai-elements/tool';

export default function App() {
  const [input, setInput] = React.useState<string>('');

  const { messages, sendMessage, status } = useChat({
    transport: new DefaultChatTransport({
      api: 'http://localhost:4111/chat/weather-agent',
    }),
  });

  const handleSubmit = async () => {
    if (!input.trim()) return;

    sendMessage({ text: input });
    setInput('');
  };

  return (
    <div className="max-w-4xl mx-auto p-6 relative size-full h-screen">
      <div className="flex flex-col h-full">
        <Conversation className="h-full">
          <ConversationContent>
            {messages.map((message) => (
              <div key={message.id}>
                {message.parts?.map((part, i) => {
                  if (part.type === 'text') {
                    return (
                      <Message
                        key={`${message.id}-${i}`}
                        from={message.role}>
                          <MessageContent>
                            <MessageResponse>{part.text}</MessageResponse>
                          </MessageContent>
                      </Message>
                    );
                  }

                  if (part.type?.startsWith('tool-')) {
                    return (
                      <Tool key={`${message.id}-${i}`}>
                        <ToolHeader
                          type={(part as ToolUIPart).type}
                          state={(part as ToolUIPart).state || 'output-available'}
                          className="cursor-pointer"
                        />
                        <ToolContent>
                          <ToolInput input={(part as ToolUIPart).input || {}} />
                          <ToolOutput
                            output={(part as ToolUIPart).output}
                            errorText={(part as ToolUIPart).errorText}
                          />
                        </ToolContent>
                      </Tool>
                    );
                  }

                  return null;
                })}
              </div>
            ))}
            <ConversationScrollButton />
          </ConversationContent>
        </Conversation>
        <PromptInput onSubmit={handleSubmit} className="mt-20">
          <PromptInputBody>
            <PromptInputTextarea
              onChange={(e) => setInput(e.target.value)}
              className="md:leading-10"
              value={input}
              placeholder="Ask about the weather..."
              disabled={status !== 'ready'}
            />
          </PromptInputBody>
        </PromptInput>
      </div>
    </div>
  );
}
```

æ­¤ç»„ä»¶å°† [`useChat()`](https://ai-sdk.dev/docs/cn/docs/reference/ai-sdk-ui/use-chat) è¿æ¥åˆ° `chat/weather-agent` ç«¯ç‚¹ï¼Œå°†æç¤ºè¯å‘é€è‡³æ­¤å¹¶å°†å“åº”åˆ†å—æµå¼ä¼ è¾“å›æ¥ã€‚

å®ƒä½¿ç”¨ [`<MessageResponse>`](https://ai-sdk.dev/elements/components/message#messageresponse-) ç»„ä»¶æ¸²æŸ“å“åº”æ–‡æœ¬ï¼Œå¹¶ä½¿ç”¨ [`<Tool>`](https://ai-sdk.dev/elements/components/tool) ç»„ä»¶æ˜¾ç¤ºä»»ä½•å·¥å…·è°ƒç”¨ã€‚

## æµ‹è¯•æ‚¨çš„ä»£ç†

ä¸ºäº†ä½¿ç”¨èŠå¤©ç•Œé¢æµ‹è¯•æ‚¨çš„ä»£ç†ï¼Œæ‚¨éœ€è¦åŒæ—¶è¿è¡Œ Mastra æœåŠ¡å™¨å’Œ Vite å¼€å‘æœåŠ¡å™¨ã€‚

1. å¯åŠ¨ Mastra å¼€å‘æœåŠ¡å™¨ï¼š

    ```bash
    npx mastra dev
    ```
2. åœ¨å•ç‹¬çš„ç»ˆç«¯çª—å£ä¸­ï¼Œå¯åŠ¨ Vite å¼€å‘æœåŠ¡å™¨ï¼š

    ```bash
    npm run dev
    ```
3. åœ¨ http://localhost:5173 æ‰“å¼€æ‚¨çš„åº”ç”¨ç¨‹åº
4. å°è¯•è¯¢é—®å¤©æ°”ã€‚å¦‚æœæ‚¨çš„ API key è®¾ç½®æ­£ç¡®ï¼Œæ‚¨ä¼šå¾—åˆ°å“åº”

## åç»­æ­¥éª¤

æ­å–œæ‚¨ä½¿ç”¨ React æ„å»ºäº† Mastra ä»£ç†ï¼ğŸ‰

ä»è¿™é‡Œå¼€å§‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è‡ªå·±çš„å·¥å…·å’Œé€»è¾‘æ‰©å±•é¡¹ç›®ï¼š

- äº†è§£æ›´å¤šå…³äº[ä»£ç†](/docs/cn/docs/agents/overview)
- ä¸ºæ‚¨çš„ä»£ç†æä¾›è‡ªå·±çš„[å·¥å…·](/docs/cn/docs/agents/using-tools)
- ä¸ºæ‚¨çš„ä»£ç†æ·»åŠ ç±»ä¼¼äººç±»çš„[å†…å­˜](/docs/cn/docs/agents/agent-memory)

å‡†å¤‡å°±ç»ªåï¼Œé˜…è¯»æ›´å¤šå…³äº Mastra å¦‚ä½•ä¸ AI SDK UI å’Œ React é›†æˆçš„ä¿¡æ¯ï¼Œä»¥åŠå¦‚ä½•å°†æ‚¨çš„ä»£ç†éƒ¨ç½²åˆ°ä»»ä½•åœ°æ–¹ï¼š

- å°† Mastra ä¸ [AI SDK UI](/guides/build-your-ui/ai-sdk-ui) é›†æˆ
- å°†æ‚¨çš„ä»£ç†éƒ¨ç½²åˆ°[ä»»ä½•åœ°æ–¹](/docs/cn/docs/deployment/overview)
