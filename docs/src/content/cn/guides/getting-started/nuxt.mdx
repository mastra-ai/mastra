---
title: "Nuxt | æ¡†æ¶"
description: "å¼€å§‹ä½¿ç”¨ Mastra å’Œ Nuxt"
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# åœ¨æ‚¨çš„ Nuxt é¡¹ç›®ä¸­é›†æˆ Mastra

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ Mastra æ„å»ºä¸€ä¸ªå·¥å…·è°ƒç”¨å‹ AI ä»£ç†ï¼Œç„¶åé€šè¿‡ä»æœåŠ¡å™¨è·¯ç”±ä¸­ç›´æ¥å¯¼å…¥å’Œè°ƒç”¨ä»£ç†å°†å…¶è¿æ¥åˆ° Nuxtã€‚

æ‚¨å°†ä½¿ç”¨ [AI SDK UI](https://ai-sdk.dev/docs/cn/docs/ai-sdk-ui/overview) åˆ›å»ºä¸€ä¸ªç¾è§‚ã€äº¤äº’å¼çš„ Vue èŠå¤©ä½“éªŒã€‚

## å‰ç½®æ¡ä»¶

- æ‚¨éœ€è¦ä¸€ä¸ªæ”¯æŒçš„[æ¨¡å‹æä¾›å•†](/models/)çš„ API keyã€‚å¦‚æœæ‚¨æ²¡æœ‰åå¥½ï¼Œè¯·ä½¿ç”¨ [OpenAI](/models/providers/openai)ã€‚
- å®‰è£… Node.js `v22.13.0` æˆ–æ›´é«˜ç‰ˆæœ¬

## åˆ›å»ºæ–°çš„ Nuxt åº”ç”¨ç¨‹åºï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨å·²ç»æœ‰ä¸€ä¸ª Nuxt åº”ç”¨ç¨‹åºï¼Œè¯·è·³åˆ°ä¸‹ä¸€æ­¥ã€‚

è¿è¡Œä»¥ä¸‹å‘½ä»¤[åˆ›å»ºæ–°çš„ Nuxt åº”ç”¨ç¨‹åº](https://nuxt.com/docs/cn/docs/getting-started/installation)ï¼š

```bash npm2yarn
npm create nuxt@latest mastra-nuxt -- --template minimal --packageManager npm --gitInit --modules
```

è¿™ä¼šåˆ›å»ºä¸€ä¸ªåä¸º `mastra-nuxt` çš„é¡¹ç›®ï¼Œä½†æ‚¨å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºä»»ä½•æ‚¨æƒ³è¦çš„åç§°ã€‚

## åˆå§‹åŒ– Mastra

å¯¼èˆªåˆ°æ‚¨çš„ Nuxt é¡¹ç›®ï¼š

```bash
cd mastra-nuxt
```

è¿è¡Œ [`mastra init`](/reference/cli/mastra#mastra-init)ã€‚å½“æç¤ºæ—¶ï¼Œé€‰æ‹©ä¸€ä¸ªæä¾›å•†ï¼ˆä¾‹å¦‚ OpenAIï¼‰å¹¶è¾“å…¥æ‚¨çš„ keyï¼š

```bash npm2yarn
npx mastra@latest init
```

è¿™ä¼šåˆ›å»ºä¸€ä¸ª `mastra` æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç¤ºä¾‹å¤©æ°”ä»£ç†ä»¥åŠä»¥ä¸‹æ–‡ä»¶ï¼š

- `index.ts` - Mastra é…ç½®ï¼ŒåŒ…æ‹¬å†…å­˜
- `tools/weather-tool.ts` - ç”¨äºè·å–ç»™å®šä½ç½®å¤©æ°”çš„å·¥å…·
- `agents/weather-agent.ts` - ä¸€ä¸ªå¸¦æœ‰ä½¿ç”¨å·¥å…·æç¤ºè¯çš„å¤©æ°”ä»£ç†

åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œæ‚¨å°†ä» Nuxt æœåŠ¡å™¨è·¯ç”±ä¸­è°ƒç”¨ `weather-agent.ts`ã€‚

## å®‰è£… AI SDK UI

å®‰è£… AI SDK UI ä»¥åŠ Mastra é€‚é…å™¨ï¼š

```bash npm2yarn
npm install @mastra/ai-sdk@latest @ai-sdk/vue ai
```

## åˆ›å»ºèŠå¤©è·¯ç”±

åˆ›å»º `server/api/chat.ts`ï¼š

```ts title="server/api/chat.ts"
import { handleChatStream } from '@mastra/ai-sdk';
import { toAISdkV5Messages } from '@mastra/ai-sdk/ui';
import { createUIMessageStreamResponse } from 'ai';
import { mastra } from '../../src/mastra';

const THREAD_ID = 'example-user-id';
const RESOURCE_ID = 'weather-chat';

export default defineEventHandler(async (event) => {
  const method = event.method;

  if (method === 'POST') {
    const params = await readBody(event);
    const stream = await handleChatStream({
      mastra,
      agentId: 'weather-agent',
      params: {
        ...params,
        memory: {
          ...params.memory,
          thread: THREAD_ID,
          resource: RESOURCE_ID,
        }
      }
    });

    return createUIMessageStreamResponse({ stream });
  }

  if (method === 'GET') {
    const memory = await mastra.getAgentById('weather-agent').getMemory();
    let response = null;

    try {
      response = await memory?.recall({
        threadId: THREAD_ID,
        resourceId: RESOURCE_ID,
      });
    } catch {
      console.log('No previous messages found.');
    }

    const uiMessages = toAISdkV5Messages(response?.messages || []);

    return uiMessages;
  }
});
```

`POST` å¤„ç†ç¨‹åºæ¥å—æç¤ºè¯å¹¶å°†ä»£ç†çš„å“åº”ä»¥ AI SDK æ ¼å¼æµå¼ä¼ è¾“å›æ¥ï¼Œè€Œ `GET` å¤„ç†ç¨‹åºä»å†…å­˜ä¸­è·å–æ¶ˆæ¯å†å²è®°å½•ï¼Œä»¥ä¾¿åœ¨å®¢æˆ·ç«¯é‡æ–°åŠ è½½æ—¶å¡«å…… UIã€‚

## æ·»åŠ èŠå¤© UI

å°† `app/app.vue` çš„å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š

```html title="app/app.vue"
<script setup lang="ts">
import { ref, onMounted } from 'vue';
import { Chat } from "@ai-sdk/vue";
import { DefaultChatTransport, type ToolUIPart } from 'ai';

const chat = new Chat({
  transport: new DefaultChatTransport({
    api: '/api/chat',
  }),
})

const STATE_TO_LABEL_MAP: Record<string, string> = {
  'input-streaming': 'Pending',
  'input-available': 'Running',
  'output-available': 'Completed',
  'output-error': 'Error',
  'output-denied': 'Denied',
};

const input = ref('');

onMounted(async () => {
  const res = await fetch('/api/chat');
  const data = await res.json();
  chat.messages = [...data];
});

function handleSubmit() {
  if (!input.value.trim()) return;

  chat.sendMessage({ text: input.value });
  input.value = '';
}
</script>

<template>
  <div class="chat-container">
    <div class="messages">
      <div v-for="message in chat.messages" :key="message.id" class="message-wrapper">
        <div
          v-for="(part, i) in message.parts"
          :key="`${message.id}-${i}`"
        >
          <div
            v-if="part.type === 'text'"
            :class="['message', message.role]"
          >
            <div class="message-content">
              {{ part.text }}
            </div>
          </div>

          <details
            v-else-if="part.type?.startsWith('tool-')"
            class="tool"
          >
            <summary class="tool-header">
              {{ (part as ToolUIPart).type?.split('-').slice(1).join('-') }} -
              {{ STATE_TO_LABEL_MAP[(part as ToolUIPart).state ?? 'output-available'] }}
            </summary>
            <div class="tool-content">
              <div class="tool-section">
                <div class="tool-label">Parameters</div>
                <pre><code>{{ JSON.stringify((part as ToolUIPart).input, null, 2) }}</code></pre>
              </div>
              <div class="tool-section">
                <div class="tool-label">
                  {{ (part as ToolUIPart).errorText ? 'Error' : 'Result' }}
                </div>
                <pre><code>{{ JSON.stringify((part as ToolUIPart).output, null, 2) }}</code></pre>
                <div v-if="(part as ToolUIPart).errorText" class="tool-error">
                  {{ (part as ToolUIPart).errorText }}
                </div>
              </div>
            </div>
          </details>
        </div>
      </div>
    </div>

    <form class="input-form" @submit.prevent="handleSubmit">
      <input
        v-model="input"
        type="text"
        placeholder="Ask about the weather..."
        :disabled="chat.status !== 'ready'"
        class="chat-input"
      />
      <button type="submit" class="submit-button" :disabled="chat.status !== 'ready'">
        Send
      </button>
    </form>
  </div>
</template>

<style>
*, *::before, *::after {
  box-sizing: border-box;
}

*:not(dialog) {
  margin: 0;
}

@media (prefers-reduced-motion: no-preference) {
  html {
    interpolate-size: allow-keywords;
  }
}

html {
  font-family: -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, Adwaita Sans, Cantarell, Ubuntu, roboto, noto, helvetica, arial, sans-serif;
}

body {
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}

img, picture, video, canvas, svg {
  display: block;
  max-width: 100%;
}

input, button, textarea, select {
  font: inherit;
}

p, h1, h2, h3, h4, h5, h6 {
  overflow-wrap: break-word;
}

p {
  text-wrap: pretty;
}

h1, h2, h3, h4, h5, h6 {
  text-wrap: balance;
}

.chat-container {
  max-width: 48rem;
  margin: 0 auto;
  padding: 1.5rem;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.messages {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.message-wrapper {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.message {
  padding: 0.75rem 1rem;
  border-radius: 0.5rem;
}

.message.user {
  background-color: #3b82f6;
  color: white;
  margin-left: auto;
  max-width: 60%;
}

.message.assistant {
  background-color: #f3f4f6;
  color: #1f2937;
  max-width: 80%;
}

.tool {
  border: 1px solid #d1d5db;
  border-radius: 0.5rem;
  margin: 0.5rem 0;
  overflow: hidden;
}

.tool-header {
  padding: 0.75rem 1rem;
  background-color: #f9fafb;
  cursor: pointer;
  font-weight: 500;
  font-size: 0.875rem;
}

.tool-content {
  padding: 1rem;
  border-top: 1px solid #d1d5db;
}

.tool-section {
  margin-bottom: 1rem;
}

.tool-section:last-child {
  margin-bottom: 0;
}

.tool-label {
  font-size: 0.75rem;
  font-weight: 500;
  text-transform: uppercase;
  color: #6b7280;
  margin-bottom: 0.5rem;
}

.tool pre {
  background-color: #f3f4f6;
  padding: 0.75rem;
  border-radius: 0.375rem;
  overflow-x: auto;
  font-size: 0.875rem;
}

.tool-error {
  color: #dc2626;
  margin-top: 0.5rem;
}

.input-form {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 0.75rem;
  padding-top: 1rem;
  border-top: 1px solid #e5e7eb;
  margin-top: 1rem;
}

.chat-input {
  padding: 0.75rem 1rem;
  border: 1px solid #d1d5db;
  border-radius: 0.5rem;
  font-size: 1rem;
}

.chat-input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.chat-input:disabled {
  background-color: #f3f4f6;
  cursor: not-allowed;
}

.submit-button {
  padding: 0.75rem 1.5rem;
  background-color: #3b82f6;
  color: white;
  border: none;
  border-radius: 0.5rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s;
}

.submit-button:hover:not(:disabled) {
  background-color: #2563eb;
}

.submit-button:disabled {
  background-color: #9ca3af;
  cursor: not-allowed;
}
</style>
```

æ­¤ç»„ä»¶å°† [`Chat()`](https://ai-sdk.dev/docs/cn/docs/reference/ai-sdk-ui/use-chat) è¿æ¥åˆ° `/api/chat` ç«¯ç‚¹ï¼Œå°†æç¤ºè¯å‘é€è‡³æ­¤å¹¶å°†å“åº”åˆ†å—æµå¼ä¼ è¾“å›æ¥ã€‚

å®ƒä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯æ ·å¼æ¸²æŸ“å“åº”æ–‡æœ¬ï¼Œå¹¶åœ¨å¯æŠ˜å çš„ details å…ƒç´ ä¸­æ˜¾ç¤ºä»»ä½•å·¥å…·è°ƒç”¨ã€‚

## æµ‹è¯•æ‚¨çš„ä»£ç†

1. ä½¿ç”¨ `npm run dev` è¿è¡Œæ‚¨çš„ Nuxt åº”ç”¨ç¨‹åº
2. åœ¨ http://localhost:3000 æ‰“å¼€èŠå¤©
3. å°è¯•è¯¢é—®å¤©æ°”ã€‚å¦‚æœæ‚¨çš„ API key è®¾ç½®æ­£ç¡®ï¼Œæ‚¨ä¼šå¾—åˆ°å“åº”

## åç»­æ­¥éª¤

æ­å–œæ‚¨ä½¿ç”¨ Nuxt æ„å»ºäº† Mastra ä»£ç†ï¼ğŸ‰

ä»è¿™é‡Œå¼€å§‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è‡ªå·±çš„å·¥å…·å’Œé€»è¾‘æ‰©å±•é¡¹ç›®ï¼š

- äº†è§£æ›´å¤šå…³äº[ä»£ç†](/docs/cn/docs/agents/overview)
- ä¸ºæ‚¨çš„ä»£ç†æä¾›è‡ªå·±çš„[å·¥å…·](/docs/cn/docs/agents/using-tools)
- ä¸ºæ‚¨çš„ä»£ç†æ·»åŠ ç±»ä¼¼äººç±»çš„[å†…å­˜](/docs/cn/docs/agents/agent-memory)

å‡†å¤‡å°±ç»ªåï¼Œé˜…è¯»æ›´å¤šå…³äº Mastra å¦‚ä½•ä¸ AI SDK UI å’Œ Nuxt é›†æˆçš„ä¿¡æ¯ï¼Œä»¥åŠå¦‚ä½•å°†æ‚¨çš„ä»£ç†éƒ¨ç½²åˆ°ä»»ä½•åœ°æ–¹ï¼š

- å°† Mastra ä¸ [AI SDK UI](/guides/build-your-ui/ai-sdk-ui) é›†æˆ
- å°†æ‚¨çš„ä»£ç†éƒ¨ç½²åˆ°[ä»»ä½•åœ°æ–¹](/docs/cn/docs/deployment/overview)
