---
title: "参考文档：toAISdkV5Messages() | AI SDK"
description: "toAISdkV5Messages() 的 API 参考，这是一个用于将 Mastra 消息转换为 AI SDK v5 UI 消息的函数。"
packages:
  - "@mastra/ai-sdk"
  - "@mastra/client-js"
---

import PropertiesTable from "@site/src/components/PropertiesTable";

# toAISdkV5Messages()

将各种输入格式的消息转换为 AI SDK V5（及更高版本）UI 消息格式。此函数接受多种格式的消息（字符串、AI SDK V4/V5 消息、Mastra DB 消息等）并将它们规范化为 AI SDK V5+ `UIMessage` 格式，适用于与 `useChat()` 等 AI SDK UI 组件一起使用。

## 使用示例

```typescript title="app/chat/page.tsx"
import { toAISdkV5Messages } from "@mastra/ai-sdk/ui";
import { useChat } from "ai/react";

// 从您的数据库、内存或 API 存储的消息
const storedMessages = [
  { id: "1", role: "user", content: "Hello", parts: [{ type: "text", text: "Hello" }] },
  { id: "2", role: "assistant", content: "Hi there!", parts: [{ type: "text", text: "Hi there!" }] }
];

export default function Chat() {
  const { messages } = useChat({
    initialMessages: toAISdkV5Messages(storedMessages)
  });

  return (
    <div>
      {messages.map((message) => (
        <div key={message.id}>
          {message.role}: {message.parts.map(part =>
            part.type === "text" ? part.text : null
          )}
        </div>
      ))}
    </div>
  );
}
```

## 参数

<PropertiesTable
  content={[
    {
      name: "messages",
      type: "MessageListInput",
      description: "要转换的消息。可以是字符串、字符串数组、单个消息对象或任何支持格式的消息对象数组。",
      isOptional: false,
    },
  ]}
/>

## 返回值

返回具有以下结构的 AI SDK V5+ `UIMessage` 对象数组：

<PropertiesTable
  content={[
    {
      name: "id",
      type: "string",
      description: "唯一消息标识符。",
    },
    {
      name: "role",
      type: "'user' | 'assistant' | 'system'",
      description: "消息发送者的角色。",
    },
    {
      name: "parts",
      type: "UIMessagePart[]",
      description: "UI 部分数组，包括文本、工具结果、文件、推理、来源和步骤标记。",
    },
    {
      name: "metadata",
      type: "Record<string, unknown>",
      description: "可选元数据，包括 createdAt、threadId、resourceId 和自定义字段。",
      isOptional: true,
    },
  ]}
/>

## 示例

### 转换简单的文本消息

```typescript
import { toAISdkV5Messages } from "@mastra/ai-sdk/ui";

const messages = toAISdkV5Messages(["Hello", "How can I help you today?"]);
// 返回带有用户角色的 UIMessage 对象数组
```

### 使用 Mastra 客户端加载消息

```typescript
import { MastraClient } from "@mastra/client-js";
import { toAISdkV5Messages } from "@mastra/ai-sdk/ui";

const client = new MastraClient();

const { messages } = await client.listThreadMessages("thread-id", { agentId: "myAgent" });
const uiMessages = toAISdkV5Messages(messages);
```
