---
title: "å‚è€ƒæ–‡æ¡£: MCPClient | å·¥å…·ä¸ MCP"
description: MCPClient API å‚è€ƒ - ç”¨äºç®¡ç†å¤šä¸ªæ¨¡å‹ä¸Šä¸‹æ–‡åè®®æœåŠ¡å™¨åŠå…¶å·¥å…·çš„ç±»ã€‚
packages:
  - "@mastra/core"
  - "@mastra/mcp"
---

# MCPClient

`MCPClient` ç±»æä¾›äº†ä¸€ç§åœ¨ Mastra åº”ç”¨ç¨‹åºä¸­ç®¡ç†å¤šä¸ª MCP æœåŠ¡å™¨è¿æ¥åŠå…¶å·¥å…·çš„æ–¹æ³•ã€‚å®ƒå¤„ç†è¿æ¥ç”Ÿå‘½å‘¨æœŸã€å·¥å…·å‘½åç©ºé—´ï¼Œå¹¶æä¾›å¯¹æ‰€æœ‰å·²é…ç½®æœåŠ¡å™¨çš„å·¥å…·è®¿é—®ã€‚

æ­¤ç±»å·²å¼ƒç”¨æ—§çš„ [`MastraMCPClient`](/reference/tools/client)ã€‚

## æ„é€ å‡½æ•°

åˆ›å»º MCPClient ç±»çš„æ–°å®ä¾‹ã€‚

```typescript
constructor({
  id?: string;
  servers: Record<string, MastraMCPServerDefinition>;
  timeout?: number;
}: MCPClientOptions)
```

### MCPClientOptions

<br />
<PropertiesTable
  content={[
    {
      name: "id",
      type: "string",
      isOptional: true,
      description:
        "é…ç½®å®ä¾‹çš„å¯é€‰å”¯ä¸€æ ‡è¯†ç¬¦ã€‚å½“ä½¿ç”¨ç›¸åŒé…ç½®åˆ›å»ºå¤šä¸ªå®ä¾‹æ—¶ï¼Œä½¿ç”¨æ­¤é€‰é¡¹é˜²æ­¢å†…å­˜æ³„æ¼ã€‚",
    },
    {
      name: "servers",
      type: "Record<string, MastraMCPServerDefinition>",
      description:
        "æœåŠ¡å™¨é…ç½®çš„æ˜ å°„ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜¯å”¯ä¸€çš„æœåŠ¡å™¨æ ‡è¯†ç¬¦ï¼Œå€¼æ˜¯æœåŠ¡å™¨é…ç½®ã€‚",
    },
    {
      name: "timeout",
      type: "number",
      isOptional: true,
      defaultValue: "60000",
      description:
        "æ‰€æœ‰æœåŠ¡å™¨çš„å…¨å±€è¶…æ—¶å€¼ï¼ˆæ¯«ç§’ï¼‰ï¼Œé™¤éåœ¨å•ä¸ªæœåŠ¡å™¨é…ç½®ä¸­è¦†ç›–ã€‚",
    },
  ]}
/>

### MastraMCPServerDefinition

`servers` æ˜ å°„ä¸­çš„æ¯ä¸ªæœåŠ¡å™¨éƒ½ä½¿ç”¨ `MastraMCPServerDefinition` ç±»å‹è¿›è¡Œé…ç½®ã€‚ä¼ è¾“ç±»å‹æ ¹æ®æä¾›çš„å‚æ•°è‡ªåŠ¨æ£€æµ‹ï¼š

- å¦‚æœæä¾›äº† `command`ï¼Œåˆ™ä½¿ç”¨ Stdio ä¼ è¾“ã€‚
- å¦‚æœæä¾›äº† `url`ï¼Œåˆ™é¦–å…ˆå°è¯•ä½¿ç”¨æµå¼ HTTP ä¼ è¾“ï¼Œå¦‚æœåˆå§‹è¿æ¥å¤±è´¥åˆ™å›é€€åˆ°ä¼ ç»Ÿçš„ SSE ä¼ è¾“ã€‚

<br />
<PropertiesTable
  content={[
    {
      name: "command",
      type: "string",
      isOptional: true,
      description: "å¯¹äº Stdio æœåŠ¡å™¨ï¼šè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚",
    },
    {
      name: "args",
      type: "string[]",
      isOptional: true,
      description: "å¯¹äº Stdio æœåŠ¡å™¨ï¼šä¼ é€’ç»™å‘½ä»¤çš„å‚æ•°ã€‚",
    },
    {
      name: "env",
      type: "Record<string, string>",
      isOptional: true,
      description:
        "å¯¹äº Stdio æœåŠ¡å™¨ï¼šè¦ä¸ºå‘½ä»¤è®¾ç½®çš„ç¯å¢ƒå˜é‡ã€‚",
    },
    {
      name: "url",
      type: "URL",
      isOptional: true,
      description:
        "å¯¹äº HTTP æœåŠ¡å™¨ï¼ˆæµå¼ HTTP æˆ– SSEï¼‰ï¼šæœåŠ¡å™¨çš„ URLã€‚",
    },
    {
      name: "requestInit",
      type: "RequestInit",
      isOptional: true,
      description: "å¯¹äº HTTP æœåŠ¡å™¨ï¼šfetch API çš„è¯·æ±‚é…ç½®ã€‚",
    },
    {
      name: "eventSourceInit",
      type: "EventSourceInit",
      isOptional: true,
      description:
        "å¯¹äº SSE å›é€€ï¼šSSE è¿æ¥çš„è‡ªå®šä¹‰ fetch é…ç½®ã€‚ä½¿ç”¨ SSE è‡ªå®šä¹‰æ ‡å¤´æ—¶éœ€è¦æ­¤é…ç½®ã€‚",
    },
    {
      name: "fetch",
      type: "FetchLike",
      isOptional: true,
      description:
        "å¯¹äº HTTP æœåŠ¡å™¨ï¼šç”¨äºæ‰€æœ‰ç½‘ç»œè¯·æ±‚çš„è‡ªå®šä¹‰ fetch å®ç°ã€‚æä¾›æ­¤å‡½æ•°åï¼Œå®ƒå°†ç”¨äºæ‰€æœ‰ HTTP è¯·æ±‚ï¼Œå…è®¸æ‚¨æ·»åŠ åŠ¨æ€èº«ä»½éªŒè¯æ ‡å¤´ï¼ˆä¾‹å¦‚ï¼Œåˆ·æ–° bearer ä»¤ç‰Œï¼‰ã€è‡ªå®šä¹‰æ¯ä¸ªè¯·æ±‚çš„è¡Œä¸ºï¼Œæˆ–æ‹¦æˆªå’Œä¿®æ”¹è¯·æ±‚/å“åº”ã€‚æä¾› `fetch` åï¼Œ`requestInit`ã€`eventSourceInit` å’Œ `authProvider` å˜ä¸ºå¯é€‰ï¼Œå› ä¸ºæ‚¨å¯ä»¥åœ¨è‡ªå®šä¹‰ fetch å‡½æ•°ä¸­å¤„ç†è¿™äº›é—®é¢˜ã€‚",
    },
    {
      name: "logger",
      type: "LogHandler",
      isOptional: true,
      description: "å¯é€‰çš„æ—¥å¿—å¤„ç†å™¨ã€‚",
    },
    {
      name: "timeout",
      type: "number",
      isOptional: true,
      description: "æœåŠ¡å™¨ç‰¹å®šçš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚",
    },
    {
      name: "capabilities",
      type: "ClientCapabilities",
      isOptional: true,
      description: "æœåŠ¡å™¨ç‰¹å®šçš„èƒ½åŠ›é…ç½®ã€‚",
    },
    {
      name: "authProvider",
      type: "OAuthClientProvider",
      isOptional: true,
      description: "å¯¹äº HTTP æœåŠ¡å™¨ï¼šç”¨äºè‡ªåŠ¨ä»¤ç‰Œåˆ·æ–°å’Œ OAuth æµç¨‹ç®¡ç†çš„ OAuth èº«ä»½éªŒè¯æä¾›ç¨‹åºã€‚è¯·ä½¿ç”¨ `MCPOAuthClientProvider` è·å–ç°æˆçš„å®ç°ã€‚",
    },
    {
      name: "enableServerLogs",
      type: "boolean",
      isOptional: true,
      defaultValue: "true",
      description: "æ˜¯å¦å¯ç”¨æ­¤æœåŠ¡å™¨çš„æ—¥å¿—è®°å½•ã€‚",
    },
  ]}
/>

## æ–¹æ³•

### listTools()

ä»æ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨ä¸­æ£€ç´¢æ‰€æœ‰å·¥å…·ï¼Œå·¥å…·åç§°ä»¥æœåŠ¡å™¨åç§°ä¸ºå‘½åç©ºé—´ï¼ˆæ ¼å¼ä¸º `serverName_toolName`ï¼‰ä»¥é˜²æ­¢å†²çªã€‚

ç”¨äºä¼ é€’ç»™ä»£ç†å®šä¹‰ä½¿ç”¨ã€‚

```ts
new Agent({ id: "agent", tools: await mcp.listTools() });
```

### listToolsets()

è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå°†å‘½åç©ºé—´çš„å·¥å…·åç§°ï¼ˆæ ¼å¼ä¸º `serverName.toolName`ï¼‰æ˜ å°„åˆ°å…¶å·¥å…·å®ç°ã€‚ç”¨äºåŠ¨æ€ä¼ é€’ç»™ generate æˆ– stream æ–¹æ³•ä½¿ç”¨ã€‚

```typescript
const res = await agent.stream(prompt, {
  toolsets: await mcp.listToolsets(),
});
```

### disconnect()

æ–­å¼€ä¸æ‰€æœ‰ MCP æœåŠ¡å™¨çš„è¿æ¥å¹¶æ¸…ç†èµ„æºã€‚

```typescript
async disconnect(): Promise<void>
```

### `resources` å±æ€§

`MCPClient` å®ä¾‹å…·æœ‰ä¸€ä¸ª `resources` å±æ€§ï¼Œæä¾›å¯¹èµ„æºç›¸å…³æ“ä½œçš„è®¿é—®ã€‚

```typescript
const mcpClient = new MCPClient({
  /* ...servers é…ç½®... */
});

// é€šè¿‡ mcpClient.resources è®¿é—®èµ„æºæ–¹æ³•
const allResourcesByServer = await mcpClient.resources.list();
const templatesByServer = await mcpClient.resources.templates();
// ä»¥åŠå…¶ä»–èµ„æºæ–¹æ³•ã€‚
```

#### `resources.list()`

ä»æ‰€æœ‰è¿æ¥çš„ MCP æœåŠ¡å™¨æ£€ç´¢æ‰€æœ‰å¯ç”¨çš„èµ„æºï¼ŒæŒ‰æœåŠ¡å™¨åç§°åˆ†ç»„ã€‚

```typescript
async list(): Promise<Record<string, Resource[]>>
```

ç¤ºä¾‹ï¼š

```typescript
const resourcesByServer = await mcpClient.resources.list();
for (const serverName in resourcesByServer) {
  console.log(`æ¥è‡ª ${serverName} çš„èµ„æº:`, resourcesByServer[serverName]);
}
```

#### `resources.templates()`

ä»æ‰€æœ‰è¿æ¥çš„ MCP æœåŠ¡å™¨æ£€ç´¢æ‰€æœ‰å¯ç”¨çš„èµ„æºæ¨¡æ¿ï¼ŒæŒ‰æœåŠ¡å™¨åç§°åˆ†ç»„ã€‚

```typescript
async templates(): Promise<Record<string, ResourceTemplate[]>>
```

ç¤ºä¾‹ï¼š

```typescript
const templatesByServer = await mcpClient.resources.templates();
for (const serverName in templatesByServer) {
  console.log(`æ¥è‡ª ${serverName} çš„æ¨¡æ¿:`, templatesByServer[serverName]);
}
```

#### `resources.read(serverName: string, uri: string)`

ä»å‘½åæœåŠ¡å™¨è¯»å–ç‰¹å®šèµ„æºçš„å†…å®¹ã€‚

```typescript
async read(serverName: string, uri: string): Promise<ReadResourceResult>
```

- `serverName`ï¼šæœåŠ¡å™¨çš„æ ‡è¯†ç¬¦ï¼ˆæ„é€ å‡½æ•°é€‰é¡¹ä¸­ä½¿ç”¨çš„é”®ï¼‰ã€‚
- `uri`ï¼šè¦è¯»å–çš„èµ„æºçš„ URIã€‚

ç¤ºä¾‹ï¼š

```typescript
const content = await mcpClient.resources.read(
  "myWeatherServer",
  "weather://current",
);
console.log("å½“å‰å¤©æ°”:", content.contents[0].text);
```

#### `resources.subscribe(serverName: string, uri: string)`

è®¢é˜…å‘½åæœåŠ¡å™¨ä¸Šç‰¹å®šèµ„æºçš„æ›´æ–°ã€‚

```typescript
async subscribe(serverName: string, uri: string): Promise<object>
```

ç¤ºä¾‹ï¼š

```typescript
await mcpClient.resources.subscribe("myWeatherServer", "weather://current");
```

#### `resources.unsubscribe(serverName: string, uri: string)`

å–æ¶ˆè®¢é˜…å‘½åæœåŠ¡å™¨ä¸Šç‰¹å®šèµ„æºçš„æ›´æ–°ã€‚

```typescript
async unsubscribe(serverName: string, uri: string): Promise<object>
```

ç¤ºä¾‹ï¼š

```typescript
await mcpClient.resources.unsubscribe("myWeatherServer", "weather://current");
```

#### `resources.onUpdated(serverName: string, handler: (params: { uri: string }) => void)`

è®¾ç½®ä¸€ä¸ªé€šçŸ¥å¤„ç†å™¨ï¼Œå½“ç‰¹å®šæœåŠ¡å™¨ä¸Šè®¢é˜…çš„èµ„æºæ›´æ–°æ—¶å°†è°ƒç”¨è¯¥å¤„ç†å™¨ã€‚

```typescript
async onUpdated(serverName: string, handler: (params: { uri: string }) => void): Promise<void>
```

ç¤ºä¾‹ï¼š

```typescript
mcpClient.resources.onUpdated("myWeatherServer", (params) => {
  console.log(`myWeatherServer ä¸Šçš„èµ„æºå·²æ›´æ–°: ${params.uri}`);
  // æ‚¨å¯èƒ½å¸Œæœ›åœ¨æ­¤é‡æ–°è·å–èµ„æºå†…å®¹
  // await mcpClient.resources.read("myWeatherServer", params.uri);
});
```

#### `resources.onListChanged(serverName: string, handler: () => void)`

è®¾ç½®ä¸€ä¸ªé€šçŸ¥å¤„ç†å™¨ï¼Œå½“ç‰¹å®šæœåŠ¡å™¨ä¸Šå¯ç”¨èµ„æºçš„æ•´ä½“åˆ—è¡¨å‘ç”Ÿå˜åŒ–æ—¶å°†è°ƒç”¨è¯¥å¤„ç†å™¨ã€‚

```typescript
async onListChanged(serverName: string, handler: () => void): Promise<void>
```

ç¤ºä¾‹ï¼š

```typescript
mcpClient.resources.onListChanged("myWeatherServer", () => {
  console.log("myWeatherServer ä¸Šçš„èµ„æºåˆ—è¡¨å·²æ›´æ”¹ã€‚");
  // æ‚¨åº”è¯¥é‡æ–°è·å–èµ„æºåˆ—è¡¨
  // await mcpClient.resources.list();
});
```

### `elicitation` å±æ€§

`MCPClient` å®ä¾‹å…·æœ‰ä¸€ä¸ª `elicitation` å±æ€§ï¼Œæä¾›å¯¹å¾æ±‚ç›¸å…³æ“ä½œçš„è®¿é—®ã€‚å¾æ±‚å…è®¸ MCP æœåŠ¡å™¨ä»ç”¨æˆ·è¯·æ±‚ç»“æ„åŒ–ä¿¡æ¯ã€‚

```typescript
const mcpClient = new MCPClient({
  /* ...servers é…ç½®... */
});

// è®¾ç½®å¾æ±‚å¤„ç†å™¨
mcpClient.elicitation.onRequest("serverName", async (request) => {
  // å¤„ç†æ¥è‡ªæœåŠ¡å™¨çš„å¾æ±‚è¯·æ±‚
  console.log("æœåŠ¡å™¨è¯·æ±‚:", request.message);
  console.log("æ¨¡å¼:", request.requestedSchema);

  // è¿”å›ç”¨æˆ·å“åº”
  return {
    action: "accept",
    content: { name: "John Doe", email: "john@example.com" },
  };
});
```

#### `elicitation.onRequest(serverName: string, handler: ElicitationHandler)`

è®¾ç½®ä¸€ä¸ªå¤„ç†å™¨å‡½æ•°ï¼Œå½“ä»»ä½•è¿æ¥çš„ MCP æœåŠ¡å™¨å‘é€å¾æ±‚è¯·æ±‚æ—¶å°†è°ƒç”¨è¯¥å‡½æ•°ã€‚å¤„ç†å™¨æ¥æ”¶è¯·æ±‚å¹¶å¿…é¡»è¿”å›å“åº”ã€‚

**ElicitationHandler å‡½æ•°ï¼š**

å¤„ç†å™¨å‡½æ•°æ¥æ”¶ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„è¯·æ±‚å¯¹è±¡ï¼š

- `message`ï¼šæè¿°éœ€è¦ä»€ä¹ˆä¿¡æ¯çš„å¯è¯»æ¶ˆæ¯
- `requestedSchema`ï¼šå®šä¹‰é¢„æœŸå“åº”ç»“æ„çš„ JSON æ¨¡å¼

å¤„ç†å™¨å¿…é¡»è¿”å›ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„ `ElicitResult`ï¼š

- `action`ï¼š`'accept'`ã€`'decline'` æˆ– `'cancel'` ä¹‹ä¸€
- `content`ï¼šç”¨æˆ·çš„æ•°æ®ï¼ˆä»…å½“ action ä¸º `'accept'` æ—¶ï¼‰

**ç¤ºä¾‹ï¼š**

```typescript
mcpClient.elicitation.onRequest("serverName", async (request) => {
  console.log(`æœåŠ¡å™¨è¯·æ±‚: ${request.message}`);

  // ç¤ºä¾‹ï¼šç®€å•çš„ç”¨æˆ·è¾“å…¥æ”¶é›†
  if (request.requestedSchema.properties.name) {
    // æ¨¡æ‹Ÿç”¨æˆ·æ¥å—å¹¶æä¾›æ•°æ®
    return {
      action: "accept",
      content: {
        name: "Alice Smith",
        email: "alice@example.com",
      },
    };
  }

  // æ¨¡æ‹Ÿç”¨æˆ·æ‹’ç»è¯·æ±‚
  return { action: "decline" };
});
```

**å®Œæ•´çš„äº¤äº’å¼ç¤ºä¾‹ï¼š**

```typescript
import { MCPClient } from "@mastra/mcp";
import { createInterface } from "readline";

const readline = createInterface({
  input: process.stdin,
  output: process.stdout,
});

function askQuestion(question: string): Promise<string> {
  return new Promise((resolve) => {
    readline.question(question, (answer) => resolve(answer.trim()));
  });
}

const mcpClient = new MCPClient({
  servers: {
    interactiveServer: {
      url: new URL("http://localhost:3000/mcp"),
    },
  },
});

// è®¾ç½®äº¤äº’å¼å¾æ±‚å¤„ç†å™¨
await mcpClient.elicitation.onRequest("interactiveServer", async (request) => {
  console.log(`\nğŸ“‹ æœåŠ¡å™¨è¯·æ±‚: ${request.message}`);
  console.log("å¿…éœ€çš„ä¿¡æ¯:");

  const schema = request.requestedSchema;
  const properties = schema.properties || {};
  const required = schema.required || [];
  const content: Record<string, any> = {};

  // æ”¶é›†æ¯ä¸ªå­—æ®µçš„è¾“å…¥
  for (const [fieldName, fieldSchema] of Object.entries(properties)) {
    const field = fieldSchema as any;
    const isRequired = required.includes(fieldName);

    let prompt = `${field.title || fieldName}`;
    if (field.description) prompt += ` (${field.description})`;
    if (isRequired) prompt += " *å¿…å¡«*";
    prompt += ": ";

    const answer = await askQuestion(prompt);

    // å¤„ç†å–æ¶ˆ
    if (answer.toLowerCase() === "cancel") {
      return { action: "cancel" };
    }

    // éªŒè¯å¿…å¡«å­—æ®µ
    if (answer === "" && isRequired) {
      console.log(`âŒ ${fieldName} æ˜¯å¿…å¡«çš„`);
      return { action: "decline" };
    }

    if (answer !== "") {
      content[fieldName] = answer;
    }
  }

  // ç¡®è®¤æäº¤
  console.log("\nğŸ“ æ‚¨æä¾›çš„ä¿¡æ¯:");
  console.log(JSON.stringify(content, null, 2));

  const confirm = await askQuestion(
    "\næäº¤æ­¤ä¿¡æ¯å—ï¼Ÿ(yes/no/cancel): ",
  );

  if (confirm.toLowerCase() === "yes" || confirm.toLowerCase() === "y") {
    return { action: "accept", content };
  } else if (confirm.toLowerCase() === "cancel") {
    return { action: "cancel" };
  } else {
    return { action: "decline" };
  }
});
```

### `prompts` å±æ€§

`MCPClient` å®ä¾‹å…·æœ‰ä¸€ä¸ª `prompts` å±æ€§ï¼Œæä¾›å¯¹æç¤ºè¯ç›¸å…³æ“ä½œçš„è®¿é—®ã€‚

```typescript
const mcpClient = new MCPClient({
  /* ...servers é…ç½®... */
});

// é€šè¿‡ mcpClient.prompts è®¿é—®æç¤ºè¯æ–¹æ³•
const allPromptsByServer = await mcpClient.prompts.list();
const { prompt, messages } = await mcpClient.prompts.get({
  serverName: "myWeatherServer",
  name: "current",
});
```

#### `prompts.list()`

ä»æ‰€æœ‰è¿æ¥çš„ MCP æœåŠ¡å™¨æ£€ç´¢æ‰€æœ‰å¯ç”¨çš„æç¤ºè¯ï¼ŒæŒ‰æœåŠ¡å™¨åç§°åˆ†ç»„ã€‚

```typescript
async list(): Promise<Record<string, Prompt[]>>
```

ç¤ºä¾‹ï¼š

```typescript
const promptsByServer = await mcpClient.prompts.list();
for (const serverName in promptsByServer) {
  console.log(`æ¥è‡ª ${serverName} çš„æç¤ºè¯:`, promptsByServer[serverName]);
}
```

#### `prompts.get({ serverName, name, args?, version? })`

ä»æœåŠ¡å™¨æ£€ç´¢ç‰¹å®šçš„æç¤ºè¯åŠå…¶æ¶ˆæ¯ã€‚

```typescript
async get({
  serverName,
  name,
  args?,
  version?,
}: {
  serverName: string;
  name: string;
  args?: Record<string, any>;
  version?: string;
}): Promise<{ prompt: Prompt; messages: PromptMessage[] }>
```

ç¤ºä¾‹ï¼š

```typescript
const { prompt, messages } = await mcpClient.prompts.get({
  serverName: "myWeatherServer",
  name: "current",
  args: { location: "London" },
});
console.log(prompt);
console.log(messages);
```

#### `prompts.onListChanged(serverName: string, handler: () => void)`

è®¾ç½®ä¸€ä¸ªé€šçŸ¥å¤„ç†å™¨ï¼Œå½“ç‰¹å®šæœåŠ¡å™¨ä¸Šå¯ç”¨æç¤ºè¯åˆ—è¡¨å‘ç”Ÿå˜åŒ–æ—¶å°†è°ƒç”¨è¯¥å¤„ç†å™¨ã€‚

```typescript
async onListChanged(serverName: string, handler: () => void): Promise<void>
```

ç¤ºä¾‹ï¼š

```typescript
mcpClient.prompts.onListChanged("myWeatherServer", () => {
  console.log("myWeatherServer ä¸Šçš„æç¤ºè¯åˆ—è¡¨å·²æ›´æ”¹ã€‚");
  // æ‚¨åº”è¯¥é‡æ–°è·å–æç¤ºè¯åˆ—è¡¨
  // await mcpClient.prompts.list();
});
```

### `progress` å±æ€§

`MCPClient` å®ä¾‹å…·æœ‰ä¸€ä¸ª `progress` å±æ€§ï¼Œç”¨äºè®¢é˜… MCP æœåŠ¡å™¨åœ¨å·¥å…·æ‰§è¡Œæ—¶å‘å‡ºçš„è¿›åº¦é€šçŸ¥ã€‚

```typescript
const mcpClient = new MCPClient({
  servers: {
    myServer: {
      url: new URL('http://localhost:4111/api/mcp/myServer/mcp'),
      // é»˜è®¤å¯ç”¨ï¼›è®¾ç½®ä¸º false ä»¥ç¦ç”¨
      enableProgressTracking: true,
    },
  },
});

// è®¢é˜…ç‰¹å®šæœåŠ¡å™¨çš„è¿›åº¦æ›´æ–°
await mcpClient.progress.onUpdate('myServer', (params) => {
  console.log('ğŸ“Š è¿›åº¦:', params.progress, '/', params.total);
  if (params.message) console.log('æ¶ˆæ¯:', params.message);
  if (params.progressToken) console.log('ä»¤ç‰Œ:', params.progressToken);
});
```

#### `progress.onUpdate(serverName: string, handler)`

æ³¨å†Œä¸€ä¸ªå¤„ç†å™¨å‡½æ•°ä»¥æ¥æ”¶æ¥è‡ªæŒ‡å®šæœåŠ¡å™¨çš„è¿›åº¦æ›´æ–°ã€‚

```typescript
async onUpdate(
  serverName: string,
  handler: (params: {
    progressToken: string;
    progress: number;
    total?: number;
    message?: string;
  }) => void,
): Promise<void>
```

æ³¨æ„äº‹é¡¹ï¼š

- å½“ `enableProgressTracking` ä¸º trueï¼ˆé»˜è®¤ï¼‰æ—¶ï¼Œå·¥å…·è°ƒç”¨åŒ…å«ä¸€ä¸ª `progressToken`ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å°†æ›´æ–°å…³è”åˆ°ç‰¹å®šçš„è¿è¡Œã€‚
- å¦‚æœåœ¨æ‰§è¡Œå·¥å…·æ—¶ä¼ é€’äº† `runId`ï¼Œå®ƒå°†è¢«ç”¨ä½œ `progressToken`ã€‚

è¦ç¦ç”¨æœåŠ¡å™¨çš„è¿›åº¦è·Ÿè¸ªï¼š

```typescript
const mcpClient = new MCPClient({
  servers: {
    myServer: {
      url: new URL('http://localhost:4111/api/mcp/myServer/mcp'),
      enableProgressTracking: false,
    },
  },
});
```

## å¾æ±‚

å¾æ±‚æ˜¯ä¸€é¡¹å…è®¸ MCP æœåŠ¡å™¨ä»ç”¨æˆ·è¯·æ±‚ç»“æ„åŒ–ä¿¡æ¯çš„åŠŸèƒ½ã€‚å½“æœåŠ¡å™¨éœ€è¦é¢å¤–æ•°æ®æ—¶ï¼Œå®ƒå¯ä»¥å‘é€ä¸€ä¸ªå¾æ±‚è¯·æ±‚ï¼Œå®¢æˆ·ç«¯é€šè¿‡æç¤ºç”¨æˆ·æ¥å¤„ç†è¯¥è¯·æ±‚ã€‚ä¸€ä¸ªå¸¸è§çš„ç¤ºä¾‹æ˜¯åœ¨å·¥å…·è°ƒç”¨æœŸé—´ã€‚

### å¾æ±‚çš„å·¥ä½œåŸç†

1. **æœåŠ¡å™¨è¯·æ±‚**ï¼šMCP æœåŠ¡å™¨å·¥å…·è°ƒç”¨ `server.elicitation.sendRequest()` å¹¶é™„å¸¦æ¶ˆæ¯å’Œæ¨¡å¼
2. **å®¢æˆ·ç«¯å¤„ç†å™¨**ï¼šæ‚¨çš„å¾æ±‚å¤„ç†å™¨å‡½æ•°è¢«è°ƒç”¨å¹¶æ¥æ”¶è¯·æ±‚
3. **ç”¨æˆ·äº¤äº’**ï¼šæ‚¨çš„å¤„ç†å™¨æ”¶é›†ç”¨æˆ·è¾“å…¥ï¼ˆé€šè¿‡ UIã€CLI ç­‰ï¼‰
4. **å“åº”**ï¼šæ‚¨çš„å¤„ç†å™¨è¿”å›ç”¨æˆ·çš„å“åº”ï¼ˆæ¥å—/æ‹’ç»/å–æ¶ˆï¼‰
5. **å·¥å…·ç»§ç»­**ï¼šæœåŠ¡å™¨å·¥å…·æ¥æ”¶å“åº”å¹¶ç»§ç»­æ‰§è¡Œ

### è®¾ç½®å¾æ±‚

æ‚¨å¿…é¡»åœ¨è°ƒç”¨ä½¿ç”¨å¾æ±‚çš„å·¥å…·ä¹‹å‰è®¾ç½®å¾æ±‚å¤„ç†å™¨ï¼š

```typescript
import { MCPClient } from "@mastra/mcp";

const mcpClient = new MCPClient({
  servers: {
    interactiveServer: {
      url: new URL("http://localhost:3000/mcp"),
    },
  },
});

// è®¾ç½®å¾æ±‚å¤„ç†å™¨
mcpClient.elicitation.onRequest("interactiveServer", async (request) => {
  // å¤„ç†æœåŠ¡å™¨å¯¹ç”¨æˆ·è¾“å…¥çš„è¯·æ±‚
  console.log(`æœåŠ¡å™¨éœ€è¦: ${request.message}`);

  // æ‚¨çš„æ”¶é›†ç”¨æˆ·è¾“å…¥çš„é€»è¾‘
  const userData = await collectUserInput(request.requestedSchema);

  return {
    action: "accept",
    content: userData,
  };
});
```

### å“åº”ç±»å‹

æ‚¨çš„å¾æ±‚å¤„ç†å™¨å¿…é¡»è¿”å›ä¸‰ç§å“åº”ç±»å‹ä¹‹ä¸€ï¼š

- **æ¥å—**ï¼šç”¨æˆ·æä¾›äº†æ•°æ®å¹¶ç¡®è®¤æäº¤

  ```typescript
  return {
    action: "accept",
    content: { name: "John Doe", email: "john@example.com" },
  };
  ```

- **æ‹’ç»**ï¼šç”¨æˆ·æ˜ç¡®æ‹’ç»æä¾›ä¿¡æ¯

  ```typescript
  return { action: "decline" };
  ```

- **å–æ¶ˆ**ï¼šç”¨æˆ· dismissal æˆ–å–æ¶ˆäº†è¯·æ±‚
  ```typescript
  return { action: "cancel" };
  ```

### åŸºäºæ¨¡å¼çš„è¾“å…¥æ”¶é›†

`requestedSchema` æä¾›æœåŠ¡å™¨éœ€è¦æ•°æ®çš„ç»“æ„ï¼š

```typescript
await mcpClient.elicitation.onRequest("interactiveServer", async (request) => {
  const { properties, required = [] } = request.requestedSchema;
  const content: Record<string, any> = {};

  for (const [fieldName, fieldSchema] of Object.entries(properties || {})) {
    const field = fieldSchema as any;
    const isRequired = required.includes(fieldName);

    // æ ¹æ®å­—æ®µç±»å‹å’Œè¦æ±‚æ”¶é›†è¾“å…¥
    const value = await promptUser({
      name: fieldName,
      title: field.title,
      description: field.description,
      type: field.type,
      required: isRequired,
      format: field.format,
      enum: field.enum,
    });

    if (value !== null) {
      content[fieldName] = value;
    }
  }

  return { action: "accept", content };
});
```

### æœ€ä½³å®è·µ

- **å§‹ç»ˆå¤„ç†å¾æ±‚**ï¼šåœ¨è°ƒç”¨å¯èƒ½ä½¿ç”¨å¾æ±‚çš„å·¥å…·ä¹‹å‰è®¾ç½®å¤„ç†å™¨
- **éªŒè¯è¾“å…¥**ï¼šæ£€æŸ¥æ˜¯å¦æä¾›äº†å¿…å¡«å­—æ®µ
- **å°Šé‡ç”¨æˆ·é€‰æ‹©**ï¼šä¼˜é›…åœ°å¤„ç†æ‹’ç»å’Œå–æ¶ˆå“åº”
- **æ¸…æ™°çš„ UI**ï¼šè®©ç”¨æˆ·æ¸…æ¥šæ­£åœ¨è¯·æ±‚ä»€ä¹ˆä¿¡æ¯ä»¥åŠä¸ºä»€ä¹ˆ
- **å®‰å…¨æ€§**ï¼šæ°¸è¿œä¸è¦è‡ªåŠ¨æ¥å—æ•æ„Ÿä¿¡æ¯çš„è¯·æ±‚

## OAuth èº«ä»½éªŒè¯

è¦è¿æ¥éœ€è¦æ ¹æ® [MCP èº«ä»½éªŒè¯è§„èŒƒ](https://modelcontextprotocol.io/specification/2025-06-18/basic/authorization) è¿›è¡Œ OAuth èº«ä»½éªŒè¯çš„ MCP æœåŠ¡å™¨ï¼Œè¯·ä½¿ç”¨ `MCPOAuthClientProvider`ï¼š

```typescript
import { MCPClient, MCPOAuthClientProvider } from "@mastra/mcp";

// åˆ›å»º OAuth æä¾›ç¨‹åº
const oauthProvider = new MCPOAuthClientProvider({
  redirectUrl: "http://localhost:3000/oauth/callback",
  clientMetadata: {
    redirect_uris: ["http://localhost:3000/oauth/callback"],
    client_name: "My MCP Client",
    grant_types: ["authorization_code", "refresh_token"],
    response_types: ["code"],
  },
  onRedirectToAuthorization: (url) => {
    // å¤„ç†æˆæƒé‡å®šå‘ï¼ˆæ‰“å¼€æµè§ˆå™¨ã€é‡å®šå‘å“åº”ç­‰ï¼‰
    console.log(`è¯·è®¿é—®: ${url}`);
  },
});

// å°†æä¾›ç¨‹åºä¸ MCPClient ä¸€èµ·ä½¿ç”¨
const client = new MCPClient({
  servers: {
    protectedServer: {
      url: new URL("https://mcp.example.com/mcp"),
      authProvider: oauthProvider,
    },
  },
});
```

### å¿«é€Ÿä»¤ç‰Œæä¾›ç¨‹åº

ç”¨äºæµ‹è¯•æˆ–å½“æ‚¨å·²ç»æ‹¥æœ‰æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ—¶ï¼š

```typescript
import { MCPClient, createSimpleTokenProvider } from "@mastra/mcp";

const provider = createSimpleTokenProvider("your-access-token", {
  redirectUrl: "http://localhost:3000/callback",
  clientMetadata: {
    redirect_uris: ["http://localhost:3000/callback"],
    client_name: "Test Client",
  },
});

const client = new MCPClient({
  servers: {
    testServer: {
      url: new URL("https://mcp.example.com/mcp"),
      authProvider: provider,
    },
  },
});
```

### è‡ªå®šä¹‰ä»¤ç‰Œå­˜å‚¨

è¦åœ¨ä¼šè¯ä¹‹é—´æŒä¹…åŒ–ä»¤ç‰Œå­˜å‚¨ï¼Œå®ç° `OAuthStorage` æ¥å£ï¼š

```typescript
import { MCPOAuthClientProvider, OAuthStorage } from "@mastra/mcp";

class DatabaseOAuthStorage implements OAuthStorage {
  constructor(private db: Database, private userId: string) {}

  async set(key: string, value: string): Promise<void> {
    await this.db.query(
      "INSERT INTO oauth_tokens (user_id, key, value) VALUES (?, ?, ?) ON CONFLICT DO UPDATE SET value = ?",
      [this.userId, key, value, value]
    );
  }

  async get(key: string): Promise<string | undefined> {
    const result = await this.db.query(
      "SELECT value FROM oauth_tokens WHERE user_id = ? AND key = ?",
      [this.userId, key]
    );
    return result?.[0]?.value;
  }

  async delete(key: string): Promise<void> {
    await this.db.query(
      "DELETE FROM oauth_tokens WHERE user_id = ? AND key = ?",
      [this.userId, key]
    );
  }
}

const provider = new MCPOAuthClientProvider({
  redirectUrl: "http://localhost:3000/callback",
  clientMetadata: { /* ... */ },
  storage: new DatabaseOAuthStorage(db, "user-123"),
});
```

## ç¤ºä¾‹

### é™æ€å·¥å…·é…ç½®

å¯¹äºæ•´ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ª MCP æœåŠ¡å™¨è¿æ¥çš„å·¥å…·ï¼Œä½¿ç”¨ `listTools()` å¹¶å°†å·¥å…·ä¼ é€’ç»™æ‚¨çš„ä»£ç†ï¼š

```typescript
import { MCPClient } from "@mastra/mcp";
import { Agent } from "@mastra/core/agent";

const mcp = new MCPClient({
  servers: {
    stockPrice: {
      command: "npx",
      args: ["tsx", "stock-price.ts"],
      env: {
        API_KEY: "your-api-key",
      },
      log: (logMessage) => {
        console.log(`[${logMessage.level}] ${logMessage.message}`);
      },
    },
    weather: {
      url: new URL("http://localhost:8080/sse"),
    },
  },
  timeout: 30000, // å…¨å±€ 30 ç§’è¶…æ—¶
});

// åˆ›å»ºå¯ä»¥è®¿é—®æ‰€æœ‰å·¥å…·çš„ä»£ç†
const agent = new Agent({
  id: "multi-tool-agent",
  name: "Multi-tool Agent",
  instructions: "æ‚¨å¯ä»¥è®¿é—®å¤šä¸ªå·¥å…·æœåŠ¡å™¨ã€‚",
  model: "openai/gpt-5.1",
  tools: await mcp.listTools(),
});

// ä½¿ç”¨èµ„æºæ–¹æ³•çš„ç¤ºä¾‹
async function checkWeatherResource() {
  try {
    const weatherResources = await mcp.resources.list();
    if (weatherResources.weather && weatherResources.weather.length > 0) {
      const currentWeatherURI = weatherResources.weather[0].uri;
      const weatherData = await mcp.resources.read(
        "weather",
        currentWeatherURI,
      );
      console.log("å¤©æ°”æ•°æ®:", weatherData.contents[0].text);
    }
  } catch (error) {
    console.error("è·å–å¤©æ°”èµ„æºæ—¶å‡ºé”™:", error);
  }
}
checkWeatherResource();

// ä½¿ç”¨æç¤ºè¯æ–¹æ³•çš„ç¤ºä¾‹
async function checkWeatherPrompt() {
  try {
    const weatherPrompts = await mcp.prompts.list();
    if (weatherPrompts.weather && weatherPrompts.weather.length > 0) {
      const currentWeatherPrompt = weatherPrompts.weather.find(
        (p) => p.name === "current",
      );
      if (currentWeatherPrompt) {
        console.log("å¤©æ°”æç¤ºè¯:", currentWeatherPrompt);
      } else {
        console.log("æœªæ‰¾åˆ°å½“å‰å¤©æ°”æç¤ºè¯");
      }
    }
  } catch (error) {
    console.error("è·å–å¤©æ°”æç¤ºè¯æ—¶å‡ºé”™:", error);
  }
}
checkWeatherPrompt();
```

### åŠ¨æ€å·¥å…·é›†

å½“æ‚¨éœ€è¦ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºæ–°çš„ MCP è¿æ¥æ—¶ï¼Œä½¿ç”¨ `listToolsets()` å¹¶åœ¨è°ƒç”¨ stream æˆ– generate æ—¶æ·»åŠ å·¥å…·ï¼š

```typescript
import { Agent } from "@mastra/core/agent";
import { MCPClient } from "@mastra/mcp";

// é¦–å…ˆåˆ›å»ºä»£ç†ï¼Œä¸å¸¦ä»»ä½•å·¥å…·
const agent = new Agent({
  id: "multi-tool-agent",
  name: "Multi-tool Agent",
  instructions: "æ‚¨å¯ä»¥å¸®åŠ©ç”¨æˆ·æ£€æŸ¥è‚¡ç¥¨å’Œå¤©æ°”ã€‚",
  model: "openai/gpt-5.1",
});

// ä¹‹åä½¿ç”¨ç”¨æˆ·ç‰¹å®šé…ç½®é…ç½® MCP
const mcp = new MCPClient({
  servers: {
    stockPrice: {
      command: "npx",
      args: ["tsx", "stock-price.ts"],
      env: {
        API_KEY: "user-123-api-key",
      },
      timeout: 20000, // æœåŠ¡å™¨ç‰¹å®šè¶…æ—¶
    },
    weather: {
      url: new URL("http://localhost:8080/sse"),
      requestInit: {
        headers: {
          Authorization: `Bearer user-123-token`,
        },
      },
    },
  },
});

// å°†æ‰€æœ‰å·¥å…·é›†ä¼ é€’ç»™ stream() æˆ– generate()
const response = await agent.stream(
  "AAPL çš„æƒ…å†µå¦‚ä½•ï¼Œå¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ",
  {
    toolsets: await mcp.listToolsets(),
  },
);
```

## å®ä¾‹ç®¡ç†

`MCPClient` ç±»åŒ…å«ç”¨äºç®¡ç†å¤šä¸ªå®ä¾‹çš„å†…ç½®å†…å­˜æ³„æ¼é¢„é˜²åŠŸèƒ½ï¼š

1. åˆ›å»ºå¤šä¸ªå…·æœ‰ç›¸åŒé…ç½®ä½†æ²¡æœ‰ `id` çš„å®ä¾‹å°†æŠ›å‡ºé”™è¯¯ä»¥é˜²æ­¢å†…å­˜æ³„æ¼
2. å¦‚æœæ‚¨éœ€è¦å…·æœ‰ç›¸åŒé…ç½®çš„å¤šä¸ªå®ä¾‹ï¼Œè¯·ä¸ºæ¯ä¸ªå®ä¾‹æä¾›å”¯ä¸€çš„ `id`
3. åœ¨é‡æ–°åˆ›å»ºå…·æœ‰ç›¸åŒé…ç½®çš„å®ä¾‹ä¹‹å‰è°ƒç”¨ `await configuration.disconnect()`
4. å¦‚æœæ‚¨åªéœ€è¦ä¸€ä¸ªå®ä¾‹ï¼Œè€ƒè™‘å°†é…ç½®ç§»åˆ°æ›´é«˜çš„ä½œç”¨åŸŸä»¥é¿å…é‡æ–°åˆ›å»º

ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å°è¯•åˆ›å»ºå¤šä¸ªå…·æœ‰ç›¸åŒé…ç½®ä½†æ²¡æœ‰ `id` çš„å®ä¾‹ï¼š

```typescript
// ç¬¬ä¸€ä¸ªå®ä¾‹ - æ­£å¸¸
const mcp1 = new MCPClient({
  servers: {
    /* ... */
  },
});

// ç¬¬äºŒä¸ªå®ä¾‹ï¼Œç›¸åŒé…ç½® - å°†æŠ›å‡ºé”™è¯¯
const mcp2 = new MCPClient({
  servers: {
    /* ... */
  },
});

// è¦ä¿®å¤ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š
// 1. æ·»åŠ å”¯ä¸€ ID
const mcp3 = new MCPClient({
  id: "instance-1",
  servers: {
    /* ... */
  },
});

// 2. æˆ–åœ¨é‡æ–°åˆ›å»ºä¹‹å‰æ–­å¼€è¿æ¥
await mcp1.disconnect();
const mcp4 = new MCPClient({
  servers: {
    /* ... */
  },
});
```

## æœåŠ¡å™¨ç”Ÿå‘½å‘¨æœŸ

MCPClient ä¼˜é›…åœ°å¤„ç†æœåŠ¡å™¨è¿æ¥ï¼š

1. å¤šæœåŠ¡å™¨çš„è‡ªåŠ¨è¿æ¥ç®¡ç†
2. ä¼˜é›…çš„æœåŠ¡å™¨å…³é—­ï¼Œé˜²æ­¢å¼€å‘è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯æ¶ˆæ¯
3. æ–­å¼€è¿æ¥æ—¶æ­£ç¡®æ¸…ç†èµ„æº

## ä½¿ç”¨è‡ªå®šä¹‰ Fetch è¿›è¡ŒåŠ¨æ€èº«ä»½éªŒè¯

å¯¹äº HTTP æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥æä¾›è‡ªå®šä¹‰ `fetch` å‡½æ•°æ¥å¤„ç†åŠ¨æ€èº«ä»½éªŒè¯ã€è¯·æ±‚æ‹¦æˆªæˆ–å…¶ä»–è‡ªå®šä¹‰è¡Œä¸ºã€‚å½“æ‚¨éœ€è¦åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šåˆ·æ–°ä»¤ç‰Œæˆ–è‡ªå®šä¹‰è¯·æ±‚è¡Œä¸ºæ—¶ï¼Œè¿™ç‰¹åˆ«æœ‰ç”¨ã€‚

æä¾› `fetch` åï¼Œ`requestInit`ã€`eventSourceInit` å’Œ `authProvider` å˜ä¸ºå¯é€‰ï¼Œå› ä¸ºæ‚¨å¯ä»¥åœ¨è‡ªå®šä¹‰ fetch å‡½æ•°ä¸­å¤„ç†è¿™äº›é—®é¢˜ã€‚

```typescript
const mcpClient = new MCPClient({
  servers: {
    apiServer: {
      url: new URL("https://api.example.com/mcp"),
      fetch: async (url, init) => {
        // åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šåˆ·æ–°ä»¤ç‰Œ
        const token = await getAuthToken(); // æ‚¨çš„ä»¤ç‰Œåˆ·æ–°é€»è¾‘

        return fetch(url, {
          ...init,
          headers: {
            ...init?.headers,
            Authorization: `Bearer ${token}`,
          },
        });
      },
    },
  },
});
```

## ä½¿ç”¨ SSE è¯·æ±‚å¤´

ä½¿ç”¨ä¼ ç»Ÿçš„ SSE MCP ä¼ è¾“æ—¶ï¼Œç”±äº MCP SDK ä¸­çš„ä¸€ä¸ª bugï¼Œæ‚¨å¿…é¡»åŒæ—¶é…ç½® `requestInit` å’Œ `eventSourceInit`ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ `fetch` å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è‡ªåŠ¨ç”¨äº POST è¯·æ±‚å’Œ SSE è¿æ¥ï¼š

```ts
// é€‰é¡¹ 1ï¼šä½¿ç”¨ requestInit å’Œ eventSourceInitï¼ˆSSE éœ€è¦ï¼‰
const sseClient = new MCPClient({
  servers: {
    exampleServer: {
      url: new URL("https://your-mcp-server.com/sse"),
      // æ³¨æ„ï¼šä»… requestInit ä¸è¶³ä»¥æ”¯æŒ SSE
      requestInit: {
        headers: {
          Authorization: "Bearer your-token",
        },
      },
      // å¯¹äºä½¿ç”¨è‡ªå®šä¹‰æ ‡å¤´çš„ SSE è¿æ¥ï¼Œè¿™ä¹Ÿéœ€è¦
      eventSourceInit: {
        fetch(input: Request | URL | string, init?: RequestInit) {
          const headers = new Headers(init?.headers || {});
          headers.set("Authorization", "Bearer your-token");
          return fetch(input, {
            ...init,
            headers,
          });
        },
      },
    },
  },
});

// é€‰é¡¹ 2ï¼šä½¿ç”¨è‡ªå®šä¹‰ fetchï¼ˆæ›´ç®€å•ï¼Œé€‚ç”¨äºæµå¼ HTTP å’Œ SSEï¼‰
const sseClientWithFetch = new MCPClient({
  servers: {
    exampleServer: {
      url: new URL("https://your-mcp-server.com/sse"),
      fetch: async (url, init) => {
        const headers = new Headers(init?.headers || {});
        headers.set("Authorization", "Bearer your-token");
        return fetch(url, {
          ...init,
          headers,
        });
      },
    },
  },
});
```

## ç›¸å…³ä¿¡æ¯

- è¦åˆ›å»º MCP æœåŠ¡å™¨ï¼Œè¯·å‚é˜… [MCPServer æ–‡æ¡£](./mcp-server)ã€‚
- æœ‰å…³æ¨¡å‹ä¸Šä¸‹æ–‡åè®®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [@modelcontextprotocol/sdk æ–‡æ¡£](https://github.com/modelcontextprotocol/typescript-sdk)ã€‚
