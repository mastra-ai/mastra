---
title: "å·¥ä½œæµæ¦‚è¿° | å·¥ä½œæµ"
description: "Mastra ä¸­çš„å·¥ä½œæµå¸®åŠ©ä½ ç¼–æ’å¤æ‚çš„ä»»åŠ¡åºåˆ—ï¼ŒåŒ…æ‹¬åˆ†æ”¯ã€å¹¶è¡Œæ‰§è¡Œã€èµ„æºæš‚åœç­‰åŠŸèƒ½ã€‚"
packages:
  - "@mastra/core"
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# å·¥ä½œæµæ¦‚è¿°

å·¥ä½œæµå…è®¸ä½ ä½¿ç”¨æ¸…æ™°ã€ç»“æ„åŒ–çš„æ­¥éª¤å®šä¹‰å¤æ‚çš„ä»»åŠ¡åºåˆ—ï¼Œè€Œä¸æ˜¯ä¾èµ–å•ä¸ªä»£ç†çš„æ¨ç†ã€‚å®ƒä»¬è®©ä½ å®Œå…¨æ§åˆ¶ä»»åŠ¡çš„åˆ†è§£æ–¹å¼ã€æ•°æ®åœ¨å®ƒä»¬ä¹‹é—´çš„æµåŠ¨æ–¹å¼ï¼Œä»¥åŠä½•æ—¶æ‰§è¡Œä»€ä¹ˆå†…å®¹ã€‚å·¥ä½œæµé»˜è®¤ä½¿ç”¨å†…ç½®çš„æ‰§è¡Œå¼•æ“è¿è¡Œï¼Œä¹Ÿå¯ä»¥éƒ¨ç½²åˆ° [å·¥ä½œæµè¿è¡Œå™¨](/docs/cn/deployment/workflow-runners) å¦‚ Inngest ä»¥ä½¿ç”¨æ‰˜ç®¡åŸºç¡€è®¾æ–½ã€‚

![å·¥ä½œæµæ¦‚è¿°](/img/workflows/workflows-overview.jpg)

## ä½•æ—¶ä½¿ç”¨å·¥ä½œæµ

å¯¹äºé¢„å…ˆæ˜ç¡®å®šä¹‰ä¸”æ¶‰åŠå¤šä¸ªå…·æœ‰ç‰¹å®šæ‰§è¡Œé¡ºåºçš„æ­¥éª¤çš„ä»»åŠ¡ï¼Œä½¿ç”¨å·¥ä½œæµã€‚å®ƒä»¬è®©ä½ å¯¹æ•°æ®åœ¨æ­¥éª¤ä¹‹é—´å¦‚ä½•æµåŠ¨å’Œè½¬æ¢ï¼Œä»¥åŠæ¯ä¸ªé˜¶æ®µè°ƒç”¨å“ªäº›åŸè¯­è¿›è¡Œç»†ç²’åº¦æ§åˆ¶ã€‚

> **ğŸ“¹ è§‚çœ‹**ï¼šâ†’ å·¥ä½œæµä»‹ç»ï¼Œä»¥åŠå®ƒä»¬ä¸ä»£ç†çš„æ¯”è¾ƒ [YouTubeï¼ˆ7åˆ†é’Ÿï¼‰](https://youtu.be/0jg2g3sNvgw)

## æ ¸å¿ƒåŸåˆ™

Mastra å·¥ä½œæµéµå¾ªä»¥ä¸‹åŸåˆ™è¿è¡Œï¼š

- ä½¿ç”¨ `createStep` å®šä¹‰**æ­¥éª¤**ï¼ŒæŒ‡å®šè¾“å…¥/è¾“å‡ºæ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ã€‚
- ä½¿ç”¨ `createWorkflow` ç»„åˆ**æ­¥éª¤**ä»¥å®šä¹‰æ‰§è¡Œæµç¨‹ã€‚
- è¿è¡Œ**å·¥ä½œæµ**ä»¥æ‰§è¡Œæ•´ä¸ªåºåˆ—ï¼Œå†…ç½®æ”¯æŒæš‚åœã€æ¢å¤å’Œæµå¼ç»“æœã€‚

## åˆ›å»ºå·¥ä½œæµæ­¥éª¤

æ­¥éª¤æ˜¯å·¥ä½œæµçš„æ„å»ºå—ã€‚ä½¿ç”¨ `createStep()` åˆ›å»ºæ­¥éª¤ï¼Œå¹¶ä½¿ç”¨ `inputSchema` å’Œ `outputSchema` å®šä¹‰å®ƒæ¥å—å’Œè¿”å›çš„æ•°æ®ã€‚

`execute` å‡½æ•°å®šä¹‰æ­¥éª¤æ‰§è¡Œçš„æ“ä½œã€‚ä½¿ç”¨å®ƒæ¥è°ƒç”¨ä»£ç åº“ä¸­çš„å‡½æ•°ã€å¤–éƒ¨ APIã€ä»£ç†æˆ–å·¥å…·ã€‚

```typescript {6,9,15} title="src/mastra/workflows/test-workflow.ts"
import { createStep } from "@mastra/core/workflows";

const step1 = createStep({
  id: "step-1",
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    formatted: z.string()
  }),
  execute: async ({ inputData }) => {
    const { message } = inputData;

    return {
      formatted: message.toUpperCase()
    };
  }
});
```

:::info

è®¿é—®[æ­¥éª¤ç±»](/reference/workflows/step)è·å–å®Œæ•´çš„é…ç½®é€‰é¡¹åˆ—è¡¨ã€‚

:::

### ä½¿ç”¨ä»£ç†å’Œå·¥å…·

å·¥ä½œæµæ­¥éª¤ä¹Ÿå¯ä»¥è°ƒç”¨å·²æ³¨å†Œçš„ä»£ç†æˆ–ç›´æ¥å¯¼å…¥å’Œæ‰§è¡Œå·¥å…·ï¼Œè®¿é—®[ä½¿ç”¨å·¥å…·](/docs/cn/agents/using-tools)é¡µé¢äº†è§£æ›´å¤šä¿¡æ¯ã€‚

## åˆ›å»ºå·¥ä½œæµ

ä½¿ç”¨ `createWorkflow()` åˆ›å»ºå·¥ä½œæµï¼Œå¹¶ä½¿ç”¨ `inputSchema` å’Œ `outputSchema` å®šä¹‰å®ƒæ¥å—å’Œè¿”å›çš„æ•°æ®ã€‚ä½¿ç”¨ `.then()` æ·»åŠ æ­¥éª¤ï¼Œå¹¶ä½¿ç”¨ `.commit()` å®Œæˆå·¥ä½œæµã€‚

```typescript {9,12,15,16} title="src/mastra/workflows/test-workflow.ts"
import { createWorkflow, createStep } from "@mastra/core/workflows";
import { z } from "zod";

const step1 = createStep({...});

export const testWorkflow = createWorkflow({
  id: "test-workflow",
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    output: z.string()
  })
})
  .then(step1)
  .commit();
```

:::info

è®¿é—®[å·¥ä½œæµç±»](/reference/workflows/workflow)è·å–å®Œæ•´çš„é…ç½®é€‰é¡¹åˆ—è¡¨ã€‚

:::

### ç†è§£æ§åˆ¶æµ

å·¥ä½œæµå¯ä»¥ä½¿ç”¨å¤šç§ä¸åŒçš„æ–¹æ³•è¿›è¡Œç»„åˆã€‚ä½ é€‰æ‹©çš„æ–¹æ³•å†³å®šäº†æ¯ä¸ªæ­¥éª¤çš„æ¨¡å¼åº”è¯¥å¦‚ä½•ç»“æ„åŒ–ã€‚è®¿é—®[æ§åˆ¶æµ](/docs/cn/workflows/control-flow)é¡µé¢äº†è§£æ›´å¤šä¿¡æ¯ã€‚

## å·¥ä½œæµçŠ¶æ€

å·¥ä½œæµçŠ¶æ€å…è®¸ä½ åœ¨æ­¥éª¤ä¹‹é—´å…±äº«å€¼ï¼Œè€Œæ— éœ€é€šè¿‡æ¯ä¸ªæ­¥éª¤çš„ inputSchema å’Œ outputSchema ä¼ é€’ã€‚ä½¿ç”¨çŠ¶æ€æ¥è·Ÿè¸ªè¿›åº¦ã€ç´¯ç§¯ç»“æœæˆ–åœ¨ entire å·¥ä½œæµä¸­å…±äº«é…ç½®ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({
  id: "step-1",
  inputSchema: z.object({ message: z.string() }),
  outputSchema: z.object({ formatted: z.string() }),
  stateSchema: z.object({ counter: z.number() }),
  execute: async ({ inputData, state, setState }) => {
    // ä»çŠ¶æ€è¯»å–
    console.log(state.counter);

    // ä¸ºåç»­æ­¥éª¤æ›´æ–°çŠ¶æ€
    setState({ ...state, counter: state.counter + 1 });

    return { formatted: inputData.message.toUpperCase() };
  },
});
```

:::info

è®¿é—®[å·¥ä½œæµçŠ¶æ€](/docs/cn/workflows/workflow-state)è·å–å…³äºçŠ¶æ€æ¨¡å¼ã€åˆå§‹çŠ¶æ€ã€æš‚åœ/æ¢å¤æŒä¹…åŒ–å’ŒåµŒå¥—å·¥ä½œæµçš„å®Œæ•´æ–‡æ¡£ã€‚

:::

## å·¥ä½œæµä½œä¸ºæ­¥éª¤

ä½¿ç”¨å·¥ä½œæµä½œä¸ºæ­¥éª¤ä»¥åœ¨æ›´å¤§çš„ç»„åˆä¸­é‡ç”¨å…¶é€»è¾‘ã€‚è¾“å…¥å’Œè¾“å‡ºéµå¾ª[æ ¸å¿ƒåŸåˆ™](/docs/cn/workflows/control-flow)ä¸­æè¿°çš„ç›¸åŒæ¨¡å¼è§„åˆ™ã€‚

```typescript {26} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...});
const step2 = createStep({...});

const childWorkflow = createWorkflow({
  id: "child-workflow",
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    emphasized: z.string()
  })
})
  .then(step1)
  .then(step2)
  .commit();

export const testWorkflow = createWorkflow({
  id: "test-workflow",
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    emphasized: z.string()
  })
})
  .then(childWorkflow)
  .commit();
```

### å…‹éš†å·¥ä½œæµ

å½“ä½ æƒ³é‡ç”¨å·¥ä½œæµçš„é€»è¾‘ä½†æƒ³åœ¨æ–° ID ä¸‹å•ç‹¬è·Ÿè¸ªå®ƒæ—¶ï¼Œä½¿ç”¨ `cloneWorkflow()` å…‹éš†å·¥ä½œæµã€‚æ¯ä¸ªå…‹éš†ç‹¬ç«‹è¿è¡Œï¼Œå¹¶åœ¨æ—¥å¿—å’Œå¯è§‚æµ‹æ€§å·¥å…·ä¸­æ˜¾ç¤ºä¸ºä¸åŒçš„å·¥ä½œæµã€‚

```typescript {6} title="src/mastra/workflows/test-workflow.ts"
import { cloneWorkflow } from "@mastra/core/workflows";

const step1 = createStep({...});

const parentWorkflow = createWorkflow({...})
const clonedWorkflow = cloneWorkflow(parentWorkflow, { id: "cloned-workflow" });

export const testWorkflow = createWorkflow({...})
  .then(step1)
  .then(clonedWorkflow)
  .commit();
```

## æ³¨å†Œå·¥ä½œæµ

åœ¨ Mastra å®ä¾‹ä¸­æ³¨å†Œä½ çš„å·¥ä½œæµï¼Œä½¿å…¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å¯ç”¨ã€‚ä¸€æ—¦æ³¨å†Œï¼Œå®ƒå¯ä»¥ä»ä»£ç†æˆ–å·¥å…·è°ƒç”¨ï¼Œå¹¶å¯ä»¥è®¿é—®æ—¥å¿—å’Œå¯è§‚æµ‹æ€§åŠŸèƒ½ç­‰å…±äº«èµ„æºï¼š

```typescript {5} title="src/mastra/index.ts"
import { Mastra } from "@mastra/core/mastra";
import { testWorkflow } from "./workflows/test-workflow";

export const mastra = new Mastra({
  workflows: { testWorkflow },
});
```

## å¼•ç”¨å·¥ä½œæµ

ä½ å¯ä»¥ä»ä»£ç†ã€å·¥å…·ã€Mastra å®¢æˆ·ç«¯æˆ–å‘½ä»¤è¡Œè¿è¡Œå·¥ä½œæµã€‚æ ¹æ®ä½ çš„è®¾ç½®ï¼Œé€šè¿‡åœ¨ `mastra` æˆ– `mastraClient` å®ä¾‹ä¸Šè°ƒç”¨ `.getWorkflow()` è·å–å¼•ç”¨ï¼š

```typescript
const testWorkflow = mastra.getWorkflow("testWorkflow");
```

:::info

`mastra.getWorkflow()` ä¼˜äºç›´æ¥å¯¼å…¥ï¼ŒåŸå› æœ‰äºŒï¼š
1. å®ƒæä¾›å¯¹ Mastra å®ä¾‹é…ç½®ï¼ˆè®°å½•å™¨ã€é¥æµ‹ã€å­˜å‚¨ã€å·²æ³¨å†Œçš„ä»£ç†å’Œå‘é‡å­˜å‚¨ï¼‰çš„è®¿é—®
2. å®ƒä¸ºå·¥ä½œæµè¾“å…¥å’Œè¾“å‡ºæ¨¡å¼æä¾›å®Œæ•´çš„ TypeScript ç±»å‹æ¨æ–­

**æ³¨æ„ï¼š** ä½¿ç”¨ `getWorkflow()` æ—¶ä½¿ç”¨å·¥ä½œæµçš„**æ³¨å†Œå¯†é’¥**ï¼ˆæ·»åŠ åˆ° Mastra æ—¶ä½¿ç”¨çš„å¯†é’¥ï¼‰ã€‚è™½ç„¶ `getWorkflowById()` å¯ç”¨äºé€šè¿‡ `id` å±æ€§æ£€ç´¢å·¥ä½œæµï¼Œä½†å®ƒä¸æä¾›ç›¸åŒçº§åˆ«çš„ç±»å‹æ¨æ–­ã€‚

:::

## è¿è¡Œå·¥ä½œæµ

å·¥ä½œæµå¯ä»¥ä»¥ä¸¤ç§æ¨¡å¼è¿è¡Œï¼šstart ç­‰å¾…æ‰€æœ‰æ­¥éª¤å®Œæˆåè¿”å›ï¼Œstream åœ¨æ‰§è¡ŒæœŸé—´å‘å‡ºäº‹ä»¶ã€‚é€‰æ‹©é€‚åˆä½ ç”¨ä¾‹çš„æ–¹æ³•ï¼šå½“ä½ åªéœ€è¦æœ€ç»ˆç»“æœæ—¶ä½¿ç”¨ startï¼Œå½“ä½ æƒ³ç›‘æ§è¿›åº¦æˆ–åœ¨æ­¥éª¤å®Œæˆæ—¶è§¦å‘æ“ä½œæ—¶ä½¿ç”¨ streamã€‚

<Tabs>
  <TabItem value="start" label="å¯åŠ¨">
ä½¿ç”¨ `createRun()` åˆ›å»ºå·¥ä½œæµè¿è¡Œå®ä¾‹ï¼Œç„¶åä½¿ç”¨ä¸å·¥ä½œæµ `inputSchema` åŒ¹é…çš„ `inputData` è°ƒç”¨ `.start()`ã€‚å·¥ä½œæµæ‰§è¡Œæ‰€æœ‰æ­¥éª¤å¹¶è¿”å›æœ€ç»ˆç»“æœã€‚

```typescript
const run = await testWorkflow.createRun();

const result = await run.start({
  inputData: {
    message: "Hello world"
  }
});

if (result.status === "success") {
  console.log(result.result);
}
```
  </TabItem>
  <TabItem value="stream" label="æµå¼">
ä½¿ç”¨ `.createRun()` åˆ›å»ºå·¥ä½œæµè¿è¡Œå®ä¾‹ï¼Œç„¶åä½¿ç”¨ä¸å·¥ä½œæµ `inputSchema` åŒ¹é…çš„ `inputData` è°ƒç”¨ `.stream()`ã€‚è¿­ä»£ `fullStream` ä»¥è·Ÿè¸ªè¿›åº¦ï¼Œç„¶åç­‰å¾… `result` è·å–æœ€ç»ˆå·¥ä½œæµç»“æœã€‚

```typescript
const run = await testWorkflow.createRun();

const stream = run.stream({
  inputData: {
    message: "Hello world"
  }
});

for await (const chunk of stream.fullStream) {
  console.log(chunk);
}

// è·å–æœ€ç»ˆç»“æœï¼ˆä¸ run.start() ç±»å‹ç›¸åŒï¼‰
const result = await stream.result;

if (result.status === "success") {
  console.log(result.result);
}
```
  </TabItem>
</Tabs>


### å·¥ä½œæµç»“æœç±»å‹

`run.start()` å’Œ `stream.result` éƒ½è¿”å›åŸºäº `status` å±æ€§çš„å¯è¯†åˆ«è”åˆï¼Œå¯ä»¥æ˜¯ `success`ã€`failed`ã€`suspended`ã€`tripwire` æˆ– `paused`ã€‚æ— è®ºçŠ¶æ€å¦‚ä½•ï¼Œä½ å§‹ç»ˆå¯ä»¥å®‰å…¨åœ°è®¿é—® `result.status`ã€`result.input`ã€`result.steps`ï¼Œä»¥åŠå¯é€‰çš„ `result.state`ã€‚

æ­¤å¤–ï¼Œæ ¹æ®çŠ¶æ€ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å±æ€§ï¼š

| çŠ¶æ€ | å”¯ä¸€å±æ€§ | æè¿° |
| ----------- | ------------------------------- | -------------------------------------------------------- |
| `success` | `result` | å·¥ä½œæµçš„è¾“å‡ºæ•°æ® |
| `failed` | `error` | å¯¼è‡´å¤±è´¥é”™è¯¯ |
| `tripwire` | `tripwire` | åŒ…å« `reason`ã€`retry?`ã€`metadata?`ã€`processorId?` |
| `suspended` | `suspendPayload`ã€`suspended` | æš‚åœæ•°æ®å’Œæš‚åœæ­¥éª¤è·¯å¾„æ•°ç»„ |
| `paused` | _(none)_ | åªæœ‰é€šç”¨å±æ€§å¯ç”¨ |

è¦è®¿é—®ç‰¹å®šäºçŠ¶æ€çš„å±æ€§ï¼Œè¯·å…ˆæ£€æŸ¥ `status`ï¼š

```typescript
const result = await run.start({ inputData: { message: "Hello world" } });

if (result.status === "success") {
  console.log(result.result); // ä»…åœ¨çŠ¶æ€ä¸º "success" æ—¶å¯ç”¨
} else if (result.status === "failed") {
  console.log(result.error.message);
} else if (result.status === "suspended") {
  console.log(result.suspendPayload);
}
```

### å·¥ä½œæµè¾“å‡º

ä»¥ä¸‹æ˜¯æˆåŠŸçš„å·¥ä½œæµç»“æœç¤ºä¾‹ï¼Œæ˜¾ç¤º `input`ã€`steps` å’Œ `result` å±æ€§ï¼š

```json
{
  "status": "success",
  "steps": {
    "step-1": {
      "status": "success",
      "payload": {
        "message": "Hello world"
      },
      "output": {
        "formatted": "HELLO WORLD"
      }
    },
    "step-2": {
      "status": "success",
      "payload": {
        "formatted": "HELLO WORLD"
      },
      "output": {
        "emphasized": "HELLO WORLD!!!"
      }
    }
  },
  "input": {
    "message": "Hello world"
  },
  "result": {
    "emphasized": "HELLO WORLD!!!"
  }
}
```

## é‡æ–°å¯åŠ¨è¿è¡Œä¸­çš„å·¥ä½œæµ

å½“å·¥ä½œæµè¿è¡Œä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥æ—¶ï¼Œå¯ä»¥ä»æœ€åä¸€ä¸ªæ´»åŠ¨æ­¥éª¤é‡æ–°å¯åŠ¨ã€‚è¿™å¯¹äºæœåŠ¡å™¨æ–­å¼€è¿æ¥æ—¶å¯èƒ½ä»åœ¨è¿è¡Œçš„é•¿è¿è¡Œå·¥ä½œæµå¾ˆæœ‰ç”¨ã€‚é‡æ–°å¯åŠ¨å·¥ä½œæµè¿è¡Œå°†ä»æœ€åä¸€ä¸ªæ´»åŠ¨æ­¥éª¤æ¢å¤æ‰§è¡Œï¼Œå·¥ä½œæµå°†ä»é‚£é‡Œç»§ç»­ã€‚

### ä½¿ç”¨ `restartAllActiveWorkflowRuns()` é‡æ–°å¯åŠ¨å·¥ä½œæµçš„æ‰€æœ‰æ´»åŠ¨è¿è¡Œ

ä½¿ç”¨ `restartAllActiveWorkflowRuns()` é‡æ–°å¯åŠ¨å·¥ä½œæµçš„æ‰€æœ‰æ´»åŠ¨è¿è¡Œã€‚è¿™æœ‰åŠ©äºé‡æ–°å¯åŠ¨å·¥ä½œæµçš„æ‰€æœ‰æ´»åŠ¨è¿è¡Œï¼Œè€Œæ— éœ€æ‰‹åŠ¨å¾ªç¯éå†æ¯ä¸ªè¿è¡Œå¹¶é‡æ–°å¯åŠ¨ã€‚

```typescript
workflow.restartAllActiveWorkflowRuns();
```

### ä½¿ç”¨ `restart()` é‡æ–°å¯åŠ¨æ´»åŠ¨å·¥ä½œæµè¿è¡Œ

ä½¿ç”¨ `restart()` ä»æœ€åä¸€ä¸ªæ´»åŠ¨æ­¥éª¤é‡æ–°å¯åŠ¨æ´»åŠ¨å·¥ä½œæµè¿è¡Œã€‚è¿™å°†ä»æœ€åä¸€ä¸ªæ´»åŠ¨æ­¥éª¤æ¢å¤æ‰§è¡Œï¼Œå·¥ä½œæµå°†ä»é‚£é‡Œç»§ç»­ã€‚

```typescript
const run = await workflow.createRun();

const result = await run.start({ inputData: { value: "initial data" } });

const restartedResult = await run.restart();
```

### è¯†åˆ«è¿è¡Œä¸­çš„å·¥ä½œæµ

å½“å·¥ä½œæµè¿è¡Œæ—¶ï¼Œå®ƒå°†å…·æœ‰ `running` æˆ– `waiting` çš„ `status`ã€‚ä½ å¯ä»¥æ£€æŸ¥å·¥ä½œæµçš„ `status` ä»¥ç¡®è®¤å®ƒæ­£åœ¨è¿è¡Œï¼Œå¹¶ä½¿ç”¨ `active` æ¥è¯†åˆ«è¿è¡Œä¸­çš„å·¥ä½œæµã€‚

```typescript
const activeRuns = await workflow.listActiveWorkflowRuns();
if (activeRuns.runs.length > 0) {
  console.log(activeRuns.runs);
}
```

:::note

è¿è¡Œæœ¬åœ° mastra æœåŠ¡å™¨æ—¶ï¼Œæ‰€æœ‰æ´»åŠ¨å·¥ä½œæµè¿è¡Œå°†åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨é‡æ–°å¯åŠ¨ã€‚

:::

## ä½¿ç”¨ `RequestContext`

ä½¿ç”¨ [RequestContext](/docs/cn/server/request-context) è®¿é—®ç‰¹å®šäºè¯·æ±‚çš„å€¼ã€‚è¿™è®©ä½ å¯ä»¥æ ¹æ®è¯·æ±‚çš„ä¸Šä¸‹æ–‡æœ‰æ¡ä»¶åœ°è°ƒæ•´è¡Œä¸ºã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
export type UserTier = {
  "user-tier": "enterprise" | "pro";
};

const step1 = createStep({
  execute: async ({ requestContext }) => {
    const userTier = requestContext.get("user-tier") as UserTier["user-tier"];

    const maxResults = userTier === "enterprise"
      ? 1000
      : 50;

    return { maxResults };
  }
});
```

:::info

è®¿é—®[è¯·æ±‚ä¸Šä¸‹æ–‡](/docs/cn/server/request-context)äº†è§£æ›´å¤šä¿¡æ¯ã€‚

:::

:::tip

æœ‰å…³ç±»å‹å®‰å…¨çš„è¯·æ±‚ä¸Šä¸‹æ–‡æ¨¡å¼éªŒè¯ï¼Œè¯·å‚é˜…[æ¨¡å¼éªŒè¯](/docs/cn/server/request-context#schema-validation)ã€‚

:::

## ä½¿ç”¨ Studio æµ‹è¯•

ä½¿ç”¨ [Studio](/docs/cn/getting-started/studio) è½»æ¾ä½¿ç”¨ä¸åŒè¾“å…¥è¿è¡Œå·¥ä½œæµã€å¯è§†åŒ–æ‰§è¡Œç”Ÿå‘½å‘¨æœŸã€æŸ¥çœ‹æ¯ä¸ªæ­¥éª¤çš„è¾“å…¥å’Œè¾“å‡ºï¼Œä»¥åŠæ›´è¯¦ç»†åœ°æ£€æŸ¥å·¥ä½œæµçš„æ¯ä¸ªéƒ¨åˆ†ã€‚

## ç›¸å…³å†…å®¹

è¦æ›´è¯¦ç»†åœ°äº†è§£å·¥ä½œæµï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„[å·¥ä½œæµæŒ‡å—](/guides/guide/ai-recruiter)ï¼Œå®ƒé€šè¿‡å®é™…ç¤ºä¾‹è®²è§£æ ¸å¿ƒæ¦‚å¿µã€‚

- [å·¥ä½œæµçŠ¶æ€](/docs/cn/workflows/workflow-state)
- [æ§åˆ¶æµ](/docs/cn/workflows/control-flow)
- [æš‚åœä¸æ¢å¤](/docs/cn/workflows/suspend-and-resume)
- [é”™è¯¯å¤„ç†](/docs/cn/workflows/error-handling)
