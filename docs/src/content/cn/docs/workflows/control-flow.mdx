---
title: "æ§åˆ¶æµ | å·¥ä½œæµ"
description: "Mastra å·¥ä½œæµä¸­çš„æ§åˆ¶æµå…è®¸ä½ ç®¡ç†åˆ†æ”¯ã€åˆå¹¶å’Œæ¡ä»¶ï¼Œä»¥æ„å»ºæ»¡è¶³ä½ é€»è¾‘éœ€æ±‚çš„å·¥ä½œæµã€‚"
packages:
  - "@mastra/core"
---

# æ§åˆ¶æµ

å·¥ä½œæµè¿è¡Œä¸€ç³»åˆ—é¢„å®šä¹‰ä»»åŠ¡ï¼Œä½ å¯ä»¥æ§åˆ¶è¯¥æµç¨‹çš„æ‰§è¡Œæ–¹å¼ã€‚ä»»åŠ¡è¢«åˆ†ä¸º**æ­¥éª¤**ï¼Œå¯ä»¥æ ¹æ®ä½ çš„è¦æ±‚ä»¥ä¸åŒæ–¹å¼æ‰§è¡Œã€‚å®ƒä»¬å¯ä»¥æŒ‰é¡ºåºè¿è¡Œã€å¹¶è¡Œè¿è¡Œï¼Œæˆ–æ ¹æ®æ¡ä»¶éµå¾ªä¸åŒè·¯å¾„ã€‚

æ¯ä¸ªæ­¥éª¤é€šè¿‡ä¿æŒæ•°æ®å—æ§å’Œä¸€è‡´çš„å®šä¹‰æ¨¡å¼è¿æ¥åˆ°å·¥ä½œæµä¸­çš„ä¸‹ä¸€ä¸ªæ­¥éª¤ã€‚

## æ ¸å¿ƒåŸåˆ™

- ç¬¬ä¸€ä¸ªæ­¥éª¤çš„ `inputSchema` å¿…é¡»ä¸å·¥ä½œæµçš„ `inputSchema` åŒ¹é…ã€‚
- æœ€ç»ˆæ­¥éª¤çš„ `outputSchema` å¿…é¡»ä¸å·¥ä½œæµçš„ `outputSchema` åŒ¹é…ã€‚
- æ¯ä¸ªæ­¥éª¤çš„ `outputSchema` å¿…é¡»ä¸ä¸‹ä¸€ä¸ªæ­¥éª¤çš„ `inputSchema` åŒ¹é…ã€‚
  - å¦‚æœä¸åŒ¹é…ï¼Œè¯·ä½¿ç”¨[è¾“å…¥æ•°æ®æ˜ å°„](#input-data-mapping)å°†æ•°æ®è½¬æ¢ä¸ºæ‰€éœ€çš„å½¢çŠ¶ã€‚

## ä½¿ç”¨ `.then()` é“¾æ¥æ­¥éª¤

ä½¿ç”¨ `.then()` æŒ‰é¡ºåºè¿è¡Œæ­¥éª¤ï¼Œå…è®¸æ¯ä¸ªæ­¥éª¤è®¿é—®å‰ä¸€ä¸ªæ­¥éª¤çš„ç»“æœã€‚

![ä½¿ç”¨ .then() é“¾æ¥æ­¥éª¤](/img/workflows/workflows-control-flow-then.jpg)

```typescript {27-28} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    formatted: z.string()
  })
});

const step2 = createStep({
  inputSchema: z.object({
    formatted: z.string()
  }),
  outputSchema: z.object({
    emphasized: z.string()
  })
});

export const testWorkflow = createWorkflow({
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    emphasized: z.string()
  })
})
  .then(step1)
  .then(step2)
  .commit();
```

## ä½¿ç”¨ `.parallel()` åŒæ—¶è¿è¡Œæ­¥éª¤

ä½¿ç”¨ `.parallel()` åŒæ—¶è¿è¡Œæ­¥éª¤ã€‚æ‰€æœ‰å¹¶è¡Œæ­¥éª¤å¿…é¡»åœ¨å·¥ä½œæµç»§ç»­ä¸‹ä¸€æ­¥ä¹‹å‰å®Œæˆã€‚æ¯ä¸ªæ­¥éª¤çš„ `id` åœ¨å®šä¹‰åç»­æ­¥éª¤çš„ `inputSchema` æ—¶ä½¿ç”¨ï¼Œå¹¶æˆä¸ºç”¨äºè®¿é—®å‰ä¸€ä¸ªæ­¥éª¤å€¼çš„ `inputData` å¯¹è±¡çš„é”®ã€‚å¹¶è¡Œæ­¥éª¤çš„è¾“å‡ºç„¶åå¯ä»¥ç”±åç»­æ­¥éª¤å¼•ç”¨æˆ–ç»„åˆã€‚

![ä½¿ç”¨ .parallel() å¹¶å‘æ‰§è¡Œæ­¥éª¤](/img/workflows/workflows-control-flow-parallel.jpg)

```typescript {39} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({
  id: "step-1",
});

const step2 = createStep({
  id: "step-2",
});

const step3 = createStep({
  id: "step-3",
  inputSchema: z.object({
    "step-1": z.object({
      formatted: z.string()
    }),
    "step-2": z.object({
      emphasized: z.string()
    })
  }),
  outputSchema: z.object({
    combined: z.string()
  }),
  execute: async ({ inputData }) => {
    const { formatted } = inputData["step-1"];
    const { emphasized } = inputData["step-2"];
    return {
      combined: `${formatted} | ${emphasized}`
    };
  }
});

export const testWorkflow = createWorkflow({
  inputSchema: z.object({
    message: z.string()
  }),
  outputSchema: z.object({
    combined: z.string()
  })
})
  .parallel([step1, step2])
  .then(step3)
  .commit();
```

> ğŸ“¹ è§‚çœ‹ï¼šå¦‚ä½•å¹¶è¡Œè¿è¡Œæ­¥éª¤å¹¶ä¼˜åŒ–ä½ çš„ Mastra å·¥ä½œæµ â†’ [YouTubeï¼ˆ3åˆ†é’Ÿï¼‰](https://youtu.be/GQJxve5Hki4)

### è¾“å‡ºç»“æ„

å½“æ­¥éª¤å¹¶è¡Œè¿è¡Œæ—¶ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜¯æ­¥éª¤çš„ `id`ï¼Œå€¼æ˜¯è¯¥æ­¥éª¤çš„è¾“å‡ºã€‚è¿™å…è®¸ä½ ç‹¬ç«‹è®¿é—®æ¯ä¸ªå¹¶è¡Œæ­¥éª¤çš„ç»“æœã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({
  id: "format-step",
  inputSchema: z.object({ message: z.string() }),
  outputSchema: z.object({ formatted: z.string() }),
  execute: async ({ inputData }) => ({
    formatted: inputData.message.toUpperCase()
  })
});

const step2 = createStep({
  id: "count-step",
  inputSchema: z.object({ message: z.string() }),
  outputSchema: z.object({ count: z.number() }),
  execute: async ({ inputData }) => ({
    count: inputData.message.length
  })
});

const step3 = createStep({
  id: "combine-step",
  // inputSchema å¿…é¡»åŒ¹é…å¹¶è¡Œè¾“å‡ºçš„ç»“æ„
  inputSchema: z.object({
    "format-step": z.object({ formatted: z.string() }),
    "count-step": z.object({ count: z.number() })
  }),
  outputSchema: z.object({ result: z.string() }),
  execute: async ({ inputData }) => {
    // é€šè¿‡å…¶ id è®¿é—®æ¯ä¸ªå¹¶è¡Œæ­¥éª¤çš„è¾“å‡º
    const formatted = inputData["format-step"].formatted;
    const count = inputData["count-step"].count;
    return {
      result: `${formatted} (${count} characters)`
    };
  }
});

export const testWorkflow = createWorkflow({
  id: "parallel-output-example",
  inputSchema: z.object({ message: z.string() }),
  outputSchema: z.object({ result: z.string() })
})
  .parallel([step1, step2])
  .then(step3)
  .commit();

// å½“ä½¿ç”¨ { message: "hello" } æ‰§è¡Œæ—¶
// å¹¶è¡Œè¾“å‡ºç»“æ„å°†ä¸ºï¼š
// {
//   "format-step": { formatted: "HELLO" },
//   "count-step": { count: 5 }
// }
```

**å…³é”®ç‚¹ï¼š**
- æ¯ä¸ªå¹¶è¡Œæ­¥éª¤çš„è¾“å‡ºæŒ‰å…¶ `id` ä½œä¸ºé”®
- æ‰€æœ‰å¹¶è¡Œæ­¥éª¤åŒæ—¶æ‰§è¡Œ
- ä¸‹ä¸€æ­¥æ¥æ”¶åŒ…å«æ‰€æœ‰å¹¶è¡Œæ­¥éª¤è¾“å‡ºçš„å¯¹è±¡
- ä½ å¿…é¡»å®šä¹‰åç»­æ­¥éª¤çš„ `inputSchema` ä»¥åŒ¹é…æ­¤ç»“æ„

:::info

è®¿é—®[é€‰æ‹©æ­£ç¡®çš„æ¨¡å¼](#choosing-the-right-pattern)äº†è§£ä½•æ—¶ä½¿ç”¨ `.parallel()` ä¸ `.foreach()`ã€‚

:::

## ä½¿ç”¨ `.branch()` çš„æ¡ä»¶é€»è¾‘

ä½¿ç”¨ `.branch()` æ ¹æ®æ¡ä»¶é€‰æ‹©è¦è¿è¡Œçš„æ­¥éª¤ã€‚åˆ†æ”¯ä¸­çš„æ‰€æœ‰æ­¥éª¤éœ€è¦ç›¸åŒçš„ `inputSchema` å’Œ `outputSchema`ï¼Œå› ä¸ºåˆ†æ”¯éœ€è¦ä¸€è‡´çš„æ¨¡å¼ä»¥ä¾¿å·¥ä½œæµå¯ä»¥éµå¾ªä¸åŒè·¯å¾„ã€‚

![ä½¿ç”¨ .branch() è¿›è¡Œæ¡ä»¶åˆ†æ”¯](/img/workflows/workflows-control-flow-branch.jpg)

```typescript {30-33} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...})

const stepA = createStep({
  inputSchema: z.object({
    value: z.number()
  }),
  outputSchema: z.object({
    result: z.string()
  })
});

const stepB = createStep({
  inputSchema: z.object({
    value: z.number()
  }),
  outputSchema: z.object({
    result: z.string()
  })
});

export const testWorkflow = createWorkflow({
  inputSchema: z.object({
    value: z.number()
  }),
  outputSchema: z.object({
    result: z.string()
  })
})
  .then(step1)
  .branch([
    [async ({ inputData: { value } }) => value > 10, stepA],
    [async ({ inputData: { value } }) => value <= 10, stepB]
  ])
  .commit();
```

### è¾“å‡ºç»“æ„

ä½¿ç”¨æ¡ä»¶åˆ†æ”¯æ—¶ï¼Œåªæœ‰åŸºäºç¬¬ä¸€ä¸ªæ±‚å€¼ä¸º `true` çš„æ¡ä»¶çš„åˆ†æ”¯æ‰§è¡Œã€‚è¾“å‡ºç»“æ„ä¸ `.parallel()` ç±»ä¼¼ï¼Œå…¶ä¸­ç»“æœæŒ‰æ‰§è¡Œçš„æ­¥éª¤çš„ `id` ä½œä¸ºé”®ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({
  id: "initial-step",
  inputSchema: z.object({ value: z.number() }),
  outputSchema: z.object({ value: z.number() }),
  execute: async ({ inputData }) => inputData
});

const highValueStep = createStep({
  id: "high-value-step",
  inputSchema: z.object({ value: z.number() }),
  outputSchema: z.object({ result: z.string() }),
  execute: async ({ inputData }) => ({
    result: `High value: ${inputData.value}`
  })
});

const lowValueStep = createStep({
  id: "low-value-step",
  inputSchema: z.object({ value: z.number() }),
  outputSchema: z.object({ result: z.string() }),
  execute: async ({ inputData }) => ({
    result: `Low value: ${inputData.value}`
  })
});

const finalStep = createStep({
  id: "final-step",
  // inputSchema å¿…é¡»è€ƒè™‘ä»»ä¸€åˆ†æ”¯çš„è¾“å‡º
  inputSchema: z.object({
    "high-value-step": z.object({ result: z.string() }).optional(),
    "low-value-step": z.object({ result: z.string() }).optional()
  }),
  outputSchema: z.object({ message: z.string() }),
  execute: async ({ inputData }) => {
    // åªæœ‰ä¸€ä¸ªåˆ†æ”¯ä¼šæ‰§è¡Œ
    const result = inputData["high-value-step"]?.result ||
                   inputData["low-value-step"]?.result;
    return { message: result };
  }
});

export const testWorkflow = createWorkflow({
  id: "branch-output-example",
  inputSchema: z.object({ value: z.number() }),
  outputSchema: z.object({ message: z.string() })
})
  .then(step1)
  .branch([
    [async ({ inputData }) => inputData.value > 10, highValueStep],
    [async ({ inputData }) => inputData.value <= 10, lowValueStep]
  ])
  .then(finalStep)
  .commit();

// å½“ä½¿ç”¨ { value: 15 } æ‰§è¡Œæ—¶
// åªæœ‰ high-value-step æ‰§è¡Œï¼Œè¾“å‡ºç»“æ„ï¼š
// {
//   "high-value-step": { result: "High value: 15" }
// }

// å½“ä½¿ç”¨ { value: 5 } æ‰§è¡Œæ—¶
// åªæœ‰ low-value-step æ‰§è¡Œï¼Œè¾“å‡ºç»“æ„ï¼š
// {
//   "low-value-step": { result: "Low value: 5" }
// }
```

**å…³é”®ç‚¹ï¼š**
- åªæœ‰ä¸€ä¸ªåˆ†æ”¯åŸºäºæ¡ä»¶æ±‚å€¼é¡ºåºæ‰§è¡Œ
- è¾“å‡ºæŒ‰æ‰§è¡Œçš„æ­¥éª¤çš„ `id` ä½œä¸ºé”®
- åç»­æ­¥éª¤åº”å¤„ç†æ‰€æœ‰å¯èƒ½çš„åˆ†æ”¯è¾“å‡º
- å½“ä¸‹ä¸€æ­¥éœ€è¦å¤„ç†å¤šä¸ªå¯èƒ½çš„åˆ†æ”¯æ—¶ï¼Œåœ¨ `inputSchema` ä¸­ä½¿ç”¨å¯é€‰å­—æ®µ
- æ¡ä»¶æŒ‰å®šä¹‰çš„é¡ºåºæ±‚å€¼

## è¾“å…¥æ•°æ®æ˜ å°„

ä½¿ç”¨ `.then()`ã€`.parallel()` æˆ– `.branch()` æ—¶ï¼Œæœ‰æ—¶éœ€è¦è½¬æ¢å‰ä¸€ä¸ªæ­¥éª¤çš„è¾“å‡ºä»¥åŒ¹é…ä¸‹ä¸€ä¸ªæ­¥éª¤çš„è¾“å…¥ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ `.map()` è®¿é—® `inputData` å¹¶å°†å…¶è½¬æ¢ï¼Œä¸ºä¸‹ä¸€æ­¥åˆ›å»ºåˆé€‚çš„æ•°æ®å½¢çŠ¶ã€‚

![ä½¿ç”¨ .map() æ˜ å°„](/img/workflows/workflows-data-mapping-map.jpg)

```typescript {9} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...});
const step2 = createStep({...});

export const testWorkflow = createWorkflow({...})
  .then(step1)
  .map(async ({ inputData }) => {
    const { foo } = inputData;
    return {
      bar: `new ${foo}`,
    };
  })
  .then(step2)
  .commit();
```

`.map()` æ–¹æ³•ä¸ºæ›´å¤æ‚çš„æ˜ å°„åœºæ™¯æä¾›äº†é¢å¤–çš„è¾…åŠ©å‡½æ•°ã€‚

**å¯ç”¨çš„è¾…åŠ©å‡½æ•°ï¼š**

- [`getStepResult()`](/reference/workflows/workflow-methods/map#using-getstepresult)ï¼šè®¿é—®ç‰¹å®šæ­¥éª¤çš„å®Œæ•´è¾“å‡º
- [`getInitData<any>()`](/reference/workflows/workflow-methods/map#using-getinitdata)ï¼šè®¿é—®å·¥ä½œæµçš„åˆå§‹è¾“å…¥æ•°æ®
- [`mapVariable()`](/reference/workflows/workflow-methods/map#using-mapvariable)ï¼šä½¿ç”¨å£°æ˜å¼å¯¹è±¡è¯­æ³•æå–å’Œé‡å‘½åå­—æ®µ

### å¹¶è¡Œå’Œåˆ†æ”¯è¾“å‡º

ä½¿ç”¨ `.parallel()` æˆ– `.branch()` è¾“å‡ºæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ `.map()` åœ¨å°†æ•°æ®ä¼ é€’ç»™ä¸‹ä¸€æ­¥ä¹‹å‰è½¬æ¢æ•°æ®ç»“æ„ã€‚å½“ä½ éœ€è¦æ‰å¹³åŒ–æˆ–é‡ç»„è¾“å‡ºæ—¶ï¼Œè¿™ç‰¹åˆ«æœ‰ç”¨ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
export const testWorkflow = createWorkflow({...})
  .parallel([step1, step2])
  .map(async ({ inputData }) => {
    // è½¬æ¢å¹¶è¡Œè¾“å‡ºç»“æ„
    return {
      combined: `${inputData["step1"].value} - ${inputData["step2"].value}`
    };
  })
  .then(nextStep)
  .commit();
```

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `.map()` æä¾›çš„è¾…åŠ©å‡½æ•°ï¼š

```typescript title="src/mastra/workflows/test-workflow.ts"
export const testWorkflow = createWorkflow({...})
  .branch([
    [condition1, stepA],
    [condition2, stepB]
  ])
  .map(async ({ inputData, getStepResult }) => {
    // è®¿é—®ç‰¹å®šæ­¥éª¤ç»“æœ
    const stepAResult = getStepResult("stepA");
    const stepBResult = getStepResult("stepB");

    // è¿”å›æ‰§è¡Œçš„åˆ†æ”¯çš„ç»“æœ
    return stepAResult || stepBResult;
  })
  .then(nextStep)
  .commit();
```

## å¾ªç¯æ­¥éª¤

å·¥ä½œæµæ”¯æŒä¸åŒçš„å¾ªç¯æ–¹æ³•ï¼Œè®©ä½ é‡å¤æ­¥éª¤ç›´åˆ°æˆ–å½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œæˆ–éå†æ•°ç»„ã€‚å¾ªç¯å¯ä»¥ä¸å…¶ä»–æ§åˆ¶æ–¹æ³•å¦‚ `.then()` ç»„åˆã€‚

### ä½¿ç”¨ `.dountil()` å¾ªç¯

ä½¿ç”¨ `.dountil()` é‡å¤è¿è¡Œæ­¥éª¤ç›´åˆ°æ¡ä»¶å˜ä¸º trueã€‚

![ä½¿ç”¨ .dountil() é‡å¤](/img/workflows/workflows-control-flow-dountil.jpg)

```typescript {14} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...});

const step2 = createStep({
  execute: async ({ inputData }) => {
    const { number } = inputData;
    return {
      number: number + 1
    };
  }
});

export const testWorkflow = createWorkflow({})
  .then(step1)
  .dountil(step2, async ({ inputData: { number } }) => number > 10)
  .commit();
```

### ä½¿ç”¨ `.dowhile()` å¾ªç¯

ä½¿ç”¨ `.dowhile()` åœ¨æ¡ä»¶ä¿æŒä¸º true æ—¶é‡å¤è¿è¡Œæ­¥éª¤ã€‚

![ä½¿ç”¨ .dowhile() é‡å¤](/img/workflows/workflows-control-flow-dowhile.jpg)

```typescript {14} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...});

const step2 = createStep({
  execute: async ({ inputData }) => {
    const { number } = inputData;
    return {
      number: number + 1
    };
  }
});

export const testWorkflow = createWorkflow({})
  .then(step1)
  .dowhile(step2, async ({ inputData: { number } }) => number < 10)
  .commit();
```

### ä½¿ç”¨ `.foreach()` å¾ªç¯

ä½¿ç”¨ `.foreach()` å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ç›®è¿è¡Œç›¸åŒçš„æ­¥éª¤ã€‚è¾“å…¥å¿…é¡»æ˜¯ `array` ç±»å‹ï¼Œä»¥ä¾¿å¾ªç¯å¯ä»¥éå†å…¶å€¼ï¼Œå°†æ­¥éª¤çš„é€»è¾‘åº”ç”¨äºæ¯ä¸ªå€¼ã€‚å…³äºä½•æ—¶ä½¿ç”¨ `.foreach()` ä¸å…¶ä»–æ–¹æ³•ï¼Œè¯·å‚é˜…[é€‰æ‹©æ­£ç¡®çš„æ¨¡å¼](#choosing-the-right-pattern)ã€‚

![ä½¿ç”¨ .foreach() é‡å¤](/img/workflows/workflows-control-flow-foreach.jpg)

```typescript {15} title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({
  inputSchema: z.string(),
  outputSchema: z.string(),
  execute: async ({ inputData }) => {
    return inputData.toUpperCase();
  }
});

const step2 = createStep({...});

export const testWorkflow = createWorkflow({
  inputSchema: z.array(z.string()),
  outputSchema: z.array(z.string())
})
  .foreach(step1)
  .then(step2)
  .commit();
```

#### è¾“å‡ºç»“æ„

`.foreach()` æ–¹æ³•æ€»æ˜¯è¿”å›ä¸€ä¸ªåŒ…å«æ¯æ¬¡è¿­ä»£è¾“å‡ºçš„æ•°ç»„ã€‚è¾“å‡ºçš„é¡ºåºä¸è¾“å…¥çš„é¡ºåºåŒ¹é…ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const addTenStep = createStep({
  id: "add-ten",
  inputSchema: z.object({ value: z.number() }),
  outputSchema: z.object({ value: z.number() }),
  execute: async ({ inputData }) => ({
    value: inputData.value + 10
  })
});

export const testWorkflow = createWorkflow({
  id: "foreach-output-example",
  inputSchema: z.array(z.object({ value: z.number() })),
  outputSchema: z.array(z.object({ value: z.number() }))
})
  .foreach(addTenStep)
  .commit();

// å½“ä½¿ç”¨ [{ value: 1 }, { value: 22 }, { value: 333 }] æ‰§è¡Œæ—¶
// è¾“å‡º: [{ value: 11 }, { value: 32 }, { value: 343 }]
```

#### å¹¶å‘é™åˆ¶

ä½¿ç”¨ `concurrency` æ§åˆ¶åŒæ—¶å¤„ç†çš„æ•°ç»„é¡¹æ•°é‡ã€‚é»˜è®¤å€¼ä¸º `1`ï¼Œå³é¡ºåºè¿è¡Œæ­¥éª¤ã€‚å¢åŠ è¯¥å€¼å…è®¸ `.foreach()` åŒæ—¶å¤„ç†å¤šä¸ªé¡¹ç›®ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...})

export const testWorkflow = createWorkflow({...})
  .foreach(step1, { concurrency: 4 })
  .commit();
```

#### åœ¨ `.foreach()` ä¹‹åèšåˆç»“æœ

ç”±äº `.foreach()` è¾“å‡ºä¸€ä¸ªæ•°ç»„ï¼Œä½ å¯ä»¥ä½¿ç”¨ `.then()` æˆ– `.map()` èšåˆæˆ–è½¬æ¢ç»“æœã€‚`.foreach()` ä¹‹åçš„æ­¥éª¤å°†æ•´ä¸ªæ•°ç»„ä½œä¸ºå…¶è¾“å…¥ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const processItemStep = createStep({
  id: "process-item",
  inputSchema: z.object({ value: z.number() }),
  outputSchema: z.object({ processed: z.number() }),
  execute: async ({ inputData }) => ({
    processed: inputData.value * 2
  })
});

const aggregateStep = createStep({
  id: "aggregate",
  // è¾“å…¥æ˜¯æ¥è‡ª foreach çš„è¾“å‡ºæ•°ç»„
  inputSchema: z.array(z.object({ processed: z.number() })),
  outputSchema: z.object({ total: z.number() }),
  execute: async ({ inputData }) => ({
    // å¯¹æ‰€æœ‰å¤„ç†åçš„å€¼æ±‚å’Œ
    total: inputData.reduce((sum, item) => sum + item.processed, 0)
  })
});

export const testWorkflow = createWorkflow({
  id: "foreach-aggregate-example",
  inputSchema: z.array(z.object({ value: z.number() })),
  outputSchema: z.object({ total: z.number() })
})
  .foreach(processItemStep)
  .then(aggregateStep)  // æ¥æ”¶æ¥è‡ª foreach çš„å®Œæ•´æ•°ç»„
  .commit();

// å½“ä½¿ç”¨ [{ value: 1 }, { value: 2 }, { value: 3 }] æ‰§è¡Œæ—¶
// foreach ä¹‹å: [{ processed: 2 }, { processed: 4 }, { processed: 6 }]
// aggregate ä¹‹å: { total: 12 }
```

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `.map()` è½¬æ¢æ•°ç»„è¾“å‡ºï¼š

```typescript title="src/mastra/workflows/test-workflow.ts"
export const testWorkflow = createWorkflow({...})
  .foreach(processItemStep)
  .map(async ({ inputData }) => ({
    // å°†æ•°ç»„è½¬æ¢ä¸ºä¸åŒçš„ç»“æ„
    values: inputData.map(item => item.processed),
    count: inputData.length
  }))
  .then(nextStep)
  .commit();
```

#### é“¾æ¥å¤šä¸ª `.foreach()` è°ƒç”¨

å½“ä½ é“¾æ¥ `.foreach()` è°ƒç”¨æ—¶ï¼Œæ¯ä¸ªè°ƒç”¨å¯¹å‰ä¸€ä¸ªæ­¥éª¤çš„æ•°ç»„è¾“å‡ºè¿›è¡Œæ“ä½œã€‚å½“æ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ç›®éœ€è¦æŒ‰é¡ºåºç”±å¤šä¸ªæ­¥éª¤è½¬æ¢æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const chunkStep = createStep({
  id: "chunk",
  // æ¥æ”¶æ–‡æ¡£ï¼Œè¿”å›åˆ†å—æ•°ç»„
  inputSchema: z.object({ content: z.string() }),
  outputSchema: z.array(z.object({ chunk: z.string() })),
  execute: async ({ inputData }) => {
    // å°†æ–‡æ¡£åˆ†å‰²æˆå—
    const chunks = inputData.content.match(/.{1,100}/g) || [];
    return chunks.map(chunk => ({ chunk }));
  }
});

const embedStep = createStep({
  id: "embed",
  // æ¥æ”¶å•ä¸ªåˆ†å—ï¼Œè¿”å›åµŒå…¥å‘é‡
  inputSchema: z.object({ chunk: z.string() }),
  outputSchema: z.object({ embedding: z.array(z.number()) }),
  execute: async ({ inputData }) => ({
    embedding: [/* å‘é‡åµŒå…¥ */]
  })
});

// å¯¹äºç”Ÿæˆå¤šä¸ªåˆ†å—çš„å•ä¸ªæ–‡æ¡£ï¼š
export const singleDocWorkflow = createWorkflow({
  id: "single-doc-rag",
  inputSchema: z.object({ content: z.string() }),
  outputSchema: z.array(z.object({ embedding: z.array(z.number()) }))
})
  .then(chunkStep)      // è¿”å›åˆ†å—æ•°ç»„
  .foreach(embedStep)   // å¤„ç†æ¯ä¸ªåˆ†å— -> åµŒå…¥å‘é‡æ•°ç»„
  .commit();
```

å¯¹äºå¤„ç†æ¯ä¸ªç”Ÿæˆå¤šä¸ªåˆ†å—çš„å¤šä¸ªæ–‡æ¡£ï¼Œä½ æœ‰ä»¥ä¸‹é€‰é¡¹ï¼š

**é€‰é¡¹ 1ï¼šåœ¨å•ä¸ªæ­¥éª¤ä¸­å¤„ç†æ‰€æœ‰æ–‡æ¡£å¹¶æ§åˆ¶æ‰¹å¤„ç†**

```typescript title="src/mastra/workflows/test-workflow.ts"
const downloadAndChunkStep = createStep({
  id: "download-and-chunk",
  inputSchema: z.array(z.string()),  // URL æ•°ç»„
  outputSchema: z.array(z.object({ chunk: z.string(), source: z.string() })),
  execute: async ({ inputData: urls }) => {
    // åœ¨æ­¥éª¤å†…æ§åˆ¶æ‰¹å¤„ç†/å¹¶è¡ŒåŒ–
    const allChunks = [];
    for (const url of urls) {
      const content = await fetch(url).then(r => r.text());
      const chunks = content.match(/.{1,100}/g) || [];
      allChunks.push(...chunks.map(chunk => ({ chunk, source: url })));
    }
    return allChunks;
  }
});

export const multiDocWorkflow = createWorkflow({...})
  .then(downloadAndChunkStep)  // è¿”å›æ‰€æœ‰åˆ†å—çš„æ‰å¹³æ•°ç»„
  .foreach(embedStep, { concurrency: 10 })  // å¹¶è¡ŒåµŒå…¥æ¯ä¸ªåˆ†å—
  .commit();
```

**é€‰é¡¹ 2ï¼šå¯¹æ–‡æ¡£ä½¿ç”¨ foreachï¼Œèšåˆåˆ†å—ï¼Œç„¶åå¯¹åµŒå…¥å‘é‡ä½¿ç”¨ foreach**

```typescript title="src/mastra/workflows/test-workflow.ts"
const downloadStep = createStep({
  id: "download",
  inputSchema: z.string(),  // å•ä¸ª URL
  outputSchema: z.object({ content: z.string(), source: z.string() }),
  execute: async ({ inputData: url }) => ({
    content: await fetch(url).then(r => r.text()),
    source: url
  })
});

const chunkDocStep = createStep({
  id: "chunk-doc",
  inputSchema: z.object({ content: z.string(), source: z.string() }),
  outputSchema: z.array(z.object({ chunk: z.string(), source: z.string() })),
  execute: async ({ inputData }) => {
    const chunks = inputData.content.match(/.{1,100}/g) || [];
    return chunks.map(chunk => ({ chunk, source: inputData.source }));
  }
});

export const multiDocWorkflow = createWorkflow({
  id: "multi-doc-rag",
  inputSchema: z.array(z.string()),  // URL æ•°ç»„
  outputSchema: z.array(z.object({ embedding: z.array(z.number()) }))
})
  .foreach(downloadStep, { concurrency: 5 })  // å¹¶è¡Œä¸‹è½½æ–‡æ¡£
  .foreach(chunkDocStep)  // å¯¹æ¯ä¸ªæ–‡æ¡£åˆ†å— -> åˆ†å—æ•°ç»„æ•°ç»„
  .map(async ({ inputData }) => {
    // æ‰å¹³åŒ–åµŒå¥—æ•°ç»„ï¼š[[åˆ†å—], [åˆ†å—]] -> [åˆ†å—]
    return inputData.flat();
  })
  .foreach(embedStep, { concurrency: 10 })  // åµŒå…¥æ‰€æœ‰åˆ†å—
  .commit();
```

**å…³äºé“¾æ¥ `.foreach()` çš„å…³é”®ç‚¹ï¼š**
- æ¯ä¸ª `.foreach()` å¯¹å‰ä¸€ä¸ªæ­¥éª¤çš„æ•°ç»„è¿›è¡Œæ“ä½œ
- å¦‚æœ `.foreach()` å†…çš„æ­¥éª¤è¿”å›æ•°ç»„ï¼Œè¾“å‡ºå˜ä¸ºæ•°ç»„çš„æ•°ç»„
- éœ€è¦æ—¶ä½¿ç”¨å¸¦æœ‰ `.flat()` çš„ `.map()` æ‰å¹³åŒ–åµŒå¥—æ•°ç»„
- å¯¹äºå¤æ‚çš„ RAG ç®¡é“ï¼Œé€‰é¡¹ 1ï¼ˆåœ¨å•ä¸ªæ­¥éª¤ä¸­å¤„ç†æ‰¹å¤„ç†ï¼‰é€šå¸¸æä¾›æ›´å¥½çš„æ§åˆ¶

#### foreach å†…çš„åµŒå¥—å·¥ä½œæµ

`.foreach()` ä¹‹åçš„æ­¥éª¤ä»…åœ¨æ‰€æœ‰è¿­ä»£å®Œæˆåæ‰æ‰§è¡Œã€‚å¦‚æœæ¯ä¸ªé¡¹ç›®éœ€è¦è¿è¡Œå¤šä¸ªé¡ºåºæ“ä½œï¼Œè¯·ä½¿ç”¨åµŒå¥—å·¥ä½œæµè€Œä¸æ˜¯é“¾æ¥å¤šä¸ª `.foreach()` è°ƒç”¨ã€‚è¿™ä½¿æ¯ä¸ªé¡¹ç›®çš„æ‰€æœ‰æ“ä½œä¿æŒåœ¨ä¸€èµ·ï¼Œå¹¶ä½¿æ•°æ®æµæ›´æ¸…æ™°ã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
// å®šä¹‰å¤„ç†å•ä¸ªæ–‡æ¡£çš„å·¥ä½œæµ
const processDocumentWorkflow = createWorkflow({
  id: "process-document",
  inputSchema: z.object({ url: z.string() }),
  outputSchema: z.object({
    embeddings: z.array(z.array(z.number())),
    metadata: z.object({ url: z.string(), chunkCount: z.number() })
  })
})
  .then(downloadStep)      // ä¸‹è½½æ–‡æ¡£
  .then(chunkStep)         // åˆ†å‰²æˆå—
  .then(embedChunksStep)   // åµŒå…¥è¯¥æ–‡æ¡£çš„æ‰€æœ‰å—
  .then(formatResultStep)  // æ ¼å¼åŒ–æœ€ç»ˆè¾“å‡º
  .commit();

// åœ¨ foreach å†…ä½¿ç”¨åµŒå¥—å·¥ä½œæµ
export const batchProcessWorkflow = createWorkflow({
  id: "batch-process-documents",
  inputSchema: z.array(z.object({ url: z.string() })),
  outputSchema: z.array(z.object({
    embeddings: z.array(z.array(z.number())),
    metadata: z.object({ url: z.string(), chunkCount: z.number() })
  }))
})
  .foreach(processDocumentWorkflow, { concurrency: 3 })
  .commit();

// æ¯ä¸ªæ–‡æ¡£åœ¨ä¸‹ä¸€ä¸ªæ–‡æ¡£å¼€å§‹ä¹‹å‰å®Œæˆæ‰€æœ‰ 4 ä¸ªæ­¥éª¤ï¼ˆconcurrency: 1 æ—¶ï¼‰
// ä½¿ç”¨ concurrency: 3ï¼Œå¤šè¾¾ 3 ä¸ªæ–‡æ¡£åŒæ—¶å¤„ç†å…¶å®Œæ•´ç®¡é“
```

**ä¸ºä»€ä¹ˆä½¿ç”¨åµŒå¥—å·¥ä½œæµï¼š**
- **æ›´å¥½çš„å¹¶è¡Œæ€§**ï¼šä½¿ç”¨ `concurrency: N`ï¼Œå¤šä¸ªé¡¹ç›®åŒæ—¶è¿è¡Œå…¶å®Œæ•´ç®¡é“ã€‚é“¾æ¥çš„ `.foreach().foreach()` å¤„ç†æ‰€æœ‰é¡¹ç›®çš„æ­¥éª¤ 1ï¼Œç­‰å¾…ï¼Œç„¶åæ‰€æœ‰é¡¹ç›®çš„æ­¥éª¤ 2 - åµŒå¥—å·¥ä½œæµè®©æ¯ä¸ªé¡¹ç›®ç‹¬ç«‹è¿›å±•
- ä¸€ä¸ªé¡¹ç›®çš„æ‰€æœ‰æ­¥éª¤åœ¨æ”¶é›†ç»“æœä¹‹å‰ä¸€èµ·å®Œæˆ
- æ¯”åˆ›å»ºåµŒå¥—æ•°ç»„çš„å¤šä¸ª `.foreach()` è°ƒç”¨æ›´ç®€æ´
- æ¯ä¸ªåµŒå¥—å·¥ä½œæµæ‰§è¡Œæ˜¯ç‹¬ç«‹çš„ï¼Œæœ‰è‡ªå·±çš„æ•°æ®æµ
- æ›´å®¹æ˜“å•ç‹¬æµ‹è¯•å’Œé‡ç”¨æ¯ä¸ªé¡¹ç›®çš„é€»è¾‘

**å®ƒå¦‚ä½•å·¥ä½œï¼š**
1. çˆ¶å·¥ä½œæµå°†æ¯ä¸ªæ•°ç»„é¡¹ä¼ é€’ç»™åµŒå¥—å·¥ä½œæµçš„ä¸€ä¸ªå®ä¾‹
2. æ¯ä¸ªåµŒå¥—å·¥ä½œæµä¸ºè¯¥é¡¹ç›®è¿è¡Œå…¶å®Œæ•´æ­¥éª¤åºåˆ—
3. ä½¿ç”¨ `concurrency > 1`ï¼Œå¤šä¸ªåµŒå¥—å·¥ä½œæµå¹¶è¡Œæ‰§è¡Œ
4. åµŒå¥—å·¥ä½œæµçš„æœ€ç»ˆè¾“å‡ºæˆä¸ºç»“æœæ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ 
5. æ‰€æœ‰åµŒå¥—å·¥ä½œæµå®Œæˆåï¼Œçˆ¶å·¥ä½œæµä¸­çš„ä¸‹ä¸€æ­¥æ¥æ”¶å®Œæ•´æ•°ç»„

## é€‰æ‹©æ­£ç¡®çš„æ¨¡å¼

ä½¿ç”¨æœ¬èŠ‚ä½œä¸ºé€‰æ‹©é€‚å½“æ§åˆ¶æµæ–¹æ³•çš„å‚è€ƒã€‚

### å¿«é€Ÿå‚è€ƒ

| æ–¹æ³• | ç”¨é€” | è¾“å…¥ | è¾“å‡º | å¹¶å‘ |
|--------|---------|-------|--------|-------------|
| `.then(step)` | é¡ºåºå¤„ç† | `T` | `U` | N/Aï¼ˆä¸€æ¬¡ä¸€ä¸ªï¼‰ |
| `.parallel([a, b])` | å¯¹ç›¸åŒè¾“å…¥çš„ä¸åŒæ“ä½œ | `T` | `{ a: U, b: V }` | åŒæ—¶è¿è¡Œ |
| `.foreach(step)` | å¯¹æ¯ä¸ªæ•°ç»„é¡¹çš„ç›¸åŒæ“ä½œ | `T[]` | `U[]` | å¯é…ç½®ï¼ˆé»˜è®¤ï¼š1ï¼‰ |
| `.branch([...])` | æ¡ä»¶è·¯å¾„é€‰æ‹© | `T` | `{ selectedStep: U }` | åªæœ‰ä¸€ä¸ªåˆ†æ”¯è¿è¡Œ |

### `.parallel()` vs `.foreach()`

**å½“ä½ æœ‰ä¸€ä¸ªéœ€è¦ä¸åŒå¤„ç†çš„è¾“å…¥æ—¶ä½¿ç”¨ `.parallel()`ï¼š**

```typescript
// ç›¸åŒçš„ç”¨æˆ·æ•°æ®ä»¥ä¸åŒæ–¹å¼å¹¶è¡Œå¤„ç†
workflow
  .parallel([validateStep, enrichStep, scoreStep])
  .then(combineResultsStep)
```

**å½“ä½ æœ‰è®¸å¤šéœ€è¦ç›¸åŒå¤„ç†çš„è¾“å…¥æ—¶ä½¿ç”¨ `.foreach()`ï¼š**

```typescript
// å¤šä¸ª URL æ¯ä¸ªä»¥ç›¸åŒæ–¹å¼å¤„ç†
workflow
  .foreach(downloadStep, { concurrency: 5 })
  .then(aggregateStep)
```

### ä½•æ—¶ä½¿ç”¨åµŒå¥—å·¥ä½œæµ

**åœ¨ `.foreach()` å†…éƒ¨** - å½“æ¯ä¸ªæ•°ç»„é¡¹éœ€è¦å¤šä¸ªé¡ºåºæ­¥éª¤æ—¶ï¼š

```typescript
// æ¯ä¸ªæ–‡æ¡£ç»å†å®Œæ•´ç®¡é“
const processDocWorkflow = createWorkflow({...})
  .then(downloadStep)
  .then(parseStep)
  .then(embedStep)
  .commit();

workflow.foreach(processDocWorkflow, { concurrency: 3 })
```

è¿™æ¯”é“¾æ¥ `.foreach().foreach()` æ›´ç®€æ´ï¼Œåè€…ä¼šåˆ›å»ºåµŒå¥—æ•°ç»„ã€‚

**åœ¨ `.parallel()` å†…éƒ¨** - å½“å¹¶è¡Œåˆ†æ”¯éœ€è¦è‡ªå·±çš„å¤šæ­¥éª¤ç®¡é“æ—¶ï¼š

```typescript
const pipelineA = createWorkflow({...}).then(step1).then(step2).commit();
const pipelineB = createWorkflow({...}).then(step3).then(step4).commit();

workflow.parallel([pipelineA, pipelineB])
```

### é“¾æ¥æ¨¡å¼

| æ¨¡å¼ | å‘ç”Ÿä»€ä¹ˆ | å¸¸è§ç”¨ä¾‹ |
|---------|--------------|----------------|
| `.then().then()` | é¡ºåºæ­¥éª¤ | ç®€å•ç®¡é“ |
| `.parallel().then()` | å¹¶è¡Œè¿è¡Œï¼Œç„¶åç»„åˆ | æ‰‡å‡º/æ‰‡å…¥ |
| `.foreach().then()` | å¤„ç†æ‰€æœ‰é¡¹ï¼Œç„¶åèšåˆ | Map-reduce |
| `.foreach().foreach()` | åˆ›å»ºæ•°ç»„çš„æ•°ç»„ | é¿å… - ä½¿ç”¨åµŒå¥—å·¥ä½œæµæˆ–å¸¦æœ‰ `.flat()` çš„ `.map()` |
| `.foreach(workflow)` | æ¯ä¸ªé¡¹ç›®çš„å®Œæ•´ç®¡é“ | æ¯ä¸ªæ•°ç»„é¡¹çš„å¤šæ­¥éª¤å¤„ç† |

### åŒæ­¥ï¼šä¸‹ä¸€æ­¥ä½•æ—¶è¿è¡Œ

`.parallel()` å’Œ `.foreach()` éƒ½æ˜¯åŒæ­¥ç‚¹ã€‚å·¥ä½œæµä¸­çš„ä¸‹ä¸€æ­¥ä»…åœ¨æ‰€æœ‰å¹¶è¡Œåˆ†æ”¯æˆ–æ‰€æœ‰æ•°ç»„è¿­ä»£å®Œæˆåæ‰æ‰§è¡Œã€‚

```typescript
workflow
  .parallel([stepA, stepB, stepC])  // æ‰€æœ‰ 3 ä¸ªåŒæ—¶è¿è¡Œ
  .then(combineStep)                // ç­‰å¾…æ‰€æœ‰ 3 ä¸ªå®Œæˆåæ‰è¿è¡Œ
  .commit();

workflow
  .foreach(processStep, { concurrency: 5 })  // æœ€å¤š 5 ä¸ªé¡¹ç›®åŒæ—¶å¤„ç†
  .then(aggregateStep)                       // ç­‰å¾…æ‰€æœ‰é¡¹ç›®å®Œæˆåæ‰è¿è¡Œ
  .commit();
```

è¿™æ„å‘³ç€ï¼š
- `.parallel()` å°†æ‰€æœ‰åˆ†æ”¯è¾“å‡ºæ”¶é›†åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œç„¶åä¼ é€’ç»™ä¸‹ä¸€æ­¥
- `.foreach()` å°†æ‰€æœ‰è¿­ä»£è¾“å‡ºæ”¶é›†åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åä¼ é€’ç»™ä¸‹ä¸€æ­¥
- æ— æ³•åœ¨å®ƒä»¬å®Œæˆæ—¶"æµå¼"ç»“æœåˆ°ä¸‹ä¸€æ­¥

### å¹¶å‘è¡Œä¸º

| æ–¹æ³• | è¡Œä¸º |
|--------|----------|
| `.then()` | é¡ºåº - ä¸€æ¬¡ä¸€ä¸ªæ­¥éª¤ |
| `.parallel()` | æ‰€æœ‰åˆ†æ”¯åŒæ—¶è¿è¡Œï¼ˆæ— é™åˆ¶é€‰é¡¹ï¼‰ |
| `.foreach()` | é€šè¿‡ `{ concurrency: N }` æ§åˆ¶ - é»˜è®¤æ˜¯ 1ï¼ˆé¡ºåºï¼‰ |
| `.foreach()` ä¸­çš„åµŒå¥—å·¥ä½œæµ | å°Šé‡çˆ¶çº§çš„å¹¶å‘è®¾ç½® |

**æ€§èƒ½æç¤ºï¼š** å¯¹äº `.foreach()` ä¸­çš„ I/O ç»‘å®šæ“ä½œï¼Œå¢åŠ å¹¶å‘ä»¥å¹¶è¡Œå¤„ç†é¡¹ç›®ï¼š

```typescript
// æœ€å¤šåŒæ—¶å¤„ç† 10 ä¸ªé¡¹ç›®
workflow.foreach(fetchDataStep, { concurrency: 10 })
```

## å¾ªç¯ç®¡ç†

æ ¹æ®ä½ å¸Œæœ›å¾ªç¯ç»“æŸçš„æ–¹å¼ï¼Œå¯ä»¥ä¸åŒæ–¹å¼å®ç°å¾ªç¯æ¡ä»¶ã€‚å¸¸è§æ¨¡å¼åŒ…æ‹¬æ£€æŸ¥ `inputData` ä¸­è¿”å›çš„å€¼ã€è®¾ç½®æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œæˆ–åœ¨è¾¾åˆ°é™åˆ¶æ—¶ä¸­æ­¢æ‰§è¡Œã€‚

### ä¸­æ­¢å¾ªç¯

ä½¿ç”¨ `iterationCount` é™åˆ¶å¾ªç¯è¿è¡Œæ¬¡æ•°ã€‚å¦‚æœè®¡æ•°è¶…è¿‡ä½ çš„é˜ˆå€¼ï¼ŒæŠ›å‡ºé”™è¯¯ä»¥ä½¿æ­¥éª¤å¤±è´¥å¹¶åœæ­¢å·¥ä½œæµã€‚

```typescript title="src/mastra/workflows/test-workflow.ts"
const step1 = createStep({...});

export const testWorkflow = createWorkflow({...})
  .dountil(step1, async ({ inputData: { userResponse, iterationCount } }) => {
    if (iterationCount >= 10) {
      throw new Error("Maximum iterations reached");
    }
    return userResponse === "yes";
  })
  .commit();
```

## ç›¸å…³å†…å®¹

- [æš‚åœä¸æ¢å¤](/docs/cn/workflows/suspend-and-resume)
- [äººæœºäº¤äº’](/docs/cn/workflows/human-in-the-loop)
