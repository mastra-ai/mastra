---
title: "AgentNetwork から .network() への移行 | 移行ガイド"
description: "Mastra で AgentNetwork のプリミティブから .network() へ移行する方法を学びましょう。"
---

## 概要

`@mastra/core` の `v0.20.0` 以降、以下の変更が適用されます。

### AI SDK v4 から v5 へのアップグレード

- すべてのモデルプロバイダーのパッケージをメジャーバージョンに上げてください。

> これにより、すべてが v5 モデルになります。

### メモリが必須です

- エージェントネットワークを正常に動作させるには、メモリが必須になりました。

> エージェントのメモリを必ず設定してください。

## 移行パス

`AgentNetwork` プリミティブを使用していた場合は、`AgentNetwork` を `Agent` に置き換えられます。

変更前:

```typescript
import { AgentNetwork } from '@mastra/core/network';

const agent = new AgentNetwork({
  name: 'agent-network',
  agents: [agent1, agent2],
  tools: { tool1, tool2 },
  model: openai('gpt-4o'),
  instructions: 'あなたはさまざまなタスクでユーザーを支援できるネットワークエージェントです。',
});

await agent.stream('東京の天気を調べてください。');
```

後:

```typescript
import { Agent } from '@mastra/core/agent';
import { Memory } from '@mastra/memory';

const memory = new Memory();

const agent = new Agent({
  name: 'agent-network',
  agents: { agent1, agent2 },
  tools: { tool1, tool2 },
  model: openai('gpt-4o'),
  instructions: 'あなたは様々なタスクでユーザーを支援できるネットワークエージェントです。',
  memory,
});

await agent.network('東京の天気を調べて。');
```

`NewAgentNetwork` プリミティブを使用していた場合は、`NewAgentNetwork` を `Agent` に置き換えてください。

Before:

```typescript
import { NewAgentNetwork } from '@mastra/core/network/vnext';

const agent = new NewAgentNetwork({
  name: 'agent-network',
  agents: { agent1, agent2 },
  workflows: { workflow1 },
  tools: { tool1, tool2 },
  model: openai('gpt-4o'),
  instructions: 'あなたはさまざまなタスクでユーザーを支援できるネットワークエージェントです。',
});

await agent.loop('東京の天気を教えてください。');
```

After（後）:

```typescript
import { Agent } from '@mastra/core/agent';
import { Memory } from '@mastra/memory';

const memory = new Memory();

const agent = new Agent({
  name: 'agent-network',
  agents: { agent1, agent2 },
  workflows: { workflow1 },
  tools: { tool1, tool2 },
  model: openai('gpt-4o'),
  instructions: 'あなたはユーザーのさまざまなタスクをサポートできるネットワークエージェントです。',
  memory,
});

await agent.network('東京の天気を教えてください。');
```
