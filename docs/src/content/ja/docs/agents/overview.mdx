---
title: "ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ¦‚è¦ | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | Mastra"
description: Mastra ã«ãŠã‘ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ¦‚è¦ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ©Ÿèƒ½ã‚„ã€ãƒ„ãƒ¼ãƒ«ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºæ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
---

import { Steps } from "nextra/components";



# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä½¿ç”¨

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¨€èªãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã—ã¦æ„æ€æ±ºå®šã‚’è¡Œã„ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã¯å¿…é ˆã®æŒ‡ç¤ºã¨LLMãŒã‚ã‚Šã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ãƒ„ãƒ¼ãƒ«ã¨ãƒ¡ãƒ¢ãƒªã‚’æŒã¡ã¾ã™ã€‚

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä¼šè©±ã‚’èª¿æ•´ã—ã€å¿…è¦ã«å¿œã˜ã¦ãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã—ã€ãƒ¡ãƒ¢ãƒªã‚’é€šã˜ã¦ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¶­æŒã—ã€ã‚„ã‚Šå–ã‚Šã«å¿œã˜ãŸå¿œç­”ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯å˜ç‹¬ã§å‹•ä½œã™ã‚‹ã“ã¨ã‚‚ã€ã‚ˆã‚Šå¤§ããªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä¸€éƒ¨ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

![Agents overview](/image/agents/agents-overview.jpg)

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã«ã¯ï¼š

- `Agent`ã‚¯ãƒ©ã‚¹ã§**æŒ‡ç¤º**ã‚’å®šç¾©ã—ã€ä½¿ç”¨ã™ã‚‹**LLM**ã‚’è¨­å®šã—ã¾ã™ã€‚
- ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§**ãƒ„ãƒ¼ãƒ«**ã¨**ãƒ¡ãƒ¢ãƒª**ã‚’è¨­å®šã—ã¦æ©Ÿèƒ½ã‚’æ‹¡å¼µã—ã¾ã™ã€‚
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å®Ÿè¡Œã—ã¦å¿œç­”ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã€æ§‹é€ åŒ–å‡ºåŠ›ã€å‹•çš„è¨­å®šã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯å‹å®‰å…¨æ€§ã¨ãƒ©ãƒ³ã‚¿ã‚¤ãƒ æ¤œè¨¼ã‚’æä¾›ã—ã€ã™ã¹ã¦ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚„ã‚Šå–ã‚Šã«ãŠã„ã¦ä¿¡é ¼æ€§ã®é«˜ã„å‹•ä½œã‚’ä¿è¨¼ã—ã¾ã™ã€‚

> **ğŸ“¹ è¦–è´**ï¼š  â†’ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç´¹ä»‹ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã®æ¯”è¼ƒ [YouTubeï¼ˆ7åˆ†ï¼‰](https://youtu.be/0jg2g3sNvgw)



## ã¯ã˜ã‚ã«

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€å¿…è¦ãªä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼š

```bash
npm install @mastra/core @ai-sdk/openai
```

> Mastraã¯ã™ã¹ã¦ã®AI SDKãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯[ãƒ¢ãƒ‡ãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼](../getting-started/model-providers.mdx)ã‚’ã”è¦§ãã ã•ã„ã€‚

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰å¿…è¦ãªã‚¯ãƒ©ã‚¹ã¨LLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ï¼š

```typescript filename="src/mastra/agents/test-agent.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";
```
### LLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼

å„LLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«ã¯ã€ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®è­˜åˆ¥å­ã‚’ä½¿ç”¨ã—ã¦å‘½åã•ã‚ŒãŸå°‚ç”¨ã®APIã‚­ãƒ¼ãŒå¿…è¦ã§ã™ï¼š

```bash filename=".env" copy
OPENAI_API_KEY=<your-api-key>
```

> Vercel AI SDKãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®[AI SDKãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼](https://ai-sdk.dev/providers/ai-sdk-providers)ã‚’ã”è¦§ãã ã•ã„ã€‚

### ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä½œæˆ

Mastraã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã«ã¯ã€`Agent`ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã™ã¹ã¦ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã¯ã€å‹•ä½œã‚’å®šç¾©ã™ã‚‹`instructions`ã¨ã€LLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ãƒ¢ãƒ‡ãƒ«ã‚’æŒ‡å®šã™ã‚‹`model`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™ï¼š

```typescript filename="src/mastra/agents/test-agent.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";

export const testAgent = new Agent({
  name: "test-agent",
  instructions: "You are a helpful assistant.",
  model: openai("gpt-4o-mini")
});
```

> è©³ç´°ã«ã¤ã„ã¦ã¯[ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ](../../reference/agents/agent.mdx)ã‚’ã”è¦§ãã ã•ã„ã€‚


### ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç™»éŒ²

Mastraã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ç™»éŒ²ã—ã¾ã™ï¼š

```typescript showLineNumbers filename="src/mastra/index.ts" copy
import { Mastra } from "@mastra/core/mastra";
import { testAgent } from './agents/test-agent';

export const mastra = new Mastra({
  // ...
  agents: { testAgent },
});
```



## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‚ç…§

ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¹ãƒ†ãƒƒãƒ—ã€ãƒ„ãƒ¼ãƒ«ã€Mastraã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ã¾ãŸã¯ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«å¿œã˜ã¦ã€`mastra`ã¾ãŸã¯`mastraClient`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®`.getAgent()`ã‚’å‘¼ã³å‡ºã—ã¦å‚ç…§ã‚’å–å¾—ã—ã¾ã™ï¼š

```typescript showLineNumbers copy
const testAgent = mastra.getAgent("testAgent");
```

> è©³ç´°ã«ã¤ã„ã¦ã¯ã€[ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‘¼ã³å‡ºã—](../../examples/agents/calling-agents.mdx)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚



## ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç”Ÿæˆ

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å–å¾—ã™ã‚‹ã«ã¯`.generate()`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ã¯å˜ä¸€ã®æ–‡å­—åˆ—ã‚’ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æä¾›ã™ã‚‹å ´åˆã¯æ–‡å­—åˆ—ã®é…åˆ—ã‚’ã€ãƒ­ãƒ¼ãƒ«ã¨ä¼šè©±ãƒ•ãƒ­ãƒ¼ã‚’æ­£ç¢ºã«åˆ¶å¾¡ã™ã‚‹å ´åˆã¯`role`ã¨`content`ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã‚’æ¸¡ã—ã¾ã™ã€‚

> è©³ç´°ã«ã¤ã„ã¦ã¯[.generate()](../../reference/agents/generate.mdx)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ãƒ†ã‚­ã‚¹ãƒˆã®ç”Ÿæˆ

`role`ã¨`content`ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã‚’ä½¿ç”¨ã—ã¦`.generate()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼š

```typescript showLineNumbers copy
const response = await testAgent.generate([
  { role: "user", content: "ä¸€æ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ•´ç†ã™ã‚‹ã®ã‚’æ‰‹ä¼ã£ã¦" },
  { role: "user", content: "ç§ã®ä¸€æ—¥ã¯åˆå‰9æ™‚ã«å§‹ã¾ã‚Šã€åˆå¾Œ5æ™‚30åˆ†ã«çµ‚ã‚ã‚Šã¾ã™" },
  { role: "user", content: "æ˜¼é£Ÿã¯12æ™‚30åˆ†ã‹ã‚‰13æ™‚30åˆ†ã®é–“ã«å–ã‚Šã¾ã™" },
  { role: "user", content: "æœˆæ›œæ—¥ã‹ã‚‰é‡‘æ›œæ—¥ã¾ã§10æ™‚30åˆ†ã‹ã‚‰11æ™‚30åˆ†ã®é–“ã«ä¼šè­°ãŒã‚ã‚Šã¾ã™" }
]);

console.log(response.text);
```



## ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯`.stream()`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ã¯å˜ä¸€ã®æ–‡å­—åˆ—ã‚’ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æä¾›ã™ã‚‹å ´åˆã¯æ–‡å­—åˆ—ã®é…åˆ—ã‚’ã€ãƒ­ãƒ¼ãƒ«ã¨ä¼šè©±ãƒ•ãƒ­ãƒ¼ã‚’æ­£ç¢ºã«åˆ¶å¾¡ã™ã‚‹å ´åˆã¯`role`ã¨`content`ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã‚’æ¸¡ã—ã¾ã™ã€‚

> è©³ç´°ã«ã¤ã„ã¦ã¯[.stream()](../../reference/agents/stream.mdx)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°

`role`ã¨`content`ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã§`.stream()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼š

```typescript showLineNumbers copy
const stream = await testAgent.stream([
  { role: "user", content: "Help me organize my day" },
  { role: "user", content: "My day starts at 9am and finishes at 5.30pm" },
  { role: "user", content: "I take lunch between 12:30 and 13:30" },
  { role: "user", content: "I have meetings Monday to Friday between 10:30 and 11:30" }
]);

for await (const chunk of stream.textStream) {
  process.stdout.write(chunk);
}
```

### `onFinish()`ã‚’ä½¿ç”¨ã—ãŸå®Œäº†å‡¦ç†

ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä½¿ç”¨æ™‚ã€`onFinish()`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯LLMãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç”Ÿæˆã‚’å®Œäº†ã—ã€ã™ã¹ã¦ã®ãƒ„ãƒ¼ãƒ«å®Ÿè¡ŒãŒå®Œäº†ã—ãŸå¾Œã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
æœ€çµ‚çš„ãª`text`ã€å®Ÿè¡Œ`steps`ã€`finishReason`ã€ãƒˆãƒ¼ã‚¯ãƒ³`usage`çµ±è¨ˆã€ãŠã‚ˆã³ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚„ãƒ­ã‚°è¨˜éŒ²ã«æœ‰ç”¨ãªãã®ä»–ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒæä¾›ã•ã‚Œã¾ã™ã€‚

```typescript showLineNumbers copy
const stream = await testAgent.stream("Help me organize my day", {
  onFinish: ({ steps, text, finishReason, usage }) => {
    console.log({ steps, text, finishReason, usage });
  }
});

for await (const chunk of stream.textStream) {
  process.stdout.write(chunk);
}
```



## æ§‹é€ åŒ–å‡ºåŠ›

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€[Zod](https://zod.dev/) ã¾ãŸã¯ [JSON Schema](https://json-schema.org/) ã§æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ã€å‹å®‰å…¨ãªæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã„ãšã‚Œã®å ´åˆã‚‚ã€ãƒ‘ãƒ¼ã‚¹æ¸ˆã¿ã®çµæœã¯ `response.object` ã«æ ¼ç´ã•ã‚Œã¦ãŠã‚Šã€æ¤œè¨¼æ¸ˆã¿ã‹ã¤å‹æƒ…å ±ä»˜ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ¥æ‰±ãˆã¾ã™ã€‚

### Zod ã®ä½¿ç”¨

[Zod](https://zod.dev/) ã‚’ä½¿ã£ã¦ `output` ã®ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ã¾ã™:

```typescript showLineNumbers copy
import { z } from "zod";

const response = await testAgent.generate(
  [
    {
      role: "system",
      content: "Provide a summary and keywords for the following text:"
    },
    {
      role: "user",
      content: "Monkey, Ice Cream, Boat"
    }
  ],
  {
    output: z.object({
      summary: z.string(),
      keywords: z.array(z.string())
    })
  }
);

console.log(response.object);
```

#### ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§æ§‹é€ åŒ–å‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ã«ã¯ã€`experimental_output` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¾ã™:

```typescript {6} showLineNumbers copy
import { z } from "zod";

const response = await testAgent.generate(
  // ...
  {
    experimental_output: z.object({
      summary: z.string(),
      keywords: z.array(z.string())
    })
  }
);

console.log(response.object);
```



## ç”»åƒã®èª¬æ˜

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€è¦–è¦šçš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ãã®ä¸­ã«å«ã¾ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®ä¸¡æ–¹ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã§ã€ç”»åƒã‚’åˆ†æã—èª¬æ˜ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç”»åƒåˆ†æã‚’æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯ã€`content`é…åˆ—å†…ã§`type: 'image'`ã¨ç”»åƒURLã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã—ã¾ã™ã€‚ç”»åƒã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®åˆ†æã‚’èª˜å°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```typescript showLineNumbers copy
const response = await testAgent.generate([
  {
    role: "user",
    content: [
      {
        type: "image",
        image: "https://placebear.com/cache/395-205.jpg",
        mimeType: "image/jpeg"
      },
      {
        type: "text",
        text: "ç”»åƒã‚’è©³ç´°ã«èª¬æ˜ã—ã€ç”»åƒå†…ã®ã™ã¹ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚"
      }
    ]
  }
]);

console.log(response.text);
```



## ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—ãƒ„ãƒ¼ãƒ«ä½¿ç”¨

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦æ©Ÿèƒ½ã‚’æ‹¡å¼µã§ãã¾ã™ã€‚ãƒ„ãƒ¼ãƒ«ã¨ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã‚’è¶…ãˆã¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®èƒ½åŠ›ã‚’æ‹¡å¼µã™ã‚‹é–¢æ•°ã§ã™ã€‚ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯è¨ˆç®—ã®å®Ÿè¡Œã€å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã€ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä¸ãˆã‚‰ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã™ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã ã‘ã§ãªãã€ãã®ãƒ„ãƒ¼ãƒ«ã«æ¸¡ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚æ±ºå®šã—ã¾ã™ã€‚

ãƒ„ãƒ¼ãƒ«ã®ä½œæˆã¨è¨­å®šã«é–¢ã™ã‚‹è©³ç´°ãªã‚¬ã‚¤ãƒ‰ã«ã¤ã„ã¦ã¯ã€[ãƒ„ãƒ¼ãƒ«æ¦‚è¦](../tools-mcp/overview.mdx)ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### `maxSteps`ã®ä½¿ç”¨

`maxSteps`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå®Ÿè¡Œã§ãã‚‹é€£ç¶šã—ãŸLLMå‘¼ã³å‡ºã—ã®æœ€å¤§æ•°ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚ã“ã‚Œã¯ç‰¹ã«ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã‚’ä½¿ç”¨ã™ã‚‹éš›ã«é‡è¦ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€è¨­å®šãƒŸã‚¹ã®ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚’é˜²ããŸã‚ã«1ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™ï¼š

```typescript showLineNumbers copy
const response = await testAgent.generate("Help me organize my day", {
  maxSteps: 5
});

console.log(response.text);
```

### `onStepFinish`ã®ä½¿ç”¨

`onStepFinish`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—æ“ä½œã®é€²è¡ŒçŠ¶æ³ã‚’ç›£è¦–ã§ãã¾ã™ã€‚ã“ã‚Œã¯ãƒ‡ãƒãƒƒã‚°ã‚„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®é€²è¡ŒçŠ¶æ³æ›´æ–°ã«å½¹ç«‹ã¡ã¾ã™ã€‚

`onStepFinish`ã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ™‚ã¾ãŸã¯æ§‹é€ åŒ–å‡ºåŠ›ãªã—ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹éš›ã«ã®ã¿åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

```typescript showLineNumbers copy
const response = await testAgent.generate("Help me organize my day", {
  onStepFinish: ({ text, toolCalls, toolResults, finishReason, usage }) => {
    console.log({ text, toolCalls, toolResults, finishReason, usage });
  }
});
```



## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆã™ã‚‹
ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å®Ÿè¡Œãƒ»ãƒ†ã‚¹ãƒˆã™ã‚‹æ–¹æ³•ã¯2ã¤ã‚ã‚Šã¾ã™ã€‚

<Steps>

### Mastra Playground

Mastra Dev Server ã‚’èµ·å‹•ã—ãŸçŠ¶æ…‹ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ [http://localhost:4111/agents](http://localhost:4111/agents) ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€Mastra Playground ã‹ã‚‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚

> ãã‚ã—ãã¯ã€[Local Dev Playground](/docs/server-db/local-dev-playground) ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚

### ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³

`.generate()` ã¾ãŸã¯ `.stream()` ã‚’ä½¿ã£ã¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

```typescript {7} filename="src/test-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const agent = mastra.getAgent("testAgent");

const response = await agent.generate("Help me organize my day");

console.log(response.text);
```

> ãã‚ã—ãã¯ [.generate()](../../reference/agents/generate.mdx) ã¾ãŸã¯ [.stream()](../../reference/agents/stream.mdx) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€æ¬¡ã‚’å®Ÿè¡Œã—ã¾ã™:

```bash copy
npx tsx src/test-agent.ts
```

</Steps>



## é–¢é€£é …ç›®

- [ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ¡ãƒ¢ãƒª](./agent-memory.mdx)
- [ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ](./dynamic-agents.mdx)
- [ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã¨MCP](./using-tools-and-mcp.mdx)
- [ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‘¼ã³å‡ºã—](../../examples/agents/calling-agents.mdx)
