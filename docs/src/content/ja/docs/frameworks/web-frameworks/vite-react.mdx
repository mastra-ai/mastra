---
title: "Mastra と Vite/React の始め方 | Mastra ガイド"
description: Mastra を Vite と React に統合するための手順ガイド。
---

import { Callout, Steps, Tabs } from "nextra/components";


# Vite/React プロジェクトに Mastra を統合する

Mastra は Vite と統合されており、次のことが簡単に行えます。

- AI 機能を提供する柔軟な API を構築する
- フロントエンドとバックエンドを単一のコードベースにまとめ、デプロイを簡素化する
- Mastra の Client SDK を活用する

このガイドを使って、Vite/React プロジェクトに Mastra の足場を作成し、統合しましょう。

<Callout type="warning">
  このガイドは、プロジェクトのルート (例: `app`) で React Router v7 を使う Vite/React 構成を前提としています。
</Callout>

## Mastra をインストール

必要な Mastra パッケージをインストールします:

{/*
LLM CONTEXT: この Tabs コンポーネントは、各種パッケージマネージャーで新しい Mastra バックエンドプロジェクトを統合するためのコマンドを表示します。
各タブには、そのパッケージマネージャー向けの、統合済みの Mastra バックエンドサービスを作成するコマンドが表示されます。
これは Vite/React プロジェクト向けの「統合型バックエンド統合」アプローチの一部です。
すべてのコマンドは同じ Mastra プロジェクトを作成しますが、パッケージマネージャーごとに記法が異なります。
*/}

<Tabs items={["npm", "yarn", "pnpm", "bun"]}>
  <Tabs.Tab>
    ```bash copy
    npm install mastra@latest @mastra/core@latest @mastra/libsql@latest @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    yarn add mastra@latest @mastra/core@latest @mastra/libsql@latest @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    pnpm add mastra@latest @mastra/core@latest @mastra/libsql@latest @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    bun add mastra@latest @mastra/core@latest @mastra/libsql@latest @mastra/client-js@latest
    ```
  </Tabs.Tab>
</Tabs>

## Mastra を統合する

プロジェクトに Mastra を統合するには、次の2つの方法があります：

### 1. ワンライナーを使う

次のコマンドを実行して、妥当なデフォルト設定付きのデフォルトの Weather エージェントを手早く作成します:

```bash copy
npx mastra@latest init --dir . --components agents,tools --example --llm openai
```

> 詳細は [mastra init](/reference/cli/init) をご覧ください。


### 2. 対話型 CLI を使う

セットアップをカスタマイズする場合は、`init` コマンドを実行し、表示される選択肢から選んでください。

```bash copy
npx mastra@latest init
```

<Callout type="warning">
  既定では、`mastra init` はインストール先として `src` を提案します。プロジェクトのルート直下で Vite/React を使っている場合（例: `app`、`src/app` ではない）、プロンプトが表示されたら `.` を入力してください:
</Callout>

`package.json` に `dev` と `build` スクリプトを追加します:

<Tabs items={["app", "src/app"]}>
  <Tabs.Tab>
    ```json filename="package.json"
    {
      "scripts": {
        ...
        "dev:mastra": "mastra dev --dir mastra",
        "build:mastra": "mastra build --dir mastra"
      }
    }
    ```
  </Tabs.Tab>

  <Tabs.Tab>
    ```json filename="package.json"
    {
      "scripts": {
        ...
        "dev:mastra": "mastra dev --dir src/mastra",
        "build:mastra": "mastra build --dir src/mastra"
      }
    }
    ```
  </Tabs.Tab>
</Tabs>


## TypeScript を設定する

プロジェクトのルートにある `tsconfig.json` ファイルを編集します：

```json filename="tsconfig.json"
{
  ...
  "exclude": ["dist", ".mastra"]
}
```


## API キーの設定

```bash filename=".env" copy
OPENAI_API_KEY=<APIキー>
```

> LLM のプロバイダーごとに使用する環境変数が異なります。詳しくは [Model Capabilities](/docs/getting-started/model-capability) をご覧ください。


## .gitignore を更新する

`.mastra` を `.gitignore` ファイルに追加します:

```bash filename=".gitignore" copy
.mastra
```


## Mastra Dev Server を起動する

Mastra Dev Server を起動して、エージェントを REST エンドポイントとして公開します。

<Tabs items={["npm", "CLI"]}>
  <Tabs.Tab>
    ```bash copy
    npm run dev:mastra
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    mastra dev:mastra
    ```
  </Tabs.Tab>
</Tabs>

> 起動後、エージェントはローカルで利用可能になります。詳しくは「[ローカル開発環境](/docs/server-db/local-dev-playground)」を参照してください。

## Vite 開発サーバーを起動する

Mastra Dev Server が稼働していれば、通常どおり Vite アプリを起動できます。

## Mastra クライアントを作成する

新しいディレクトリとファイルを作成し、以下のサンプルコードを追加します。

```bash copy
mkdir lib
touch lib/mastra.ts
```

```typescript filename="lib/mastra.ts" showLineNumbers copy
import { MastraClient } from "@mastra/client-js";

export const mastraClient = new MastraClient({
  baseUrl: import.meta.env.VITE_MASTRA_API_URL || "http://localhost:4111",
});
```


## テストルートのルート設定を作成する

設定に新しい `route` を追加します:

```typescript filename="app/routes.ts" showLineNumbers copy
import { type RouteConfig, index, route } from "@react-router/dev/routes";

export default [
  index("routes/home.tsx"),
  route("test", "routes/test.tsx"),
] satisfies RouteConfig;
```


## テスト用ルートを作成

新しい Route を作成し、次のサンプルコードを追加します:

```bash copy
touch app/routes/test.tsx
```

```typescript filename="app/routes/test.tsx" showLineNumbers copy
import { useState } from "react";
import { mastraClient } from "../../lib/mastra";

export default function Test() {
  const [result, setResult] = useState<string | null>(null);

  async function handleSubmit(event: React.FormEvent<HTMLFormElement>) {
    event.preventDefault();

    const formData = new FormData(event.currentTarget);
    const city = formData.get("city")?.toString();
    const agent = mastraClient.getAgent("weatherAgent");

    const response = await agent.generate({
      messages: [{ role: "user", content: `${city}の天気はどう？` }]
    });

    setResult(response.text);
  }

  return (
    <>
      <h1>テスト</h1>
      <form onSubmit={handleSubmit}>
        <input name="city" placeholder="都市名を入力してください" required />
        <button type="submit">天気を表示</button>
      </form>
      {result && <pre>{result}</pre>}
    </>
  );
}
```

> これでブラウザで `/test` にアクセスして試せます。

都市に **London** を入力して送信すると、次のような結果が返ってきます:

```plaintext
ロンドンの現在の天気は晴れ時々曇り、気温19.3°C（体感17.4°C）。湿度53%、風速15.9 km/h、最大瞬間風速38.5 km/h。
```


## 次のステップ

- [Monorepo のデプロイ](../../deployment/monorepo.mdx)