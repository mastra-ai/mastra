---
title: Assistant UI を使う
description: "Assistant UI を Mastra と統合する方法を学ぶ"
---

import { Callout, FileTree, Steps } from 'nextra/components'


# Assistant UI と併用する

[Assistant UI](https://assistant-ui.com) は、AI チャット向けの TypeScript/React ライブラリです。
shadcn/ui と Tailwind CSS の上に構築されており、開発者がわずか数分で美しく、エンタープライズ級のチャット体験を構築できるようにします。

<Callout type="info">
Mastra を Next.js の API ルートで直接動かすフルスタック統合アプローチについては、Assistant UI のドキュメントサイトにある [Full-Stack Integration Guide](https://www.assistant-ui.com/docs/runtimes/mastra/full-stack-integration) をご覧ください。
</Callout>

## 統合ガイド

Mastra をスタンドアロンのサーバーとして実行し、Next.js フロントエンド（Assistant UI 使用）からその API エンドポイントに接続します。

<Steps>
### スタンドアロンの Mastra サーバーを作成

ディレクトリ構成を用意します。例として、次のような構成が考えられます。

<FileTree>
    <FileTree.Folder name="project-root" defaultOpen>
        <FileTree.Folder name="mastra-server" defaultOpen>
            <FileTree.Folder name="src">
                <FileTree.Folder name="mastra" />
            </FileTree.Folder>
            <FileTree.File name="package.json" />
        </FileTree.Folder>
        <FileTree.Folder name="nextjs-frontend">
            <FileTree.File name="package.json" />
        </FileTree.Folder>
    </FileTree.Folder>
</FileTree>

Mastra サーバーの初期セットアップを行います:

```bash copy
npx create-mastra@latest
```

このコマンドは対話型ウィザードを起動し、プロジェクト名の入力や基本設定のセットアップなど、新規 Mastra プロジェクトのひな型作成を手助けします。
プロンプトに従ってサーバープロジェクトを作成してください。

これで基本的な Mastra サーバープロジェクトが用意できました。以下のファイル／フォルダが作成されているはずです。

<FileTree>
    <FileTree.Folder name="src" defaultOpen>
      <FileTree.Folder name="mastra" defaultOpen>
        <FileTree.File name="index.ts" />
        <FileTree.Folder name="agents" defaultOpen>
          <FileTree.File name="weather-agent.ts" />
        </FileTree.Folder>
        <FileTree.Folder name="tools" defaultOpen>
          <FileTree.File name="weather-tool.ts" />
        </FileTree.Folder>
        <FileTree.Folder name="workflows" defaultOpen>
          <FileTree.File name="weather-workflow.ts" />
        </FileTree.Folder>
      </FileTree.Folder>
    </FileTree.Folder>
</FileTree>

<Callout>
`.env` ファイルに、利用する LLM プロバイダー向けの適切な環境変数が設定されていることを確認してください。
</Callout>

### Mastra サーバーを起動

次のコマンドで Mastra サーバーを起動します:

```bash copy
npm run dev
```

デフォルトでは Mastra サーバーは `http://localhost:4111` で動作します。`weatherAgent` には、通常 `http://localhost:4111/api/agents/weatherAgent/stream` の POST リクエストエンドポイントからアクセスできます。続く手順で Assistant UI フロントエンドを接続するため、このサーバーは起動したままにしておいてください。

### Assistant UI を初期化

次のコマンドで新しい `assistant-ui` プロジェクトを作成します。

```bash copy
npx assistant-ui@latest create
```

<Callout>API キーの追加、基本設定、手動セットアップ手順などの詳細については、[assistant-ui の公式ドキュメント](https://assistant-ui.com/docs)を参照してください。</Callout>

### フロントエンドの API エンドポイントを設定

デフォルトの Assistant UI 設定では、Next.js プロジェクト内のローカル API ルート（`/api/chat`）をチャットランタイムで使用します。Mastra エージェントは別サーバーで動作しているため、フロントエンドをそのサーバーのエンドポイントに向けるよう更新する必要があります。

`assistant-ui` プロジェクト内の `useChatRuntime` フック（通常は `app/assistant.tsx`）を開き、`api` プロパティを Mastra エージェントのストリームエンドポイントのフル URL に変更します:

```typescript showLineNumbers copy filename="app/assistant.tsx" {6}
import {
  useChatRuntime,
  AssistantChatTransport,
} from "@assistant-ui/react-ai-sdk";

const runtime = useChatRuntime({
  transport: new AssistantChatTransport({
    api: "MASTRA_ENDPOINT",
  }),
});
```

これで Assistant UI フロントエンドは、起動中の Mastra サーバーへ直接チャットリクエストを送信します。

### アプリケーションを起動

準備完了です。Mastra サーバーと Assistant UI フロントエンドの両方が起動していることを確認し、Next.js の開発サーバーを起動します:

```bash copy
npm run dev
```

これでブラウザ上でエージェントとチャットできるはずです。

</Steps>

おめでとうございます。スタンドアロンのサーバー方式で Mastra を Assistant UI と正常に統合できました。Assistant UI フロントエンドは、スタンドアロンの Mastra エージェントサーバーと通信するようになりました。