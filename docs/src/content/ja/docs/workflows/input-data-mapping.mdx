---
title: "ワークフローの入力データマッピング | Mastra Docs"
description: "Mastra のワークフローで入力マッピングを使って、より動的なデータフローを実現する方法を学びましょう。"
---

# 入力データのマッピング

入力データのマッピングでは、次のステップの入力に値を明示的にマッピングできます。これらの値は、次のいずれかのソースから取得されます:

- 前のステップの出力
- ランタイムコンテキスト
- 定数
- ワークフローの初期入力

## `.map()` を使ったマッピング

この例では、`step1` の `output` を `step2` に必要な `inputSchema` に合うように変換します。`step1` の値は、`.map` 関数の `inputData` パラメータで参照できます。

![.map() を使ったマッピング](/image/workflows/workflows-data-mapping-map.jpg)

```typescript {9} filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
const step1 = createStep({...});
const step2 = createStep({...});

export const testWorkflow = createWorkflow({...})
  .then(step1)
  .map(async ({ inputData }) => {
    const { value } = inputData;
    return {
      output: `new ${value}`
    };
  })
  .then(step2)
  .commit();
```


## `inputData` の使用

前のステップの出力全体にアクセスするには、`inputData` を使用します。

```typescript {3} filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
  .then(step1)
  .map(({ inputData }) => {
    console.log(inputData);
  })
```


## `getStepResult()` の使用

`getStepResult` を使うと、ステップのインスタンスを参照して、特定のステップの完全な出力にアクセスできます。

```typescript {3} filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
  .then(step1)
  .map(async ({ getStepResult }) => {
    console.log(getStepResult(step1));
  })
```


## `getInitData()` の使用

ワークフローに提供された初期入力データにアクセスするには、`getInitData()` を使用します。

```typescript {3} filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
  .then(step1)
  .map(async ({ getInitData }) => {
      console.log(getInitData());
  })
```


## `mapVariable()` の使い方

`mapVariable` を使用するには、workflows モジュールから対象の関数をインポートします。

```typescript filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
import { mapVariable } from "@mastra/core/workflows";
```


### `mapVariable()` を使ったステップ出力の名称変更

`.map()` のオブジェクト構文を使って、ステップの出力名を変更できます。次の例では、`step1` の `value` 出力が `details` に変更されています:

```typescript {3-6} filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
  .then(step1)
  .map({
    details: mapVariable({
      step: step,
      path: "value"
    })
  })
```


### `mapVariable()` を使ったワークフロー出力のリネーム

**参照合成**を使うと、ワークフローの出力名を変更できます。これは、`initData` にワークフローインスタンスを渡すことで行います。

```typescript {6-9} filename="src/mastra/workflows/test-workflow.ts" showLineNumbers copy
export const testWorkflow = createWorkflow({...});

testWorkflow
  .then(step1)
  .map({
    details: mapVariable({
      initData: testWorkflow,
      path: "value"
    })
  })
```
