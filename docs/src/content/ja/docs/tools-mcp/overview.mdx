---
title: "ツールの使用 | Tools & MCP | Mastra ドキュメント"
description: Mastra におけるツールの概要、エージェントへの追加方法、効果的なツール設計のベストプラクティスを解説します。
---

import { Steps } from "nextra/components";


# ツールの使用

ツールは、エージェントが特定のタスクを実行したり、外部情報にアクセスしたりするために呼び出せる関数です。これにより、単なるテキスト生成を超えて、API、データベース、その他のシステムとやり取りする能力が拡張されます。

各ツールは通常、次の項目を定義します:

- **入力:** ツールの実行に必要な情報（`inputSchema` で定義され、Zod が用いられることが多い）。
- **出力:** ツールが返すデータの構造（`outputSchema` で定義）。
- **実行ロジック:** ツールの処理を行うコード。
- **説明:** ツールの機能と使用すべき状況をエージェントに伝えるためのテキスト。

## ツールの作成

Mastra では、`@mastra/core/tools` パッケージの [`createTool`](/reference/tools/create-tool) 関数を使ってツールを作成します。

```typescript filename="src/mastra/tools/weatherInfo.ts" copy
import { createTool } from "@mastra/core/tools";
import { z } from "zod";

const getWeatherInfo = async (city: string) => {
  // 実際の天気サービスへの API 呼び出しに置き換えてください
  console.log(`${city} の天気を取得しています...`);
  // Example data structure
  return { temperature: 20, conditions: "晴れ" };
};

export const weatherTool = createTool({
  id: "天気情報を取得",
  description: `指定した都市の現在の天気情報を取得します`,
  inputSchema: z.object({
    city: z.string().describe("都市名"),
  }),
  outputSchema: z.object({
    temperature: z.number(),
    conditions: z.string(),
  }),
  execute: async ({ context: { city } }) => {
    console.log("ツールを使って天気情報を取得中:", city);
    return await getWeatherInfo(city);
  },
});
```

この例では、都市を受け取る入力スキーマ、天気データの出力スキーマ、そしてツールのロジックを実装した `execute` 関数を備えた `weatherTool` を定義しています。

ツールを作成する際は、説明を簡潔に保ち、ツールが**何を**行い、**いつ**使うかに焦点を当て、主要なユースケースを強調してください。技術的な詳細はパラメータスキーマに記述し、分かりやすい名前と明瞭な説明、デフォルト値の解説を用いて、エージェントがツールを正しく*どのように*使うかを導きましょう。


## エージェントにツールを追加する

エージェントでツールを使えるようにするには、エージェントの定義でツールを設定します。ツールの存在とその一般的な用途をエージェントのシステムプロンプトで明示すると、ツールの活用精度が向上することがあります。詳しい手順と例は、[Using Tools and MCP with Agents](/docs/agents/using-tools-and-mcp#add-tools-to-an-agent)のガイドをご覧ください。

## `RuntimeContext` の使用

[RuntimeContext](../server-db/runtime-context.mdx) を使って、リクエストごとの値にアクセスします。これにより、リクエストの文脈に応じて挙動を条件付きで調整できます。

```typescript filename="src/mastra/tools/test-tool.ts" showLineNumbers
export type UserTier = {
  "user-tier": "enterprise" | "pro";
};

const advancedTools = () => {
  // ...
};

const baseTools =  () => {
  // ...
};

export const testTool = createTool({
  // ...
  execute: async ({ runtimeContext }) => {
    const userTier = runtimeContext.get("user-tier") as UserTier["user-tier"];

    return userTier === "enterprise"
      ? advancedTools
      : baseTools;
  }
});
```

> 詳細は [Runtime Context](../server-db/runtime-context.mdx) を参照してください。


## Mastra Playground でのテスト

Mastra の[Playground](../server-db/local-dev-playground.mdx)を使って、さまざまな入力でツールを試し、実行結果を確認し、ツールの動作を検証しましょう。