---
title: Mastra クライアント ワークフロー（旧版）API
description: client-js SDK を使って、Mastra のレガシー自動ワークフローを操作・実行する方法を学びます。
---

# Workflows (Legacy) API

Workflows (Legacy) API は、Mastra のレガシー自動化ワークフローと連携し、実行するためのメソッドを提供します。

## すべてのレガシーワークフローの取得

利用可能なレガシーワークフローの一覧を取得します。

```typescript
const workflows = await mastraClient.getLegacyWorkflows();
```


## 特定のレガシー ワークフローの操作

特定のレガシー ワークフローのインスタンスを取得します:

```typescript
const workflow = mastraClient.getLegacyWorkflow("workflow-id");
```


## 旧式のワークフロー メソッド

### レガシーワークフローの詳細を取得

レガシーワークフローの詳細情報を取得します。

```typescript
const details = await workflow.details();
```


### レガシー Workflow の実行を非同期で開始

triggerData を使ってレガシー Workflow の実行を開始し、完了結果を待ちます。

```typescript
const { runId } = workflow.createRun();

const result = await workflow.startAsync({
  runId,
  triggerData: {
    param1: "value1",
    param2: "value2",
  },
});
```


### レガシーワークフローの実行を非同期で再開

一時停止中のレガシー・ワークフローステップを再開し、最終的な実行結果が得られるまで待機します。

```typescript
const { runId } = createRun({ runId: prevRunId });

const result = await workflow.resumeAsync({
  runId,
  stepId: "step-id",
  contextData: { key: "value" },
});
```


### 旧ワークフローを監視する

旧ワークフローの遷移を監視する

```typescript
try {
  // ワークフローインスタンスを取得
  const workflow = mastraClient.getLegacyWorkflow("workflow-id");

  // ワークフロー実行を作成
  const { runId } = workflow.createRun();

  // ワークフロー実行を監視
  workflow.watch({ runId }, (record) => {
    // 新規レコードは、ワークフロー実行の最新の遷移状態を表します

    console.log({
      activePaths: record.activePaths,
      results: record.results,
      timestamp: record.timestamp,
      runId: record.runId,
    });
  });

  // ワークフロー実行を開始
  workflow.start({
    runId,
    triggerData: {
      city: "New York",
    },
  });
} catch (e) {
  console.error(e);
}
```


### 旧ワークフローの再開

旧ワークフローの実行を再開し、ステップの遷移を監視します

```typescript
try {
  //ステップが一時停止されたワークフロー実行を再開するには
  const { run } = createRun({ runId: prevRunId });

  //実行を監視する
  workflow.watch({ runId }, (record) => {
    // 追加される各レコードは、そのワークフロー実行の最新の遷移状態です

    console.log({
      activePaths: record.activePaths,
      results: record.results,
      timestamp: record.timestamp,
      runId: record.runId,
    });
  });

  //実行を再開する
  workflow.resume({
    runId,
    stepId: "step-id",
    contextData: { key: "value" },
  });
} catch (e) {
  console.error(e);
}
```


### 旧式ワークフローの実行結果

旧式ワークフローの実行結果は次のとおりです:

| フィールド     | 型                                                                                | 説明                                                        |
| -------------- | --------------------------------------------------------------------------------- | ----------------------------------------------------------- |
| `activePaths`  | `Record<string, { status: string; suspendPayload?: any; stepPath: string[] }>`    | 実行ステータス付きで、ワークフロー内で現在アクティブなパス |
| `results`      | `LegacyWorkflowRunResult<any, any, any>['results']`                               | ワークフロー実行の結果                                      |
| `timestamp`    | `number`                                                                          | この遷移が発生した時点の Unix タイムスタンプ                |
| `runId`        | `string`                                                                          | このワークフロー実行インスタンスの一意の識別子              |