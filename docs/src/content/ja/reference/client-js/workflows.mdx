---
title: Mastra クライアント ワークフロー API
description: client-js SDK を使って、Mastra の自動化ワークフローと連携し、実行する方法を学びます。
---

# Workflows API

Workflows API は、Mastra の自動化ワークフローと連携し、それらを実行するためのメソッドを提供します。

## すべてのワークフローを取得

利用可能なワークフローの一覧を取得します。

```typescript
const workflows = await mastraClient.getWorkflows();
```


## 特定のワークフローを操作する

const 名で定義された特定のワークフローのインスタンスを取得します:

```typescript filename="src/mastra/workflows/test-workflow.ts"
export const testWorkflow = createWorkflow({
  id: 'city-workflow'
})
```

```typescript
const workflow = mastraClient.getWorkflow("testWorkflow");
```


## ワークフローの方法

### ワークフローの詳細を取得

ワークフローの詳細情報を取得します。

```typescript
const details = await workflow.details();
```


### ワークフロー実行を非同期で開始する

inputData を使ってワークフローを起動し、実行の完了結果を待ちます:

```typescript
const run = await workflow.createRunAsync();

const result = await run.startAsync({
  inputData: {
    city: "ニューヨーク",
  },
});
```


### 非同期でワークフローの実行を再開する

中断されたワークフローステップを再開し、処理が完了して結果が得られるまで待機します:

```typescript
const run = await workflow.createRunAsync();

const result = await run.resumeAsync({
  step: "step-id",
  resumeData: { key: "value" },
});
```


### ウォッチワークフロー

ウォッチワークフローの遷移:

```typescript
try {
  const workflow = mastraClient.getWorkflow("testWorkflow");

  const run = await workflow.createRunAsync();

  run.watch((record) => {
    console.log(record);
  });

  const result = await run.start({
    inputData: {
      city: "ニューヨーク",
    },
  });
} catch (e) {
  console.error(e);
}
```


### ワークフローの再開

ワークフローの実行を再開し、ステップの遷移を監視します：

```typescript
try {
  const workflow = mastraClient.getWorkflow("testWorkflow");

  const run = await workflow.createRunAsync({ runId: prevRunId });

  run.watch((record) => {
    console.log(record);
  });

  run.resume({
    step: "step-id",
    resumeData: { key: "value" },
  });
} catch (e) {
  console.error(e);
}
```


### ストリーミングワークフロー

リアルタイム更新のために、ワークフローの実行をストリーミングします：

```typescript
try {
  const workflow = mastraClient.getWorkflow("testWorkflow");

  const run = await workflow.createRunAsync();

  const stream = await run.stream({
    inputData: {
      city: 'ニューヨーク',
    },
  });

  for await (const chunk of stream) {
    console.log(JSON.stringify(chunk, null, 2));
  }
} catch (e) {
  console.error('ワークフロー エラー:', e);
}
```


### ワークフロー実行結果を取得

ワークフロー実行の結果を取得します。

```typescript
try  {
  const workflow = mastraClient.getWorkflow("testWorkflow");

  const run = await workflow.createRunAsync();

  // ワークフロー実行を開始
  const startResult = await run.start({
    inputData: {
      city: "ニューヨーク",
    },
  });

  const result = await workflow.runExecutionResult(run.runId);

  console.log(result);
} catch (e) {
  console.error(e);
}
```

長時間実行されるワークフローを扱う際に便利です。これを使ってワークフローの実行結果をポーリングできます。


### ワークフロー実行結果

ワークフローの実行結果は次のとおりです。

| フィールド       | 型                                                                                                                                                                                                                                                  | 説明                                         |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------- |
| `payload`        | `{currentStep?: {id: string, status: string, output?: Record<string, any>, payload?: Record<string, any>}, workflowState: {status: string, steps: Record<string, {status: string, output?: Record<string, any>, payload?: Record<string, any>}>}}` | 実行の現在のステップとワークフローの状態     |
| `eventTimestamp` | `Date`                                                                                                                                                                                                                                              | イベントのタイムスタンプ                     |
| `runId`          | `string`                                                                                                                                                                                                                                            | このワークフロー実行インスタンスの一意識別子 |