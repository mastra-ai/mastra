---
title: "リファレンス: Agent.network()（試験的） | Agents | Mastra ドキュメント"
description: "Mastra のエージェントにおける `Agent.network()` メソッドのドキュメント。マルチエージェントの協調とルーティングを可能にします。"
---

import { NetworkCallout } from "@/components/network-callout.tsx"


# Agent.network()

<NetworkCallout />

`.network()` メソッドは、複数のエージェントによる協働とルーティングを可能にします。このメソッドは、メッセージと任意の実行オプションを受け取ります。

## 使い方の例

```typescript copy
import { Agent } from '@mastra/core/agent';
import { openai } from '@ai-sdk/openai';
import { agent1, agent2 } from './agents';
import { workflow1 } from './workflows';
import { tool1, tool2 } from './tools';

const agent = new Agent({
  name: 'network-agent',
  instructions: 'あなたは、さまざまなタスクでユーザーを支援できるネットワークエージェントです。',
  model: openai('gpt-4o'),
  agents: {
    agent1,
    agent2,
  },
  workflows: {
    workflow1,
  },
  tools: {
    tool1,
    tool2,
  },
})

await agent.network(`
  東京の天気を教えて。 
  その天気に合わせて、私のためのアクティビティを計画して。
`);
```


## パラメータ

<PropertiesTable
  content={[
    {
      name: "messages",
      type: "string | string[] | CoreMessage[] | AiMessageType[] | UIMessageWithMetadata[]",
      description: "エージェントに送信するメッセージ。単一の文字列、文字列配列、または構造化メッセージオブジェクトを指定できます。",
    },
    {
      name: "options",
      type: "MultiPrimitiveExecutionOptions",
      isOptional: true,
      description: "ネットワーク処理のための任意設定。",
    },
  ]}
/>

### オプション

<PropertiesTable
  content={[
  {
    name: "maxSteps",
    type: "number",
    isOptional: true,
    description: "実行時に実行する最大ステップ数。"
  },
  {
    name: "memory",
    type: "object",
    isOptional: true,
    description:
      "メモリの設定。メモリを管理するための推奨方法です。",
    properties: [
      {
        parameters: [
          {
            name: "thread",
            type: "string | { id: string; metadata?: Record<string, any>, title?: string }",
            isOptional: false,
            description:
              "会話スレッド。文字列IDまたは`id`とオプションの`metadata`を持つオブジェクトとして指定。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "resource",
            type: "string",
            isOptional: false,
            description:
              "スレッドに関連付けられたユーザーまたはリソースの識別子。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "options",
            type: "MemoryConfig",
            isOptional: true,
            description:
              "メッセージ履歴やセマンティック想起などのメモリ動作の設定。"
          }
        ]
      }
    ]
  },
  {
    name: "tracingContext",
    type: "TracingContext",
    isOptional: true,
    description:
      "子スパンの作成とメタデータの追加のためのAIトレーシングコンテキスト。Mastraのトレーシングシステム使用時に自動的に注入されます。",
    properties: [
      {
        parameters: [
          {
            name: "currentSpan",
            type: "AISpan",
            isOptional: true,
            description:
              "子スパンの作成とメタデータの追加のための現在のAIスパン。カスタム子スパンの作成や実行中のスパン属性の更新に使用。"
          }
        ]
      }
    ]
  },
  {
    name: "tracingOptions",
    type: "TracingOptions",
    isOptional: true,
    description: "AIトレーシング設定のオプション。",
    properties: [
      {
        parameters: [
          {
            name: "metadata",
            type: "Record<string, any>",
            isOptional: true,
            description:
              "ルートトレーススパンに追加するメタデータ。ユーザーID、セッションID、機能フラグなどのカスタム属性の追加に有用。"
          }
        ]
      }
    ]
  },
  {
    name: "telemetry",
    type: "TelemetrySettings",
    isOptional: true,
    description:
      "ストリーミング中のOTLPテレメトリ収集の設定（AIトレーシングとは異なります）。",
    properties: [
      {
        parameters: [
          {
            name: "isEnabled",
            type: "boolean",
            isOptional: true,
            description:
              "テレメトリの有効/無効を切り替え。実験的機能のため、デフォルトでは無効。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "recordInputs",
            type: "boolean",
            isOptional: true,
            description:
              "入力記録の有効/無効を切り替え。デフォルトで有効。機密情報の記録を避けるために無効にする場合があります。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "recordOutputs",
            type: "boolean",
            isOptional: true,
            description:
              "出力記録の有効/無効を切り替え。デフォルトで有効。機密情報の記録を避けるために無効にする場合があります。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "functionId",
            type: "string",
            isOptional: true,
            description:
              "この関数の識別子。関数別にテレメトリデータをグループ化するために使用。"
          }
        ]
      }
    ]
  },
  {
    name: "modelSettings",
    type: "CallSettings",
    isOptional: true,
    description:
      "temperature、maxTokens、topPなどのモデル固有の設定。これらは基盤となる言語モデルに渡されます。",
    properties: [
      {
        parameters: [
          {
            name: "temperature",
            type: "number",
            isOptional: true,
            description:
              "モデル出力のランダム性を制御。高い値（例：0.8）は出力をよりランダムに、低い値（例：0.2）はより集中的で決定論的にします。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "maxRetries",
            type: "number",
            isOptional: true,
            description: "失敗したリクエストの最大再試行回数。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "topP",
            type: "number",
            isOptional: true,
            description:
              "ニュークリアスサンプリング。0から1の間の数値。temperatureまたはtopPのいずれかを設定することを推奨しますが、両方は設定しないでください。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "topK",
            type: "number",
            isOptional: true,
            description:
              "後続の各トークンについて、上位Kオプションからのみサンプリング。低確率の「ロングテール」応答を除去するために使用。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "presencePenalty",
            type: "number",
            isOptional: true,
            description:
              "プレゼンスペナルティ設定。プロンプトに既に含まれている情報をモデルが繰り返す可能性に影響。-1（繰り返しを増加）から1（最大ペナルティ、繰り返しを減少）の間の数値。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "frequencyPenalty",
            type: "number",
            isOptional: true,
            description:
              "頻度ペナルティ設定。モデルが同じ単語やフレーズを繰り返し使用する可能性に影響。-1（繰り返しを増加）から1（最大ペナルティ、繰り返しを減少）の間の数値。"
          }
        ]
      },
      {
        parameters: [
          {
            name: "stopSequences",
            type: "string[]",
            isOptional: true,
            description:
              "停止シーケンス。設定された場合、停止シーケンスの1つが生成されたときにモデルはテキスト生成を停止。"
          }
        ]
      }
    ]
  },
  {
    name: "runId",
    type: "string",
    isOptional: true,
    description:
      "この生成実行の一意のID。追跡とデバッグの目的に有用。"
  },
  {
    name: "runtimeContext",
    type: "RuntimeContext",
    isOptional: true,
    description:
      "依存性注入と文脈情報のためのランタイムコンテキスト。"
  },
  {
    name: "traceId",
    type: "string",
    isOptional: true,
    description:
      "AIトレーシングが有効な場合のこの実行に関連付けられたトレースID。ログの関連付けと実行フローのデバッグに使用。"
  }
]}
/>

## 戻り値

<PropertiesTable
  content={[
    {
      name: "stream",
      type: "MastraAgentNetworkStream<NetworkChunkType>",
      description: "ReadableStream<NetworkChunkType> を拡張し、ネットワーク固有の追加プロパティを備えたカスタムストリーム",
    },
    {
      name: "status",
      type: "Promise<RunStatus>",
      description: "現在のワークフロー実行ステータスに解決される Promise",
    },
    {
      name: "result",
      type: "Promise<WorkflowResult<TState, TOutput, TSteps>>",
      description: "最終的なワークフロー結果に解決される Promise",
    },
    {
      name: "usage",
      type: "Promise<{ promptTokens: number; completionTokens: number; totalTokens: number }>",
      description: "トークン使用状況の統計情報に解決される Promise",
    },
  ]}
/>