---
title: ".afterEvent() メソッド | Mastra ドキュメント"
description: "Mastra のワークフローでイベントを契機に処理を一時停止するポイントを作成する afterEvent メソッドのリファレンス。"
---

# afterEvent()

`afterEvent()` メソッドは、ワークフロー内に待機ポイントを設け、実行を再開する前に特定のイベントの発生を待機します。

## 構文

```typescript
workflow.afterEvent(eventName: string): Workflow
```


## パラメーター

| Parameter | Type   | Description                                                                                              |
| --------- | ------ | -------------------------------------------------------------------------------------------------------- |
| eventName | string | 待機するイベント名。ワークフローの `events` 設定で定義されたイベントと一致している必要があります。 |

## 戻り値

メソッドチェーンのためにワークフロー インスタンスを返します。

## 説明

`afterEvent()` メソッドは、特定の名前付きイベントを待機する自動的なサスペンドポイントをワークフロー内に作成するために使用されます。つまり、ワークフローが一時停止して外部イベントの発生を待つべき箇所を宣言的に定義する方法です。

`afterEvent()` を呼び出すと、Mastra は次の処理を行います:

1. ID `__eventName_event` を持つ特別なステップを作成する
2. このステップが自動的にワークフローの実行をサスペンドする
3. 指定されたイベントが `resumeWithEvent()` によってトリガーされるまで、ワークフローはサスペンドされた状態で待機する
4. イベントが発生すると、`afterEvent()` 呼び出しに続くステップから実行が再開される

このメソッドは Mastra のイベント駆動型ワークフロー機能の一部であり、サスペンド処理のロジックを手作業で実装することなく、外部システムやユーザーとのインタラクションと連携するワークフローを構築できます。

## 使用上の注意

- `afterEvent()` で指定するイベントは、ワークフローの `events` 設定でスキーマとともに定義されている必要があります
- 作成される特別なステップには予測可能な ID 形式が使用されます: `__eventName_event`（例: `__approvalReceived_event`）
- `afterEvent()` に続く任意のステップは、`context.inputData.resumedEvent` を通じてイベントデータにアクセスできます
- `resumeWithEvent()` が呼び出されると、そのイベント用に定義されたスキーマに基づいてイベントデータが検証されます

## 例

### 基本的な使い方

```typescript
import { LegacyWorkflow } from "@mastra/core/workflows/legacy";

// イベントを伴うワークフローを定義
const workflow = new LegacyWorkflow({
  name: "approval-workflow",
  events: {
    approval: {
      schema: z.object({
        approved: z.boolean(),
        approverName: z.string(),
      }),
    },
  },
});

// イベントで一時停止ポイントを設けたワークフローを構築
workflow
  .step(submitRequest)
  .afterEvent("approval") // ここでワークフローが一時停止する
  .step(processApproval) // このステップはイベント発生後に実行される
  .commit();
```


## 関連情報

- [イベント駆動ワークフロー](./events.mdx)
- [resumeWithEvent()](./resumeWithEvent.mdx)
- [一時停止と再開](../../docs/workflows-legacy/suspend-and-resume.mdx)
- [ワークフロークラス](./workflow.mdx)