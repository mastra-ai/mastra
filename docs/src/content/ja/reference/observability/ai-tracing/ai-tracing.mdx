---
title: "AITracing | AI トレーシング | リファレンス"
description: AI トレーシングのコアクラスとメソッド
asIndexPage: true
---

import { PropertiesTable } from "@/components/properties-table";


# AIトレーシング

## DefaultAITracing

AITracing インターフェースの標準実装。

### コンストラクタ

```typescript
new DefaultAITracing(config: TracingConfig)
```

指定された設定で新しい DefaultAITracing インスタンスを作成します。


### プロパティ

すべてのプロパティとメソッドを BaseAITracing から継承します。

## BaseAITracing

カスタム AI トレーシング実装向けの基底クラス。

### メソッド

#### getConfig

```typescript
getConfig(): Readonly<Required<TracingConfig>>
```

現在のトレース設定を返します。


#### getExporters

```typescript
getExporters(): readonly AITracingExporter[]
```

構成済みのすべてのエクスポーターを返します。


#### getProcessors

```typescript
getProcessors(): readonly AISpanProcessor[]
```

構成済みのすべてのプロセッサーを返します。


#### getLogger

```typescript
getLogger(): IMastraLogger
```

エクスポーターやその他のコンポーネント用のロガーインスタンスを返します。


#### startSpan

```typescript
startSpan<TType extends AISpanType>(
  options: StartSpanOptions<TType>
): AISpan<TType>
```

特定の AISpanType の新しいスパンを開始します。親が指定されていない場合は、トレースのルートスパンを作成します。

<PropertiesTable
  props={[
{
  name: "type",
  type: "AISpanType",
  description: "作成するスパンの種類",
  required: true,
},
{
  name: "name",
  type: "string",
  description: "スパン名",
  required: true,
},
{
  name: "parent",
  type: "AnyAISpan",
  description: "親スパン（ルートでない場合）",
  required: false,
},
{
  name: "attributes",
  type: "AISpanTypeMap[TType]",
  description: "種類固有の属性",
  required: false,
},
{
  name: "metadata",
  type: "Record<string, any>",
  description: "ユーザー定義メタデータ",
  required: false,
},
{
  name: "input",
  type: "any",
  description: "初期入力データ",
  required: false,
},
{
  name: "customSamplerOptions",
  type: "CustomSamplerOptions",
  description: "カスタムサンプラーのオプション",
  required: false,
},
]}
/>


#### シャットダウン

```typescript
async shutdown(): Promise<void>
```

すべてのエクスポーターとプロセッサーをシャットダウンし、リソースを解放します。


## カスタム実装

独自の AI トレーシング実装を作成するには、BaseAITracing を継承してください:

```typescript
class CustomAITracing extends BaseAITracing {
  constructor(config: TracingConfig) {
    super(config);
    // カスタム初期化
  }
  
  // 必要に応じてメソッドをオーバーライド
  startSpan<TType extends AISpanType>(
    options: StartSpanOptions<TType>
  ): AISpan<TType> {
    // カスタムスパン作成ロジック
    return super.startSpan(options);
  }
}
```


## NO-OP スパン

トレーシングが無効（サンプリングが false を返す）な場合、NO-OP スパンが返されます。

### NoOpAISpan

```typescript
class NoOpAISpan<TType extends AISpanType> extends BaseAISpan<TType>
```

何も処理を行わないスパン。すべてのメソッドはノーオペレーション（no-op）です:

* `id` は `'no-op'` を返す
* `traceId` は `'no-op-trace'` を返す
* `isValid` は `false` を返す
* `end()`, `error()`, `update()` は何もしない
* `createChildSpan()` は別の no-op スパンを返す


## 関連情報

### ドキュメント

- [AI Tracing 概要](/docs/observability/ai-tracing/overview) - 概念と使用ガイド
- [設定リファレンス](/reference/observability/ai-tracing/configuration) - 設定項目
- [インターフェースリファレンス](/reference/observability/ai-tracing/interfaces) - 型定義
- [Span リファレンス](/reference/observability/ai-tracing/span) - Span のライフサイクルとメソッド

### 例

- [Basic AI Tracing](/examples/observability/basic-ai-tracing) - 入門例

### エクスポーター

- [DefaultExporter](/reference/observability/ai-tracing/exporters/default-exporter) - ストレージへの永続保存
- [CloudExporter](/reference/observability/ai-tracing/exporters/cloud-exporter) - Mastra Cloud との連携
- [ConsoleExporter](/reference/observability/ai-tracing/exporters/console-exporter) - デバッグ出力