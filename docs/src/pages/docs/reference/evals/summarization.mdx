# SummarizationMetric

The `SummarizationMetric` evaluates how well an LLM's summary captures the original text's content while maintaining factual accuracy. It combines two aspects: alignment (factual correctness) and coverage (inclusion of key information), using the minimum of these scores to ensure both qualities are necessary for a good summary.

## Basic Usage

```typescript
import { SummarizationMetric } from "@mastra/evals/llm";

// Configure the model for evaluation
const model = {
  provider: "OPEN_AI",
  name: "gpt-4o",
  apiKey: process.env.OPENAI_API_KEY
};

const metric = new SummarizationMetric(model);

const result = await metric.measure({
  input: "The company was founded in 1995 by John Smith. It started with 10 employees and grew to 500 by 2020. The company is based in Seattle.",
  output: "Founded in 1995 by John Smith, the company grew from 10 to 500 employees by 2020."
});

console.log(result.score); // Score from 0-1
console.log(result.reason); // Explanation of the score
```

## Constructor Parameters

<PropertiesTable
  content={[
    {
      name: "model",
      type: "ModelConfig",
      description: "Configuration for the model used to evaluate summaries",
      isOptional: false,
    },
    {
      name: "options",
      type: "SummarizationMetricOptions",
      description: "Configuration options for the metric",
      isOptional: true,
      defaultValue: "{ scale: 1 }",
    }
  ]}
/>

### SummarizationMetricOptions

<PropertiesTable
  content={[
    {
      name: "scale",
      type: "number",
      description: "Maximum score value",
      isOptional: true,
      defaultValue: "1",
    }
  ]}
/>

## measure() Parameters

<PropertiesTable
  content={[
    {
      name: "input",
      type: "string",
      description: "The original text to be summarized",
      isOptional: false,
    },
    {
      name: "output",
      type: "string",
      description: "The generated summary to evaluate",
      isOptional: false,
    }
  ]}
/>

## Returns

<PropertiesTable
  content={[
    {
      name: "score",
      type: "number",
      description: "Summarization score (0 to scale, default 0-1)",
    },
    {
      name: "reason",
      type: "string",
      description: "Detailed explanation of the score, including both alignment and coverage aspects",
    }
  ]}
/>

## Scoring Details

The metric evaluates summaries through two components:

1. **Alignment Score**: Measures factual correctness
   - Extracts claims from the summary
   - Verifies each claim against the original text
   - Assigns "yes", "no", or "unsure" verdicts
   - Score = (number of supported claims) / (total claims)

2. **Coverage Score**: Measures inclusion of key information
   - Generates key questions from the original text
   - Checks if the summary answers these questions
   - Score = (number of answerable questions) / (total questions)

The final score is calculated as: `min(alignmentScore, coverageScore)`

Score interpretation:
- 1.0: Perfect summary - completely factual and covers all key information
- 0.7-0.9: Strong summary with minor omissions or slight inaccuracies
- 0.4-0.6: Moderate quality with significant gaps or inaccuracies
- 0.1-0.3: Poor summary with major omissions or factual errors
- 0: Invalid summary - either completely inaccurate or missing critical information

## Example with Analysis

```typescript
const metric = new SummarizationMetric(model);

const result = await metric.measure({
  input: "The electric car company Tesla was founded in 2003 by Martin Eberhard and Marc Tarpenning. Elon Musk joined in 2004 as the largest investor and became CEO in 2008. The company's first car, the Roadster, was launched in 2008.",
  output: "Tesla, founded by Elon Musk in 2003, revolutionized the electric car industry starting with the Roadster in 2008."
});

// Example output:
// {
//   score: 0.5,
//   reason: "The score is 0.5 because while the coverage is good (0.75) - mentioning the founding year, 
//           first car model, and launch date - the alignment score is lower (0.5) due to incorrectly 
//           attributing the company's founding to Elon Musk instead of Martin Eberhard and Marc Tarpenning. 
//           The final score takes the minimum of these two scores to ensure both factual accuracy and 
//           coverage are necessary for a good summary."
// }
```

## Related

- [Faithfulness Metric](./faithfulness)
- [Answer Relevancy Metric](./answer-relevancy)
- [Completeness Metric](./completeness) 