---
title: "Example: Context Position | Evals | Mastra Docs"
description: Example of using the Context Position metric to evaluate sequential ordering in responses.
---

import { GithubLink } from "../../../components/github-link";

# Context Position

This example demonstrates how to use Mastra's Context Position metric to evaluate how well responses maintain the sequential order of information.

## Overview

The example shows how to:

1. Configure the Context Position metric
2. Evaluate position adherence
3. Analyze sequential ordering
4. Handle different sequence types

## Setup

### Environment Setup

Make sure to set up your environment variables:

```bash filename=".env"
OPENAI_API_KEY=your_api_key_here
```

### Dependencies

Import the necessary dependencies:

```typescript copy showLineNumbers filename="src/index.ts"
import { openai } from '@ai-sdk/openai';
import { ContextPositionMetric } from '@mastra/evals/llm';
```

## Example Usage

### High Position Adherence Example

Evaluate a response that follows sequential steps:

```typescript copy showLineNumbers{5} filename="src/index.ts"
const context1 = [
  'First, preheat the oven to 350°F.',
  'Next, mix the dry ingredients in a bowl.',
  'Then, add the wet ingredients and stir well.',
  'Finally, bake for 25 minutes until golden brown.',
];

const metric1 = new ContextPositionMetric(openai('gpt-4o-mini'), {
  context: context1,
});

const query1 = 'How do I bake this recipe?';
const response1 = 'To make this recipe, start by preheating your oven to 350°F. After that, combine all dry ingredients in a mixing bowl. Next, add your wet ingredients and mix thoroughly. The last step is to bake everything for 25 minutes until you get a nice golden brown color.';

const result1 = await metric1.measure(query1, response1);
console.log('Metric Result:', {
  score: result1.score,
  reason: result1.info.reason,
});
```

### Mixed Position Adherence Example

Evaluate a response with partial sequential ordering:

```typescript copy showLineNumbers{31} filename="src/index.ts"
const context2 = [
  'Rome was founded in 753 BCE.',
  'The Roman Republic began in 509 BCE.',
  'Julius Caesar became dictator in 49 BCE.',
  'Augustus established the Empire in 27 BCE.',
];

const metric2 = new ContextPositionMetric(openai('gpt-4o-mini'), {
  context: context2,
});

const query2 = 'Describe the history of Rome.';
const response2 = 'The Roman Empire was established by Augustus in 27 BCE, following Julius Caesar\'s dictatorship in 49 BCE. This was all possible because of Rome\'s founding in 753 BCE and the subsequent Republic in 509 BCE.';

const result2 = await metric2.measure(query2, response2);
console.log('Metric Result:', {
  score: result2.score,
  reason: result2.info.reason,
});
```

### Low Position Adherence Example

Evaluate a response that reverses sequential order:

```typescript copy showLineNumbers{57} filename="src/index.ts"
const context3 = [
  'Step 1: Open the application.',
  'Step 2: Click on Settings.',
  'Step 3: Select Network options.',
  'Step 4: Enable Wi-Fi.',
];

const metric3 = new ContextPositionMetric(openai('gpt-4o-mini'), {
  context: context3,
});

const query3 = 'How do I connect to Wi-Fi?';
const response3 = 'To connect to Wi-Fi, enable it in Network options. Before that, you\'ll need to go to Settings after launching the application.';

const result3 = await metric3.measure(query3, response3);
console.log('Metric Result:', {
  score: result3.score,
  reason: result3.info.reason,
});
```

## Understanding the Results

The metric provides:

1. A position score between 0 and 1:
   - 1.0: Perfect sequential ordering - follows exact sequence
   - 0.7-0.9: Strong sequential flow - mostly maintains order
   - 0.4-0.6: Mixed sequential flow - partial order preservation
   - 0.1-0.3: Weak sequential flow - minimal order adherence
   - 0.0: No sequential ordering - completely reversed or random

2. Detailed analysis of:
   - Sequential ordering adherence
   - Information flow consistency
   - Position-based relationships
   - Order preservation quality

<br />
<br />
<hr className="dark:border-[#404040] border-gray-300" />
<br />
<br />
<GithubLink
  link={
    "https://github.com/mastra-ai/mastra/blob/main/examples/basics/evals/context-position"
  }
/>
