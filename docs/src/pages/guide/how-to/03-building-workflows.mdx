# Workflows in Mastra

Workflows are graph-based state machines that can execute complex sequences of operations. They provide a structured way to handle multi-step processes, parallel operations, and (soon) suspend-and-resume for human interactions.

Workflows are defined in a dedicated directory. The directory path is configured in your Mastra config file. When you use workflows with cloud observability providers, you can see the inputs and outputs of each step.

## Building a Workflow

Here's an simple example of a workflow that uses predefined tools to crawl a website, uses an LLM to structure the data, and then analyzes the sentiment of the content.

```typescript filename="src/workflows/index.ts"
import { Workflow } from '@mastra/core';
import { z } from 'zod';

export const contentWorkflow = new Workflow('content-review');

contentWorkflow
  .setTriggerSchema(
    z.object({
      url: z.string().url(),
    }),
  )
  .addStep('crawl', {
    action: async ({ tools, data }) => {
      const result = await tools.crawlWebpage({ url: data.url });
      return { rawText: result.text };
    },
    transitions: {
      structure: {
        condition: {
          ref: { stepId: 'crawl', path: 'rawText' },
          query: { $exists: true },
        },
      },
    },
  })
  .addStep('structure', {
    action: async ({ tools, data }) => {
      const result = await tools.structureReviews({ rawText: data.rawText });
      return { reviews: result };
    },
    variables: {
      rawText: { stepId: 'crawl', path: 'rawText' },
    },
  })
  .commit();
```

### Register with Mastra

```typescript filename="src/mastra/index.ts"
import { contentWorkflow } from '../workflows';

export const mastra = new Mastra({
  ...restOfConfig,
  workflows: [contentWorkflow],
});
```

### Execute the workflow

// Execute the workflow

```typescript filename="src/index.ts"
import { contentWorkflow } from './workflows';

const result = await contentWorkflow.execute({
  url: 'https://example.com/reviews',
});
```

## Reference Documentation

More detailed documentation on transitions, conditions, variables, steps, and validation can be found in the reference docs:

- [Workflows](https://mastra.ai/docs/guide/reference/workflows/workflow)
- [Steps](https://mastra.ai/docs/guide/reference/workflows/step)
- [Transitions](https://mastra.ai/docs/guide/reference/workflows/transition)
