# Building Workflows

When building AI applications, you sometimes need to build complex responses from chains, or graphs, of LLM calls:
- multi-step LLM chains where each step feeds into the next
- parallel API calls that need to merge into a single response
- long-running processes paused for human input 
- error handling/branching that depends on the output of previous steps.

Workflows provide a way to structure your code to handle these cases. Workflows are available as a tool for agents or other workflows.

## The blueprints folder

The initial `mastra init` command creates a `blueprints` directory in your project and links it in your `mastra.config.ts` file.

```ts filename="mastra.config.ts"
export const config: Config = {
  ...mastraConfig,
  workflows: {
    blueprintDirPath: '/mastra/blueprints',
    ...
  }
}
```

In a file in your `blueprints` directory, you can create a new workflow by adding the following code:

```json filename="get-mathematicians.json"
{
  "title": "Get Mathematicians",
  "status": "PUBLISHED",
  "id": "get-mathematicians",
  "actions": [
    {
      "id": "grab_content",
      "type": "execute_site_crawl_sync",
      "parentActionId": "",
      "payload": {
        "mastraConnectionId": "SYSTEM",
        "url": "https://en.wikipedia.org/wiki/Fermat%27s_Last_Theorem",
        "entityType": "mathematicians"
      },
      "variables": {},
      "subActions": [
        {
          "id": "list_contributors",
          "type": "message_agent",
          "parentActionId": "grab_content",
          "payload": {
            "agentId": "got-4o",
            "message": "Please list all mathematicians who have contributed to the theorem mentioned in the content above: {{content}}"
          },
          "variables": {
            "content": {
              "refBlockId": "grab_content",
              "path": "content"
            }
          },
          "subActions": []
        }
      ]
    }
  ]
}
```

{/*
```typescript:mastra/blueprints/get-mathematicians.ts
import { Workflow, SCRAPE_WEB, CALL_MODEL } from "mastra";

export const workflow = new Workflow("get-mathematicians")

const grabContent = workflow.addStep({ type: SCRAPE_WEB, url: "https://en.wikipedia.org/wiki/Fermat%27s_Last_Theorem"})

const listContributors = grabContent.connect({ type: CALL_MODEL, model: 'got-4o', prompt: "Please list all mathematicians who have contributed to the theorem mentioned in the content above: {{content}}"}) 
```
*/}

## Using the admin console

TKTK


