---
title: "例: システムプロンプトの変更 | エージェント | Mastra ドキュメント"
description: システムプロンプトで性格や能力を定義して AI エージェントを作成する Mastra の例。
---

import GithubLink from "@site/src/components/GithubLink";


<div id="changing-the-system-prompt">
  # システムプロンプトの変更
</div>

エージェントを作成する際、`instructions` はその振る舞いの基本的なルールを定義します。エージェントの役割や性格、全体的な方針を定め、すべてのやり取りで一貫して適用されます。元の `instructions` を変更せずに、特定のリクエストでエージェントの応答に影響を与えるために、`.generate()` に `system` プロンプトを渡すことができます。

この例では、`system` プロンプトを使ってエージェントの文体をハリー・ポッターのさまざまなキャラクター風に切り替え、コア設定を変えずに同じエージェントがスタイルを柔軟に適応できることを示します。

<div id="prerequisites">
  ## 前提条件
</div>

この例では `openai` モデルを使用します。`.env` ファイルに `OPENAI_API_KEY` を追加してください。

```bash title=".env" copy
OPENAI_API_KEY=<your-api-key>
```


<div id="creating-an-agent">
  ## エージェントの作成
</div>

エージェントを定義し、`instructions` を指定します。これはデフォルトの動作を定め、実行時にシステムプロンプトが与えられていない場合の応答方法を記述します。

```typescript title="src/mastra/agents/example-harry-potter-agent.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";

export const harryPotterAgent = new Agent({
  name: "harry-potter-agent",
  description:
    "ハリー・ポッターの世界観に基づいたキャラクター風の応答を提供します。",
  instructions: `あなたはハリー・ポッターの世界のキャラクターボイスアシスタントです。
    指定されたキャラクター(例:ハリー、ハーマイオニー、ロン、ダンブルドア、スネイプ、ハグリッド)の話し方で返答してください。
    キャラクターが指定されていない場合は、デフォルトでハリー・ポッターとして応答してください。`,
  model: openai("gpt-4o"),
});
```

> 構成オプションの一覧については、[Agent](/reference/agents/agent) を参照してください。


<div id="registering-an-agent">
  ## エージェントの登録
</div>

エージェントを使用するには、メインの Mastra インスタンスに登録してください。

```typescript title="src/mastra/index.ts" showLineNumbers copy
import { Mastra } from "@mastra/core/mastra";

import { harryPotterAgent } from "./agents/example-harry-potter-agent";

export const mastra = new Mastra({
  // ...
  agents: { harryPotterAgent },
});
```


<div id="default-character-response">
  ## 既定のキャラクター応答
</div>

`getAgent()` を使ってエージェントを取得し、プロンプトを渡して `generate()` を呼び出します。手順で定義されているとおり、キャラクターが指定されていない場合、このエージェントは Harry Potter の声を既定として使用します。

```typescript title="src/test-harry-potter-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const agent = mastra.getAgent("harryPotterAgent");

const response = await agent.generate(
  "ホグワーツで一番好きな部屋は何ですか?",
);

console.log(response.text);
```


<div id="changing-the-character-voice">
  ### キャラクターの声を切り替える
</div>

実行時に別の system prompt を指定すると、エージェントの声を別のキャラクターに切り替えられます。これにより、元の指示はそのままに、そのリクエストに対するエージェントの応答の仕方だけが変わります。

```typescript {9-10} title="src/test-harry-potter-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const agent = mastra.getAgent("harryPotterAgent");

const response = await agent.generate([
  {
    role: "system",
    content: "あなたはドラコ・マルフォイです。",
  },
  {
    role: "user",
    content: "ホグワーツで一番好きな部屋はどこですか?",
  },
]);

console.log(response.text);
```

<GithubLink outdated={true} marginTop="mt-16" link="https://github.com/mastra-ai/mastra/blob/main/examples/basics/agents/system-prompt" />


<div id="related">
  ## 関連項目
</div>

- [エージェントの呼び出し](./calling-agents)