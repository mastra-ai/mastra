---
title: "例: スーパーバイザーエージェント | エージェント | Mastra ドキュメント"
description: Mastra を使ってスーパーバイザーエージェントを作成し、エージェント同士がツール関数を通じてやり取りする例。
---

import GithubLink from "@site/src/components/GithubLink";


<div id="supervisor-agent">
  # 監督エージェント
</div>

複雑な AI アプリケーションを構築する際には、タスクの異なる側面に対して複数の専門エージェントが連携する必要がよくあります。監督エージェントは、あるエージェントが監督者として機能し、各自の専門分野に特化した他のエージェントの作業を調整できるようにする仕組みです。この構造により、エージェント同士が委任や協働を行い、単一のエージェントでは実現できない高度な成果を生み出せます。

この例では、このシステムは 3 つのエージェントで構成されています:

1. 初稿を作成する [**Copywriter エージェント**](#copywriter-agent)。
2. コンテンツを推敲・改良する [**Editor エージェント**](#editor-agent)。
3. 他のエージェントを監督・調整する [**Publisher エージェント**](#publisher-agent)。

<div id="prerequisites">
  ## 前提条件
</div>

この例では `openai` モデルを使用します。`OPENAI_API_KEY` を `.env` ファイルに追加してください。

```bash title=".env" copy
OPENAI_API_KEY=<your-api-key>
```


<div id="copywriter-agent">
  ## コピーライターエージェント
</div>

この `copywriterAgent` は、指定されたトピックに基づいてブログ記事の初稿を作成する役割を担います。

```typescript title="src/mastra/agents/example-copywriter-agent.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";

export const copywriterAgent = new Agent({
  name: "copywriter-agent",
  instructions: "あなたはブログ記事を執筆するコピーライターエージェントです。",
  model: openai("gpt-4o"),
});
```


<div id="copywriter-tool">
  ## コピーライターツール
</div>

`copywriterTool` は `copywriterAgent` を呼び出すためのインターフェースを提供し、`topic` を渡します。

```typescript title="src/mastra/tools/example-copywriter-tool.ts"
import { createTool } from "@mastra/core/tools";
import { z } from "zod";

export const copywriterTool = createTool({
  id: "copywriter-agent",
  description: "ブログ記事の文章を作成するためにコピーライターエージェントを呼び出します。",
  inputSchema: z.object({
    topic: z.string(),
  }),
  outputSchema: z.object({
    copy: z.string(),
  }),
  execute: async ({ context, mastra }) => {
    const { topic } = context;

    const agent = mastra!.getAgent("copywriterAgent");
    const result = await agent!.generate(`${topic}に関するブログ記事を作成`);

    return {
      copy: result.text,
    };
  },
});
```


<div id="editor-agent">
  ## 編集エージェント
</div>

この `editorAgent` は初稿を受け取り、品質と読みやすさを高めるために文章を磨き上げます。

```typescript title="src/mastra/agents/example-editor-agent.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";

export const editorAgent = new Agent({
  name: "Editor",
  instructions: "あなたはブログ記事を編集するエージェントです。",
  model: openai("gpt-4o-mini"),
});
```


<div id="editor-tool">
  ## エディター ツール
</div>

`editorTool` は `editorAgent` を呼び出すためのインターフェースを提供し、`copy` を渡します。

```typescript title="src/mastra/tools/example-editor-tool.ts" showLineNumbers copy
import { createTool } from "@mastra/core/tools";
import { z } from "zod";

export const editorTool = createTool({
  id: "editor-agent",
  description: "ブログ記事の本文を編集するためにエディターエージェントを呼び出します。",
  inputSchema: z.object({
    copy: z.string(),
  }),
  outputSchema: z.object({
    copy: z.string(),
  }),
  execute: async ({ context, mastra }) => {
    const { copy } = context;

    const agent = mastra!.getAgent("editorAgent");
    const result = await agent.generate(
      `次のブログ記事を編集し、編集後の本文のみを返してください: ${copy}`,
    );

    return {
      copy: result.text,
    };
  },
});
```


<div id="publisher-agent">
  ## Publisher エージェント
</div>

この `publisherAgent` は、最初に `copywriterTool` を、その後に `editorTool` を呼び出して、プロセス全体を統括します。

```typescript title="src/mastra/agents/example-publisher-agent.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";

import { copywriterTool } from "../tools/example-copywriter-tool";
import { editorTool } from "../tools/example-editor-tool";

export const publisherAgent = new Agent({
  name: "publisherAgent",
  instructions:
    "あなたは、まず特定のトピックについてブログ記事の文章を書くためにコピーライターエージェントを呼び出し、次にその文章を編集するためにエディターエージェントを呼び出すパブリッシャーエージェントです。最終的に編集された文章のみを返してください。",
  model: openai("gpt-4o-mini"),
  tools: { copywriterTool, editorTool },
});
```


<div id="registering-the-agents">
  ## エージェントの登録
</div>

3つのエージェントはすべてメインの Mastra インスタンスに登録され、互いに参照・利用できるようになります。

```typescript title="src/mastra/index.ts" showLineNumbers copy
import { Mastra } from "@mastra/core/mastra";

import { publisherAgent } from "./agents/example-publisher-agent";
import { copywriterAgent } from "./agents/example-copywriter-agent";
import { editorAgent } from "./agents/example-editor-agent";

export const mastra = new Mastra({
  agents: { copywriterAgent, editorAgent, publisherAgent },
});
```


<div id="example-usage">
  ## 使用例
</div>

`getAgent()` でエージェントの参照を取得し、`generate()` にプロンプトを渡して呼び出します。

```typescript title="src/test-publisher-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const agent = mastra.getAgent("publisherAgent");

const response = await agent.generate(
  "React JavaScriptフレームワークに関するブログ記事を書いてください。最終的な編集済みの原稿のみを返してください。",
);

console.log(response.text);
```

<GithubLink outdated={true} marginTop="mt-16" link="https://github.com/mastra-ai/mastra/blob/main/examples/basics/agents/hierarchical-multi-agent" />


<div id="related">
  ## 関連項目
</div>

- [エージェントの呼び出し](./calling-agents)