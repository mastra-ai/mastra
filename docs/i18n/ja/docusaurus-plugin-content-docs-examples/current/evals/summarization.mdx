---
title: "例：要約の評価 | Evals | Mastra Docs"
description: 事実関係の正確さを保ちながら、LLM が生成した要約が内容をどれだけ適切に捉えているかを、Summarization 指標で評価する例。
---

# 要約の評価

:::note
Scorers API は現在ベータ版です。改良を進めており、皆さまからのフィードバックを歓迎します。ご質問や機能リクエストは [Discord](https://discord.gg/mastra) までお寄せください。
:::

`SummarizationMetric` を使用すると、応答がソースの要点をどれだけ的確に捉え、事実関係を維持しているかを評価できます。この指標は `query` と `response` を受け取り、スコアと、理由・アラインメントスコア・カバレッジスコアを含む `info` オブジェクトを返します。

## インストール

```bash copy
npm install @mastra/evals
```


## 正確な要約の例

この例では、要約が元の文書の重要な事実をすべて正確に保持しつつ、表現も忠実に再現しています。スコアは、完全な網羅性と事実関係の完全な一致の両方を反映しています。

```typescript title="src/example-accurate-summary.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { SummarizationMetric } from "@mastra/evals/llm";

const metric = new SummarizationMetric(openai("gpt-4o-mini"));

const query =
  "電気自動車メーカーのTeslaは、2003年にMartin EberhardとMarc Tarpenningによって設立されました。Elon Muskは2004年に最大の投資家として参加し、2008年にCEOに就任しました。同社初の車種であるRoadsterは、2008年に発売されました。";
const response =
  "Teslaは、2003年にMartin EberhardとMarc Tarpenningによって設立され、2008年に初の車種であるRoadsterを発売しました。Elon Muskは2004年に最大の投資家として参加し、2008年にCEOに就任しました。";

const result = await metric.measure(query, response);
```


### 正確な要約の出力

高スコアは、要約が入力の重要な要点を過不足なく捉え、誤りを生じていないことを示します。`info` フィールドは、完全な整合性と網羅性を確認します。

```typescript
{
  score: 1,
  info: {
    reason: 'スコアが1であるのは、要約が完全に事実に即しており、元のテキストの主要な情報をすべてカバーしているためです。',
    alignmentScore: 1,
    coverageScore: 1
  }
}
```


## 部分的な要約の例

この例では、要約は事実関係としては正確ですが、元の内容のいくつかの重要な点が欠けています。スコアは、整合性は高い一方で、網羅性が不十分であることを反映しています。

```typescript title="src/example-partial-summary.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { SummarizationMetric } from "@mastra/evals/llm";

const metric = new SummarizationMetric(openai("gpt-4o-mini"));

const query =
  "Pythonプログラミング言語はGuido van Rossumによって作成され、1991年に初めてリリースされました。特徴的なインデント(空白)の使用により、コードの可読性を重視しています。Pythonは動的型付けでガベージコレクションを備えています。構造化プログラミング、オブジェクト指向プログラミング、関数型プログラミングなど、複数のプログラミングパラダイムをサポートしています。";
const response =
  "Guido van Rossumによって作成されたPythonは、読みやすいコードとインデント(空白)の使用で知られるプログラミング言語です。1991年にリリースされました。";

const result = await metric.measure(query, response);

console.log(result);
```


### 部分的な要約出力

この要約は、入力の重要な情報が欠けているため、評価は中程度にとどまっています。`info` フィールドは事実関係の整合性を確認している一方で、内容のカバレッジに不足があることを指摘しています。

```typescript
{
  score: 0.7,
  info: {
    reason: "スコアが0.7なのは、要約がPythonの誕生、リリース日、可読性の重視といった重要な事実を正確に押さえ、整合性スコアで満点を達成しているためです。ただし、Pythonが動的型付けであり、ガベージコレクションを備え、複数のプログラミングパラダイムをサポートしている点に触れていないため、網羅性スコアが下がっています。",
    alignmentScore: 1,
    coverageScore: 0.7
  }
}
```


## 不正確な要約の例

この例では、要約に事実誤りが含まれており、元の内容の重要な点を誤って伝えています。情報の一部が部分的に触れられていても、スコアは整合性の低さを反映しています。

```typescript title="src/example-inaccurate-summary.ts" showLineNumbers copy
import { openai } from "@ai-sdk/openai";
import { SummarizationMetric } from "@mastra/evals/llm";

const metric = new SummarizationMetric(openai("gpt-4o-mini"));

const query =
  "World Wide Webは、1989年にCERNで働いていたTim Berners-Leeによって発明されました。彼は1991年に最初のウェブサイトを公開しました。Berners-Leeは特許やロイヤリティを請求することなく、Webを無償で公開しました。";
const response =
  "インターネットは1990年代初頭にMITでTim Berners-Leeによって作成され、彼はその後特許を通じてこの技術を商業化しました。";

const result = await metric.measure(query, response);

console.log(result);
```


### 不正確な要約出力

この要約は、事実関係の誤りや入力との不整合により、低評価となります。`info` フィールドでは、どの点が誤っていたか、また要約が元のソースからどのように逸脱していたかが説明されています。

```typescript
{
  score: 0,
  info: {
    reason: 'スコアが0であるのは、要約に事実の誤りがあり、原文の重要な点を十分にカバーしていないためです。インターネットが1990年代初頭にMITで作られたという主張は、World Wide Webが1989年にCERNで発明されたとする原文の記述と矛盾しています。さらに、要約はBerners-Leeが特許によってこの技術を商業化したと誤って述べていますが、原文では彼が特許やロイヤリティを課さずにWebを自由に公開したことが明確に示されています。',
    alignmentScore: 0,
    coverageScore: 0.17
  }
}
```


## メトリクスの設定

モデルを指定するだけで `SummarizationMetric` インスタンスを作成できます。追加の設定は不要です。

```typescript showLineNumbers copy
const metric = new SummarizationMetric(openai("gpt-4o-mini"));
```

> 設定オプションの全一覧は [SummarizationMetric](/reference/evals/summarization) を参照してください。


## 結果の理解

`SummarizationMetric` は次の形の結果を返します：

```typescript
{
  score: number,
  info: {
    reason: 文字列,
    alignmentScore: number,
    coverageScore: number
  }
}
```


### 要約スコア

要約スコアは 0〜1 の範囲です:

- **1.0**: 完璧な要約 – 完全に正確で抜けがない。
- **0.7–0.9**: 良質な要約 – わずかな抜けや軽微な不正確さがある。
- **0.4–0.6**: まずまずの要約 – 一部は正確だが不完全。
- **0.1–0.3**: 弱い要約 – 重大な抜けや誤りがある。
- **0.0**: 失敗した要約 – ほとんど不正確、または重要な内容が欠けている。

### 要約に関する情報

スコアの説明（以下を含む）:

- 入力の事実内容との整合性
- 元のソースにおける重要ポイントのカバー状況
- 整合性とカバー範囲の個別スコア
- 何が保持され、何が省かれ、何が誤って記述されたかの根拠

<GithubLink
  outdated={true}
  marginTop="mt-16"
  link="https://github.com/mastra-ai/mastra/blob/main/examples/basics/evals/summarization"
/>