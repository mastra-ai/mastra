---
title: "例: トーン一貫性の評価 | Evals | Mastra Docs"
description: テキストの感情トーンのパターンと感情の一貫性を評価するために、Tone Consistency 指標を用いる例。
---

<div id="tone-consistency-evaluation">
  # トーン一貫性の評価
</div>

:::note
Scorers API は現在ベータ版です。改善に継続的に取り組んでおり、皆さまのフィードバックを歓迎します。ご質問や機能リクエストは [Discord](https://discord.gg/mastra) までお寄せください。
:::

`ToneConsistencyMetric` を使用して、テキストにおける感情トーンのパターンとセンチメントの一貫性を評価します。メトリクスは `query` と `response` を受け取り、スコアと、センチメントスコアおよびその差分を含む `info` オブジェクトを返します。

<div id="installation">
  ## インストール
</div>

```bash copy
npm install @mastra/evals
```


<div id="positive-tone-example">
  ## ポジティブなトーンの例
</div>

この例では、テキストはいずれも似たような前向きなトーンを示しています。指標はトーンの一致度を測定し、その結果として高いスコアが得られます。

```typescript title="src/example-positive-tone.ts" showLineNumbers copy
import { ToneConsistencyMetric } from "@mastra/evals/nlp";

const metric = new ToneConsistencyMetric();

const query = "この製品は素晴らしくて最高です!";
const response = "この製品は優れていて素敵です!";

const result = await metric.measure(query, response);

console.log(result);
```


<div id="positive-tone-output">
  ### ポジティブなトーンの出力
</div>

この指標は、感情の整合性が高いことを示す高スコアを返します。`info` フィールドには、感情値とその差分が含まれます。

```typescript
{
  score: 0.8333333333333335,
  info: {
    responseSentiment: 1.3333333333333333,
    referenceSentiment: 1.1666666666666667,
    difference: 0.16666666666666652
  }
}
```


<div id="stable-tone-example">
  ## 安定したトーンの例
</div>

この例では、空のレスポンスを渡してテキスト内のトーンの一貫性を分析します。これにより、メトリクスは単一の入力テキストにおける感情の安定性を評価し、全体を通してトーンがどれだけ均一かを示すスコアが得られます。

```typescript title="src/example-stable-tone.ts" showLineNumbers copy
import { ToneConsistencyMetric } from "@mastra/evals/nlp";

const metric = new ToneConsistencyMetric();

const query = "素晴らしいサービス!親切なスタッフ。完璧な雰囲気。";
const response = "";

const result = await metric.measure(query, response);

console.log(result);
```


<div id="stable-tone-output">
  ### 安定したトーンの出力
</div>

この指標は高いスコアを返し、入力テキスト全体で感情が一貫していることを示します。`info` フィールドには平均感情値と感情分散が含まれ、トーンの安定性を反映します。

```typescript
{
  score: 0.9444444444444444,
  info: {
    avgSentiment: 1.3333333333333333,
    sentimentVariance: 0.05555555555555556
  }
}
```


<div id="mixed-tone-example">
  ## トーンが混在する例
</div>

この例では、入力と応答の感情トーンが異なります。メトリクスはこうした差異を検出し、一貫性スコアを低めに評価します。

```typescript title="src/example-mixed-tone.ts" showLineNumbers copy
import { ToneConsistencyMetric } from "@mastra/evals/nlp";

const metric = new ToneConsistencyMetric();

const query =
  "インターフェースは使いづらく分かりにくいが、可能性はある。";
const response =
  "デザインには将来性があるが、使いやすくするには大幅な改善が必要だ。";

const result = await metric.measure(query, response);

console.log(result);
```


<div id="mixed-tone-output">
  ### トーンが混在した出力
</div>

感情トーンに顕著な差があるため、このメトリクスは低いスコアを返します。`info` フィールドには、各感情の値とそれらの変動の度合いが示されます。

```typescript
{
  score: 0.4181818181818182,
  info: {
    responseSentiment: -0.4,
    referenceSentiment: 0.18181818181818182,
    difference: 0.5818181818181818
  }
}
```


<div id="metric-configuration">
  ## メトリックの設定
</div>

`ToneConsistencyMetric` インスタンスはデフォルト設定のまま作成できます。追加の設定は不要です。

```typescript
const metric = new ToneConsistencyMetric();
```

> 設定オプションの一覧については、[ToneConsistencyMetric](/reference/evals/tone-consistency) を参照してください。


<div id="understanding-the-results">
  ## 結果の理解
</div>

`ToneConsistencyMetric` は次の形式の結果を返します:

```typescript
{
  score: 数値,
  info: {
    responseSentiment?: 数値,
    referenceSentiment?: 数値,
    difference?: 数値,
    avgSentiment?: 数値,
    sentimentVariance?: 数値
  }
}
```


<div id="tone-consistency-score">
  ### トーンの一貫性スコア
</div>

トーンの一貫性スコアは 0 から 1 の範囲です:

- **0.8–1.0**: トーンが非常に一貫している。
- **0.6–0.7**: トーンがおおむね一貫している。
- **0.4–0.5**: トーンにばらつきがある。
- **0.0–0.3**: トーンが相反している。

<div id="tone-consistency-info">
  ### 口調の一貫性に関する情報
</div>

スコアの説明。詳細は以下を含みます：

- 入力と応答のセンチメントの整合
- 単一テキスト内での口調の安定性
- センチメントの差やばらつきの程度

<GithubLink
  outdated={true}
  marginTop="mt-16"
  link="https://github.com/mastra-ai/mastra/blob/main/examples/basics/evals/tone-consistency"
/>