---
title: "リファレンス: Configuration | Observability | Mastra ドキュメント"
description: AI トレーシングの設定タイプとレジストリ関数
---

import PropertiesTable from "@site/src/components/PropertiesTable";


<div id="configuration">
  # 設定
</div>

<div id="observabilityregistryconfig">
  ## ObservabilityRegistryConfig
</div>

```typescript
interface ObservabilityRegistryConfig {
  default?: { enabled?: boolean };
  configs?: Record<string, TracingConfig | AITracing>;
  configSelector?: ConfigSelector;
}
```

<PropertiesTable
  props={[
{
  name: "default",
  type: "{ enabled?: boolean }",
  description: "デフォルト設定を有効化",
  required: false,
},
{
  name: "configs",
  type: "Record<string, TracingConfig | AITracing>",
  description: "名前付きトレーシング設定",
  required: false,
},
{
  name: "configSelector",
  type: "ConfigSelector",
  description: "実行時設定セレクター",
  required: false,
},
]}
/>


<div id="tracingconfig">
  ## TracingConfig（トレース設定）
</div>

```typescript
interface TracingConfig {
  name: string;
  serviceName: string;
  sampling?: SamplingStrategy;
  exporters?: AITracingExporter[];
  processors?: AISpanProcessor[];
}
```

<PropertiesTable
  props={[
{
  name: "name",
  type: "string",
  description: "設定識別子",
  required: true,
},
{
  name: "serviceName",
  type: "string",
  description: "トレース上のサービス名",
  required: true,
},
{
  name: "sampling",
  type: "SamplingStrategy",
  description: "サンプリング設定",
  required: false,
},
{
  name: "exporters",
  type: "AITracingExporter[]",
  description: "トレースデータのエクスポータ",
  required: false,
},
{
  name: "processors",
  type: "AISpanProcessor[]",
  description: "スパン処理器",
  required: false,
},
]}
/>


<div id="samplingstrategy">
  ## サンプリング戦略
</div>

```typescript
type SamplingStrategy =
  | { type: "always" }
  | { type: "never" }
  | { type: "ratio"; probability: number }
  | { type: "custom"; sampler: (options?: TracingOptions) => boolean };
```


<div id="configselector">
  ## ConfigSelector
</div>

```typescript
type ConfigSelector = (
  options: ConfigSelectorOptions,
  availableConfigs: Map<string, AITracing>,
) => string | undefined;
```


<div id="configselectoroptions">
  ## ConfigSelectorOptions（設定セレクターオプション）
</div>

```typescript
interface ConfigSelectorOptions {
  metadata?: Record<string, any>;
  requestContext?: Map<string, any>;
}
```


<div id="registry-functions">
  # レジストリの関数
</div>

<div id="setupaitracing">
  ## setupAITracing
</div>

```typescript
function setupAITracing(config: ObservabilityRegistryConfig): void;
```

設定に基づいて AI トレースを初期化します。Mastra のコンストラクターによって自動的に呼び出されます。


<div id="registeraitracing">
  ## registerAITracing
</div>

```typescript
function registerAITracing(
  name: string,
  instance: AITracing,
  isDefault?: boolean,
): void;
```

グローバルレジストリにトレーシング構成を登録します。


<div id="getaitracing">
  ## getAITracing
</div>

```typescript
function getAITracing(name: string): AITracing | undefined;
```

名前を指定してトレース設定を取得します。


<div id="getdefaultaitracing">
  ## getDefaultAITracing
</div>

```typescript
function getDefaultAITracing(): AITracing | undefined;
```

デフォルトのトレース設定を返します。


<div id="getselectedaitracing">
  ## getSelectedAITracing
</div>

```typescript
function getSelectedAITracing(
  options: ConfigSelectorOptions,
): AITracing | undefined;
```

config セレクターで選択されたトレーシング設定、またはデフォルトの設定を返します。


<div id="setselector">
  ## setSelector
</div>

```typescript
function setSelector(selector: ConfigSelector): void;
```

グローバルな config セレクター関数を設定する。


<div id="unregisteraitracing">
  ## unregisterAITracing
</div>

```typescript
function unregisterAITracing(name: string): boolean;
```

レジストリからトレース設定を削除します。


<div id="shutdownaitracingregistry">
  ## shutdownAITracingRegistry
</div>

```typescript
async function shutdownAITracingRegistry(): Promise<void>;
```

すべてのトレース設定を停止し、レジストリをクリアします。


<div id="clearaitracingregistry">
  ## clearAITracingRegistry
</div>

```typescript
function clearAITracingRegistry(): void;
```

シャットダウンせずにすべての設定を消去します。


<div id="getallaitracing">
  ## getAllAITracing
</div>

```typescript
function getAllAITracing(): ReadonlyMap<string, AITracing>;
```

登録されているすべてのトレーシング設定を返します。


<div id="hasaitracing">
  ## hasAITracing
</div>

```typescript
function hasAITracing(name: string): boolean;
```

トレーシングインスタンスが存在し、有効になっているかを確認します。


<div id="see-also">
  ## 参照
</div>

<div id="documentation">
  ### ドキュメント
</div>

- [AI Tracing の概要](/docs/observability/ai-tracing/overview) - 概念と使用ガイド
- [サンプリング戦略](/docs/observability/ai-tracing/overview#sampling-strategies) - サンプリング設定の詳細
- [複数設定のセットアップ](/docs/observability/ai-tracing/overview#multi-config-setup) - 複数の設定の使い方

<div id="reference">
  ### 参考
</div>

- [AITracing クラス](/reference/observability/ai-tracing/) - 主要なトレーシングクラス
- [インターフェイス](/reference/observability/ai-tracing/interfaces) - 型定義
- [スパン リファレンス](/reference/observability/ai-tracing/span) - スパンのライフサイクル

<div id="examples">
  ### 例
</div>

- [Basic AI Tracing](/examples/observability/basic-ai-tracing) - 入門

<div id="exporters">
  ### エクスポーター
</div>

- [DefaultExporter](/reference/observability/ai-tracing/exporters/default-exporter) - ストレージの設定
- [CloudExporter](/reference/observability/ai-tracing/exporters/cloud-exporter) - クラウドの設定
- [Braintrust](/reference/observability/ai-tracing/exporters/braintrust) - Braintrust との連携
- [Langfuse](/reference/observability/ai-tracing/exporters/langfuse) - Langfuse との連携
- [LangSmith](/reference/observability/ai-tracing/exporters/langsmith) - LangSmith との連携