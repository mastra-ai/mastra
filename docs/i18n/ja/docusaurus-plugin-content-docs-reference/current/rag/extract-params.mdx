---
title: "リファレンス: ExtractParams | RAG | Mastra ドキュメント"
description: Mastra におけるメタデータ抽出設定のドキュメントです。
---

<div id="extractparams">
  # ExtractParams
</div>

ExtractParams は、LLM 解析に基づいてドキュメントのチャンクからメタデータを抽出するための設定です。

<div id="example">
  ## 例
</div>

```typescript showLineNumbers copy
import { MDocument } from "@mastra/rag";

const doc = MDocument.fromText(text);
const chunks = await doc.chunk({
  extract: {
    title: true, // 既定の設定でタイトルを抽出
    summary: true, // 既定の設定で要約を生成
    keywords: true, // 既定の設定でキーワードを抽出
  },
});

// 出力例:
// chunks[0].metadata = {
//   documentTitle: "AI Systems Overview",
//   sectionSummary: "人工知能の概念と応用の概要",
//   excerptKeywords: "KEYWORDS: AI、機械学習、アルゴリズム"
// }
```


<div id="parameters">
  ## パラメータ
</div>

`extract` パラメータは次のフィールドを受け付けます：

<PropertiesTable
  content={[
    {
      name: "title",
      type: "boolean | TitleExtractorsArgs",
      isOptional: true,
      description:
        "タイトル抽出を有効化します。デフォルト設定を使う場合は true、カスタム設定を使う場合は構成を指定してください。",
    },
    {
      name: "summary",
      type: "boolean | SummaryExtractArgs",
      isOptional: true,
      description:
        "要約抽出を有効化します。デフォルト設定を使う場合は true、カスタム設定を使う場合は構成を指定してください。",
    },
    {
      name: "questions",
      type: "boolean | QuestionAnswerExtractArgs",
      isOptional: true,
      description:
        "質問生成を有効化します。デフォルト設定を使う場合は true、カスタム設定を使う場合は構成を指定してください。",
    },
    {
      name: "keywords",
      type: "boolean | KeywordExtractArgs",
      isOptional: true,
      description:
        "キーワード抽出を有効化します。デフォルト設定を使う場合は true、カスタム設定を使う場合は構成を指定してください。",
    },
  ]}
/>

<div id="extractor-arguments">
  ## Extractor の引数
</div>

<div id="titleextractorsargs">
  ### TitleExtractorsArgs
</div>

<PropertiesTable
  content={[
    {
      name: "llm",
      type: "MastraLanguageModel",
      isOptional: true,
      description: "タイトル抽出に使用する AI SDK の言語モデル",
    },
    {
      name: "nodes",
      type: "number",
      isOptional: true,
      description: "抽出するタイトルノード数",
    },
    {
      name: "nodeTemplate",
      type: "string",
      isOptional: true,
      description:
        "タイトルノード抽出用のカスタムプロンプトテンプレート。{context} プレースホルダーを含める必要があります。",
    },
    {
      name: "combineTemplate",
      type: "string",
      isOptional: true,
      description:
        "タイトルを統合するためのカスタムプロンプトテンプレート。{context} プレースホルダーを含める必要があります。",
    },
  ]}
/>

<div id="summaryextractargs">
  ### SummaryExtractArgs
</div>

<PropertiesTable
  content={[
    {
      name: "llm",
      type: "MastraLanguageModel",
      isOptional: true,
      description: "要約抽出に使用する AI SDK の言語モデル",
    },
    {
      name: "summaries",
      type: "('self' | 'prev' | 'next')[]",
      isOptional: true,
      description:
        "生成する要約タイプのリスト。含められるのは 'self'（現在のチャンク）、'prev'（前のチャンク）、'next'（次のチャンク）のみです",
    },
    {
      name: "promptTemplate",
      type: "string",
      isOptional: true,
      description:
        "要約生成用のカスタムプロンプトテンプレート。{context} プレースホルダーを含める必要があります",
    },
  ]}
/>

<div id="questionanswerextractargs">
  ### QuestionAnswerExtractArgs
</div>

<PropertiesTable
  content={[
    {
      name: "llm",
      type: "MastraLanguageModel",
      isOptional: true,
      description: "質問生成に使用する AI SDK の言語モデル",
    },
    {
      name: "questions",
      type: "number",
      isOptional: true,
      description: "生成する質問数",
    },
    {
      name: "promptTemplate",
      type: "string",
      isOptional: true,
      description:
        "質問生成用のカスタムプロンプトテンプレート。{context} と {numQuestions} の両方のプレースホルダーを含める必要があります",
    },
    {
      name: "embeddingOnly",
      type: "boolean",
      isOptional: true,
      description: "true の場合、実際の質問を生成せずに埋め込みのみを作成します",
    },
  ]}
/>

<div id="keywordextractargs">
  ### KeywordExtractArgs
</div>

<PropertiesTable
  content={[
    {
      name: "llm",
      type: "MastraLanguageModel",
      isOptional: true,
      description: "キーワード抽出に使用する AI SDK の言語モデル",
    },
    {
      name: "keywords",
      type: "number",
      isOptional: true,
      description: "抽出するキーワード数",
    },
    {
      name: "promptTemplate",
      type: "string",
      isOptional: true,
      description:
        "キーワード抽出用のカスタムプロンプトテンプレート。{context} と {maxKeywords} の両方のプレースホルダーを含める必要があります。",
    },
  ]}
/>

<div id="advanced-example">
  ## 上級例
</div>

```typescript showLineNumbers copy
import { MDocument } from "@mastra/rag";

const doc = MDocument.fromText(text);
const chunks = await doc.chunk({
  extract: {
    // カスタム設定によるタイトル抽出
    title: {
      nodes: 2, // タイトルノードを2つ抽出
      nodeTemplate: "次の内容のタイトルを生成してください: {context}",
      combineTemplate: "次のタイトルを統合してください: {context}",
    },

    // カスタム設定による要約抽出
    summary: {
      summaries: ["self"], // 現在のチャンクの要約を生成
      promptTemplate: "次の内容を要約してください: {context}",
    },

    // カスタム設定による質問生成
    questions: {
      questions: 3, // 質問を3つ生成
      promptTemplate: "{context} について {numQuestions} 件の質問を生成してください",
      embeddingOnly: false,
    },

    // カスタム設定によるキーワード抽出
    keywords: {
      keywords: 5, // キーワードを5つ抽出
      promptTemplate: "次の内容から主要な用語を {maxKeywords} 件抽出してください: {context}",
    },
  },
});

// 出力例:
// chunks[0].metadata = {
//   documentTitle: "現代のコンピューティングにおけるAI"
//   sectionSummary: "AIの概念とコンピューティングへの応用の概要"
//   questionsThisExcerptCanAnswer: "1. 機械学習とは何ですか？\n2. ニューラルネットワークはどのように機能しますか？"
//   excerptKeywords: "1. 機械学習\n2. ニューラルネットワーク\n3. 学習データ"
// }
```


<div id="document-grouping-for-title-extraction">
  ## タイトル抽出のためのドキュメントのグループ化
</div>

`TitleExtractor` を使用する際は、各チャンクの `metadata` フィールドに共通の `docId` を指定することで、複数のチャンクをまとめてタイトル抽出できます。同じ `docId` を持つすべてのチャンクには、同一の抽出タイトルが付与されます。`docId` が設定されていない場合、各チャンクはタイトル抽出において個別のドキュメントとして扱われます。

**例:**

```ts
import { MDocument } from "@mastra/rag";

const doc = new MDocument({
  docs: [
    { text: "チャンク1", metadata: { docId: "docA" } },
    { text: "チャンク2", metadata: { docId: "docA" } },
    { text: "チャンク3", metadata: { docId: "docB" } },
  ],
  type: "text",
});

await doc.extractMetadata({ title: true });
// 最初の2つのチャンクは同じタイトルになり、3つ目のチャンクには別のタイトルが割り当てられます。
```
