---
title: "リファレンス: ContentSimilarityMetric | Evals | Mastra ドキュメント"
description: Mastra における Content Similarity Metric のドキュメント。文字列間のテキストの類似度を測定し、一致度スコアを提供します。
---

<div id="contentsimilaritymetric">
  # ContentSimilarityMetric
</div>

:::info Scorers
このドキュメントは旧式の evals API を参照しています。最新のスコアラー機能については、[Scorers](/docs/scorers/overview) をご覧ください。
:::

`ContentSimilarityMetric` クラスは、2 つの文字列のテキスト類似度を測定し、どの程度一致しているかを示すスコアを返します。大文字・小文字の区別や空白の扱いに関する設定可能なオプションをサポートしています。

<div id="basic-usage">
  ## 基本的な使い方
</div>

```typescript
import { ContentSimilarityMetric } from "@mastra/evals/nlp";

const metric = new ContentSimilarityMetric({
  ignoreCase: true,
  ignoreWhitespace: true,
});

const result = await metric.measure("Hello, world!", "hello world");

console.log(result.score); // 類似度スコア（0〜1）
console.log(result.info); // 類似度に関する詳細なメトリクス
```


<div id="constructor-parameters">
  ## コンストラクターの引数
</div>

<PropertiesTable
  content={[
    {
      name: "options",
      type: "ContentSimilarityOptions",
      description: "類似度比較のための設定",
      isOptional: true,
      defaultValue: "{ ignoreCase: true, ignoreWhitespace: true }",
    },
  ]}
/>

<div id="contentsimilarityoptions">
  ### ContentSimilarityOptions
</div>

<PropertiesTable
  content={[
    {
      name: "ignoreCase",
      type: "boolean",
      description: "文字列を比較する際に大文字・小文字の違いを無視するかどうか",
      isOptional: true,
      defaultValue: "true",
    },
    {
      name: "ignoreWhitespace",
      type: "boolean",
      description: "文字列を比較する際に空白を正規化して扱うかどうか",
      isOptional: true,
      defaultValue: "true",
    },
  ]}
/>

<div id="measure-parameters">
  ## measure() のパラメーター
</div>

<PropertiesTable
  content={[
    {
      name: "input",
      type: "string",
      description: "比較の基準となる参照テキスト",
      isOptional: false,
    },
    {
      name: "output",
      type: "string",
      description: "類似度を評価するテキスト",
      isOptional: false,
    },
  ]}
/>

<div id="returns">
  ## 戻り値
</div>

<PropertiesTable
  content={[
    {
      name: "score",
      type: "number",
      description:
        "類似度スコア（0〜1）。1 は完全一致を示します",
    },
    {
      name: "info",
      type: "object",
      description: "類似度に関する詳細な指標",
      properties: [
        {
          type: "number",
          parameters: [
            {
              name: "similarity",
              type: "number",
              description: "2つのテキスト間の生の類似度スコア",
            },
          ],
        },
      ],
    },
  ]}
/>

<div id="scoring-details">
  ## スコアリングの詳細
</div>

この指標は、文字単位のマッチングと設定可能なテキスト正規化により、テキストの類似性を評価します。

<div id="scoring-process">
  ### スコアリングのプロセス
</div>

1. テキストの正規化:
   - 大文字・小文字の統一（ignoreCase: true の場合）
   - 空白の統一（ignoreWhitespace: true の場合）

2. 正規化後の文字列を文字列類似度アルゴリズムで比較:
   - 文字列の並びを解析
   - 単語境界を整合
   - 相対的位置を考慮
   - 長さの差異を考慮

最終スコア: `similarity_value * scale`

<div id="score-interpretation">
  ### スコアの解釈
</div>

（スケールは0から。デフォルトは0〜1）

- 1.0: 完全一致 - テキストが同一
- 0.7〜0.9: 高い類似度 - ほぼ一致する内容
- 0.4〜0.6: 中程度の類似度 - 部分的に一致
- 0.1〜0.3: 低い類似度 - 一致パターンが少ない
- 0.0: 類似なし - まったく異なるテキスト

<div id="example-with-different-options">
  ## さまざまなオプションを使った例
</div>

```typescript
import { ContentSimilarityMetric } from "@mastra/evals/nlp";

// 大文字・小文字を区別して比較
const caseSensitiveMetric = new ContentSimilarityMetric({
  ignoreCase: false,
  ignoreWhitespace: true,
});

const result1 = await caseSensitiveMetric.measure("Hello World", "hello world"); // 大文字・小文字の違いによりスコアが低くなる

// 例の出力:
// {
//   score: 0.75,
//   info: { similarity: 0.75 }
// }

// 空白を厳密に比較
const strictWhitespaceMetric = new ContentSimilarityMetric({
  ignoreCase: true,
  ignoreWhitespace: false,
});

const result2 = await strictWhitespaceMetric.measure(
  "Hello   World",
  "Hello World",
); // 空白の違いによりスコアが低くなる

// 例の出力:
// {
//   score: 0.85,
//   info: { similarity: 0.85 }
// }
```


<div id="related">
  ## 関連項目
</div>

- [完全性メトリクス](./completeness)
- [テキスト差分メトリクス](./textual-difference)
- [回答関連性メトリクス](./answer-relevancy)
- [キーワード網羅性メトリクス](./keyword-coverage)