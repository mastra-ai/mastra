---
title: "移行：AgentNetwork から .network() へ | 移行ガイド"
description: "Mastra で AgentNetwork のプリミティブから .network() へ移行する方法を解説します。"
---

<div id="migrate-from-agentnetwork-to-network">
  # AgentNetwork から `.network()` への移行
</div>

`@mastra/core` の `v0.20.0` 以降、以下の変更が適用されます。

<div id="upgrade-from-ai-sdk-v4-to-v5">
  ### AI SDK v4 から v5 へのアップグレード
</div>

- すべてのモデルプロバイダーのパッケージをメジャーバージョンに更新してください。

:::note

これにより、すべてが v5 のモデルになります。

:::

<div id="memory-is-required">
  ### メモリが必須です
</div>

- エージェントネットワークを正常に動作させるには、メモリの設定が必須です。

:::note

エージェントのメモリを設定する必要があります。

:::

<div id="migration-paths">
  ## 移行パス
</div>

`AgentNetwork` プリミティブを使用していた場合は、`AgentNetwork` を `Agent` に置き換えられます。

Before:

```typescript
import { AgentNetwork } from "@mastra/core/network";

const agent = new AgentNetwork({
  name: "agent-network",
  agents: [agent1, agent2],
  tools: { tool1, tool2 },
  model: openai("gpt-4o"),
  instructions:
    "あなたは様々なタスクでユーザーを支援できるネットワークエージェントです。",
});

await agent.stream("東京の天気を教えて。");
```

After:

```typescript
import { Agent } from "@mastra/core/agent";
import { Memory } from "@mastra/memory";

const memory = new Memory();

const agent = new Agent({
  name: "agent-network",
  agents: { agent1, agent2 },
  tools: { tool1, tool2 },
  model: openai("gpt-4o"),
  instructions:
    "あなたは、ユーザーのさまざまなタスクをサポートできるネットワークエージェントです。",
  memory,
});

await agent.network("東京の天気を教えてください。");
```

`NewAgentNetwork` プリミティブを使用していた場合は、`NewAgentNetwork` を `Agent` に置き換えることができます。

Before:

```typescript
import { NewAgentNetwork } from "@mastra/core/network/vnext";

const agent = new NewAgentNetwork({
  name: "agent-network",
  agents: { agent1, agent2 },
  workflows: { workflow1 },
  tools: { tool1, tool2 },
  model: openai("gpt-4o"),
  instructions:
    "あなたは様々なタスクでユーザーを支援できるネットワークエージェントです。",
});

await agent.loop("東京の天気を教えて。");
```

後：

```typescript
import { Agent } from "@mastra/core/agent";
import { Memory } from "@mastra/memory";

const memory = new Memory();

const agent = new Agent({
  name: "agent-network",
  agents: { agent1, agent2 },
  workflows: { workflow1 },
  tools: { tool1, tool2 },
  model: openai("gpt-4o"),
  instructions:
    "あなたは、ユーザーのさまざまなタスクをサポートできるネットワークエージェントです。",
  memory,
});

await agent.network("東京の天気を教えて。");
```
