import { MimeType } from "@arizeai/openinference-semantic-conventions";
export const safelyJSONStringify = (value) => {
    try {
        return JSON.stringify(value);
    }
    catch {
        return null;
    }
};
export const getNumber = (value) => {
    if (typeof value === "number" && Number.isFinite(value))
        return value;
    return undefined;
};
export const getString = (value) => {
    if (typeof value === "string" && value.length > 0)
        return value;
    return undefined;
};
export const getStringArray = (value) => {
    if (Array.isArray(value) && value.every((v) => typeof v === "string")) {
        return value;
    }
    return undefined;
};
export const safelyParseJSON = (value) => {
    const s = getString(value);
    if (!s)
        return undefined;
    try {
        return JSON.parse(s);
    }
    catch {
        return undefined;
    }
};
export const getMimeType = (value) => {
    if (safelyParseJSON(value))
        return MimeType.JSON;
    return MimeType.TEXT;
};
/**
 * Assign attribute value to attributes object if value is not undefined or null
 * This mutates the attrs object
 * @param attrs - The attributes object to assign the value to
 * @param key - The key to assign the value to
 * @param value - The value to assign to the key
 */
export const set = (attrs, key, value) => {
    if (value === undefined || value === null)
        return;
    attrs[key] = value;
};
/**
 * Merge multiple attributes objects into a single attributes object
 * This mutates the first attributes object
 * @param groups - The groups of attributes to merge
 * @returns The merged attributes
 */
export const merge = (...groups) => groups.reduce((acc, g) => Object.assign(acc, g), {});
/**
 * Convert a value to a string. If the value is already a string, return it.
 * If the value can be jsonified, jsonify it.
 * Otherwise, return the string representation of the value.
 * @param value - The value to convert to a string
 * @returns The string representation of the value
 */
export const toStringContent = (value) => {
    if (typeof value === "string")
        return value;
    const json = safelyJSONStringify(value);
    if (typeof json === "string")
        return json;
    return String(value);
};
/**
 * Wraps a function with a try-catch block to catch and log any errors.
 * @param fn - A function to wrap with a try-catch block.
 * @returns A function that returns null if an error is thrown.
 */
export function withSafety({ fn, onError, }) {
    return (...args) => {
        try {
            return fn(...args);
        }
        catch (error) {
            if (onError) {
                onError(error);
            }
            return null;
        }
    };
}
//# sourceMappingURL=utils.js.map