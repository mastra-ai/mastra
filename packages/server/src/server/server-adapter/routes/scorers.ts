import {
  listScorersHandler,
  getScorerHandler,
  listScoresByRunIdHandler,
  listScoresByScorerIdHandler,
  listScoresByEntityIdHandler,
  saveScoreHandler,
} from '../../handlers/scores';
import {
  listScorersResponseSchema,
  scorerEntrySchema,
  scorerIdPathParams,
  runIdPathParams,
  entityPathParams,
  listScoresByRunIdQuerySchema,
  listScoresByScorerIdQuerySchema,
  listScoresByEntityIdQuerySchema,
  saveScoreBodySchema,
  scoresWithPaginationResponseSchema,
  saveScoreResponseSchema,
} from '../../schemas/scores';
import { createRoute } from './route-builder';
import type { ServerRoute, ServerRouteHandler } from '.';

export const SCORES_ROUTES: ServerRoute[] = [
  createRoute({
    method: 'GET',
    responseType: 'json',
    handler: listScorersHandler as unknown as ServerRouteHandler,
    path: '/api/scores/scorers',
    responseSchema: listScorersResponseSchema,
    summary: 'List all scorers',
    description:
      'Returns a list of all registered scorers with their configuration and associated agents and workflows',
    tags: ['Scoring'],
  }),
  createRoute({
    method: 'GET',
    responseType: 'json',
    handler: getScorerHandler as unknown as ServerRouteHandler,
    path: '/api/scores/scorers/:scorerId',
    pathParamSchema: scorerIdPathParams,
    responseSchema: scorerEntrySchema,
    summary: 'Get scorer by ID',
    description: 'Returns details for a specific scorer including its configuration and associations',
    tags: ['Scoring'],
  }),
  createRoute({
    method: 'GET',
    responseType: 'json',
    handler: listScoresByRunIdHandler as unknown as ServerRouteHandler,
    path: '/api/scores/run/:runId',
    pathParamSchema: runIdPathParams,
    queryParamSchema: listScoresByRunIdQuerySchema,
    responseSchema: scoresWithPaginationResponseSchema,
    summary: 'List scores by run ID',
    description: 'Returns all scores for a specific execution run',
    tags: ['Scoring'],
  }),
  createRoute({
    method: 'GET',
    responseType: 'json',
    handler: listScoresByScorerIdHandler as unknown as ServerRouteHandler,
    path: '/api/scores/scorer/:scorerId',
    pathParamSchema: scorerIdPathParams,
    queryParamSchema: listScoresByScorerIdQuerySchema,
    responseSchema: scoresWithPaginationResponseSchema,
    summary: 'List scores by scorer ID',
    description: 'Returns all scores generated by a specific scorer',
    tags: ['Scoring'],
  }),
  createRoute({
    method: 'GET',
    responseType: 'json',
    handler: listScoresByEntityIdHandler as unknown as ServerRouteHandler,
    path: '/api/scores/entity/:entityType/:entityId',
    pathParamSchema: entityPathParams,
    queryParamSchema: listScoresByEntityIdQuerySchema,
    responseSchema: scoresWithPaginationResponseSchema,
    summary: 'List scores by entity ID',
    description: 'Returns all scores for a specific entity (agent or workflow)',
    tags: ['Scoring'],
  }),
  createRoute({
    method: 'POST',
    responseType: 'json',
    handler: saveScoreHandler as unknown as ServerRouteHandler,
    path: '/api/scores',
    bodySchema: saveScoreBodySchema,
    responseSchema: saveScoreResponseSchema,
    summary: 'Save score',
    description: 'Saves a new score record to storage',
    tags: ['Scoring'],
  }),
];
